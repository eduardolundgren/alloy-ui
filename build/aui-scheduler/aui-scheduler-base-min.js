AUI.add("aui-scheduler-base",function(ac){var R=ac.Lang,a=R.isArray,e=R.isDate,ap=R.isFunction,J=R.isNumber,I=function(A){return(A instanceof ac.Scheduler);},t=function(A){return(A instanceof ac.SchedulerView);},aa=function(A){return(A instanceof ac.SchedulerEvent);},u=function(A){return(ac.SchedulerCalendar&&(A instanceof ac.SchedulerCalendar));},i=ac.DataType.DateMath,X=ac.WidgetStdMod,V=".",p="",q=" ",s="scheduler-base",ai="data-view-name",G="activeView",au="clearfix",F="controls",ak="controlsNode",aj="date",ag="endDate",ah="eventClass",O="eventRecorder",av="events",aA="hd",w="header",at="headerNode",n="helper",U="icon",k="iconNextNode",ao="iconPrevNode",ay="locale",m="name",S="nav",N="navNode",b="navigationDateFormatter",o="next",c="nextDate",ar="prev",al="prevDate",az="rendered",M="scheduler",aw="startDate",E="strings",f="today",ad="todayNode",v="triggerNode",z="view",P="viewDate",C="viewDateNode",Q="viewStack",aB="views",Y="viewsNode",B=ac.getClassName,ae=B(n,au),j=B(U),an=B(s,F),x=B(s,z,aj),g=B(s,aA),W=B(s,U,o),D=B(s,U,ar),ax=B(s,S),y=B(s,f),Z=B(s,z),h=B(s,z,p),r=B(s,aB),am='<div class="'+an+'"></div>',ab='<div class="'+x+'"></div>',d='<div class="'+g+'"></div>',aC='<a href="#" class="'+[j,W].join(q)+'">Next</a>',af='<a href="#" class="'+[j,D].join(q)+'">Prev</a>',l='<div class="'+ax+'"></div>',T='<a href="#" class="'+y+'">{today}</a>',aq='<a href="#" class="'+[Z,h].join(q)+'{name}" data-view-name="{name}">{label}</a>',K='<div class="'+r+'"></div>';var L=function(){};L.ATTRS={eventClass:{valueFn:function(){return ac.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:a}};ac.mix(L.prototype,{addEvent:function(aD){var A=this;var aE=[].concat(A.get(av));if(ac.Array.indexOf(aE,aD)===-1){aE.push(aD);A.set(av,aE);}},addEvents:function(aD){var A=this;ac.Array.each(A._normalizeEvents(aD),ac.bind(A.addEvent,A));},eachEvent:function(aE){var A=this;var aD=A.get(av);ac.Array.each(aD,aE,A);},removeEvent:function(aD){var A=this;var aE=[].concat(A.get(av));if(aE.length){ac.Array.removeItem(aE,aD);A.set(av,aE);}},removeEvents:function(aD){var A=this;ac.Array.each(A._normalizeEvents(aD),ac.bind(A.removeEvent,A));},_normalizeEvents:function(aE){var A=this;var aD=[];aE=ac.Array(aE);ac.Array.each(aE,function(aF){if(aa(aF)){aD.push(aF);}else{if(u(aF)){if(I(A)){aF.set(M,A);}aD=aD.concat(A._normalizeEvents(aF.get(av)));}else{aF=new (A.get(ah))(aF);aD.push(aF);}}if(I(A)){aF.set(M,A);aF.set(ah,A.get(ah));}});return aD;},_setEvents:function(aD){var A=this;return A._normalizeEvents(aD);}});ac.SchedulerEventSupport=L;var H=ac.Component.create({NAME:s,ATTRS:{activeView:{validator:t},date:{value:new Date(),validator:e},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormatter:{value:function(aD){var A=this;return ac.DataType.Date.format(aD,{format:"%B %d, %Y",locale:A.get(ay)});},validator:ap},views:{setter:"_setViews",value:[]},viewDate:{getter:"_getViewDate",readOnly:true},firstDayOfWeek:{value:0,validator:J},controlsNode:{valueFn:function(){return ac.Node.create(am);}},viewDateNode:{valueFn:function(){return ac.Node.create(ab);}},headerNode:{valueFn:function(){return ac.Node.create(d);}},iconNextNode:{valueFn:function(){return ac.Node.create(aC);}},iconPrevNode:{valueFn:function(){return ac.Node.create(af);}},navNode:{valueFn:function(){return ac.Node.create(l);}},todayNode:{valueFn:function(){return ac.Node.create(this._processTemplate(T));}},viewsNode:{valueFn:function(){return ac.Node.create(K);}}},HTML_PARSER:{controlsNode:V+an,viewDateNode:V+x,headerNode:V+g,iconNextNode:V+W,iconPrevNode:V+D,navNode:V+ax,todayNode:V+y,viewsNode:V+r},UI_ATTRS:[aj],AUGMENTS:[ac.SchedulerEventSupport,ac.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[Q]={};A[ak]=A.get(ak);A[C]=A.get(C);A[w]=A.get(at);A[k]=A.get(k);A[ao]=A.get(ao);A[N]=A.get(N);A[ad]=A.get(ad);A[Y]=A.get(Y);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ac.Array.each(A.get(av),function(aD){delete aD._filtered;});},getEventsByDay:function(aD,aE){var A=this;aD=i.safeClearTime(aD);return A._getEvents(aD,function(aF){return i.compare(aF.getClearStartDate(),aD)||(aE&&i.compare(aF.getClearEndDate(),aD));});},getIntersectEvents:function(aD){var A=this;aD=i.safeClearTime(aD);return A._getEvents(aD,function(aF){var aE=aF.getClearStartDate();var aG=aF.getClearEndDate();return(i.compare(aD,aE)||i.compare(aD,aG)||i.between(aD,aE,aG));});},sortEventsByDateAsc:function(aD){var A=this;aD.sort(function(aH,aF){var aG=aH.get(ag);var aE=aF.get(ag);var aJ=aH.get(aw);var aI=aF.get(aw);if(i.after(aJ,aI)||(i.compare(aJ,aI)&&i.before(aG,aE))){return 1;}else{return -1;}});},getViewByName:function(aD){var A=this;return A[Q][aD];},getStrings:function(){var A=this;return A.get(E);},getString:function(aD){var A=this;return A.getStrings()[aD];},renderView:function(aD){var A=this;if(aD){aD.show();if(!aD.get(az)){if(!A.bodyNode){A.setStdModContent(X.BODY,p);}aD.render(A.bodyNode);}}},plotViewEvents:function(aD){var A=this;aD.plotEvents(A.get(av));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(G));},_afterActiveViewChange:function(aF){var aD=this;if(aD.get(az)){var aE=aF.newVal;var A=aF.prevVal;if(A){A.hide();}aD.renderView(aE);var aG=aD.get(O);if(aG){aG.hideOverlay();}aD._uiSetDate(aD.get(aj));}},_afterRender:function(aD){var A=this;A.renderView(A.get(G));A._uiSetDate(A.get(aj));},_bindDelegate:function(){var A=this;A[Y].delegate("click",A._onClickViewTrigger,V+Z,A);A[ak].delegate("click",A._onClickPrevIcon,V+D,A);A[ak].delegate("click",A._onClickNextIcon,V+W,A);A[ak].delegate("click",A._onClickToday,V+y,A);},_createViewTriggerNode:function(aD){var A=this;if(!aD.get(v)){var aE=aD.get(m);aD.set(v,ac.Node.create(R.sub(aq,{name:aE,label:(A.getString(aE)||aE)})));}return aD.get(v);},_getEvents:function(aD,aG){var A=this;
var aF=A.get(av);var aE=[];ac.Array.each(aF,function(aH){if(aG.apply(A,[aH])){aE.push(aH);}});A.sortEventsByDateAsc(aE);return aE;},_getViewDate:function(){var A=this,aD=A.get(aj),aE=A.get(G);if(aE){aD=aE.getAdjustedViewDate(aD);}return aD;},_onClickToday:function(aD){var A=this;A.set(aj,A.get(G).getToday());aD.preventDefault();},_onClickNextIcon:function(aD){var A=this;A.set(aj,A.get(G).get(c));aD.preventDefault();},_onClickPrevIcon:function(aD){var A=this;A.set(aj,A.get(G).get(al));aD.preventDefault();},_onClickViewTrigger:function(aD){var A=this;var aE=aD.currentTarget.attr(ai);A.set(G,A.getViewByName(aE));aD.preventDefault();},_processTemplate:function(aD){var A=this;return R.sub(aD,A.getStrings());},_setEventRecorder:function(aD){var A=this;if(aD){aD.set(M,A);aD.set(ah,A.get(ah));}},_setViews:function(aE){var A=this;var aD=[];ac.Array.each(aE,function(aF){if(t(aF)&&!aF.get(az)){aF.set(M,A);aF.set(ah,A.get(ah));aD.push(aF);A[Q][aF.get(m)]=aF;}});if(!A.get(G)){A.set(G,aE[0]);}return aD;},syncStdContent:function(){var A=this;var aD=A.get(aB);A[N].append(A[ao]);A[N].append(A[k]);A[ak].append(A[ad]);A[ak].append(A[N]);A[ak].append(A[C]);ac.Array.each(aD,function(aE){A[Y].append(A._createViewTriggerNode(aE));});A[w].append(A[ak]);A[w].append(A[Y]);A[w].addClass(ae);A.setStdModContent(X.HEADER,A[w].getDOM());},_uiSetDate:function(aG){var aD=this;var aF=aD.get(b);var A=aF.call(aD,aG);if(aD.get(az)){var aE=aD.get(G);if(aE){aE._uiSetDate(aG);aF=aE.get(b);A=aF.call(aE,aG);}aD[C].html(A);aD.syncEventsUI();}}}});ac.Scheduler=H;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});