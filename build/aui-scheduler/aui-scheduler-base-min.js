AUI.add("aui-scheduler-base",function(ad){var S=ad.Lang,a=S.isArray,e=S.isDate,aq=S.isFunction,J=S.isNumber,I=function(A){return(A instanceof ad.Scheduler);},t=function(A){return(A instanceof ad.SchedulerView);},ab=function(A){return(A instanceof ad.SchedulerEvent);},u=function(A){return(ad.SchedulerCalendar&&(A instanceof ad.SchedulerCalendar));},i=ad.DataType.DateMath,Y=ad.WidgetStdMod,W=".",p="",q=" ",s="scheduler-base",aj="data-view-name",G="activeView",aw="clearfix",F="controls",al="controlsNode",ak="date",ah="endDate",ai="eventClass",P="eventRecorder",ax="events",aC="hd",w="header",av="headerNode",n="helper",V="icon",k="iconNextNode",ap="iconPrevNode",aA="locale",m="name",T="nav",O="navNode",b="navigationDateFormatter",o="next",d="nextDate",au="prev",am="prevDate",ar="radio",aB="rendered",N="scheduler",ay="startDate",E="strings",f="today",ae="todayNode",v="triggerNode",z="view",Q="viewDate",C="viewDateNode",R="viewStack",aD="views",Z="viewsNode",B=ad.getClassName,af=B(n,aw),j=B(V),ao=B(s,F),x=B(s,z,ak),g=B(s,aC),X=B(s,V,o),D=B(s,V,au),az=B(s,T),y=B(s,f),aa=B(s,z),h=B(s,z,p),r=B(s,aD),K="yui3-button-selected",an='<div class="'+ao+'"></div>',ac='<div class="'+x+'"></div>',c='<div class="'+g+'"></div>',aE='<button class="'+[j,X].join(q)+' yui3-button">Next</button>',ag='<button class="'+[j,D].join(q)+' yui3-button">Prev</button>',l='<div class="'+az+'"></div>',U='<button class="'+y+' yui3-button">{today}</button>',at='<button class="'+[aa,h].join(q)+'{name} {activeViewClass}" data-view-name="{name}">{label}</button>',L='<div class="'+r+'"></div>';var M=function(){};M.ATTRS={eventClass:{valueFn:function(){return ad.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:a}};ad.mix(M.prototype,{addEvent:function(aF){var A=this;var aG=[].concat(A.get(ax));if(ad.Array.indexOf(aG,aF)===-1){aG.push(aF);A.set(ax,aG);}},addEvents:function(aF){var A=this;ad.Array.each(A._normalizeEvents(aF),ad.bind(A.addEvent,A));},eachEvent:function(aG){var A=this;var aF=A.get(ax);ad.Array.each(aF,aG,A);},removeEvent:function(aF){var A=this;var aG=[].concat(A.get(ax));if(aG.length){ad.Array.removeItem(aG,aF);A.set(ax,aG);}},removeEvents:function(aF){var A=this;ad.Array.each(A._normalizeEvents(aF),ad.bind(A.removeEvent,A));},_normalizeEvents:function(aG){var A=this;var aF=[];aG=ad.Array(aG);ad.Array.each(aG,function(aH){if(ab(aH)){aF.push(aH);}else{if(u(aH)){if(I(A)){aH.set(N,A);}aF=aF.concat(A._normalizeEvents(aH.get(ax)));}else{aH=new (A.get(ai))(aH);aF.push(aH);}}if(I(A)){aH.set(N,A);aH.set(ai,A.get(ai));}});return aF;},_setEvents:function(aF){var A=this;return A._normalizeEvents(aF);}});ad.SchedulerEventSupport=M;var H=ad.Component.create({NAME:s,ATTRS:{activeView:{validator:t},date:{value:new Date(),validator:e},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormatter:{value:function(aF){var A=this;return ad.DataType.Date.format(aF,{format:"%B %d, %Y",locale:A.get(aA)});},validator:aq},views:{setter:"_setViews",value:[]},viewDate:{getter:"_getViewDate",readOnly:true},firstDayOfWeek:{value:0,validator:J},controlsNode:{valueFn:function(){return ad.Node.create(an);}},viewDateNode:{valueFn:function(){return ad.Node.create(ac);}},headerNode:{valueFn:function(){return ad.Node.create(c);}},iconNextNode:{valueFn:function(){return ad.Node.create(aE);}},iconPrevNode:{valueFn:function(){return ad.Node.create(ag);}},navNode:{valueFn:function(){return ad.Node.create(l);}},todayNode:{valueFn:function(){return ad.Node.create(this._processTemplate(U));}},viewsNode:{valueFn:function(){return ad.Node.create(L);}}},HTML_PARSER:{controlsNode:W+ao,viewDateNode:W+x,headerNode:W+g,iconNextNode:W+X,iconPrevNode:W+D,navNode:W+az,todayNode:W+y,viewsNode:W+r},UI_ATTRS:[ak],AUGMENTS:[ad.SchedulerEventSupport,ad.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[R]={};A[al]=A.get(al);A[C]=A.get(C);A[w]=A.get(av);A[k]=A.get(k);A[ap]=A.get(ap);A[O]=A.get(O);A[ae]=A.get(ae);A[Z]=A.get(Z);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});A.viewsButtonGroup=new ad.ButtonGroup({srcNode:A[Z],type:ar,on:{selectionChange:ad.bind(A._onButtonGroupViewChange,A)}});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ad.Array.each(A.get(ax),function(aF){aF.eachRepeatedEvent(function(aG){delete aG._filtered;});delete aF._filtered;});},getEventsByDay:function(aF,aG){var A=this;aF=i.safeClearTime(aF);return A._getEvents(aF,function(aH){return i.compare(aH.getClearStartDate(),aF)||(aG&&i.compare(aH.getClearEndDate(),aF));});},getIntersectEvents:function(aF){var A=this;aF=i.safeClearTime(aF);return A._getEvents(aF,function(aH){var aG=aH.getClearStartDate();var aI=aH.getClearEndDate();return(i.compare(aF,aG)||i.compare(aF,aI)||i.between(aF,aG,aI));});},sortEventsByDateAsc:function(aF){var A=this;aF.sort(function(aJ,aH){var aI=aJ.get(ah);var aG=aH.get(ah);var aL=aJ.get(ay);var aK=aH.get(ay);if(i.after(aL,aK)||(i.compare(aL,aK)&&i.before(aI,aG))){return 1;}else{return -1;}});},getViewByName:function(aF){var A=this;return A[R][aF];},getStrings:function(){var A=this;return A.get(E);},getString:function(aF){var A=this;return A.getStrings()[aF];},renderView:function(aF){var A=this;if(aF){aF.show();if(!aF.get(aB)){if(!A.bodyNode){A.setStdModContent(Y.BODY,p);}aF.render(A.bodyNode);}}},plotViewEvents:function(aF){var A=this;aF.plotEvents(A.get(ax));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(G));},_afterActiveViewChange:function(aH){var aF=this;if(aF.get(aB)){var aG=aH.newVal;var A=aH.prevVal;if(A){A.hide();}aF.renderView(aG);var aI=aF.get(P);if(aI){aI.hideOverlay();}aF._uiSetDate(aF.get(ak));}},_afterRender:function(aF){var A=this;A.renderView(A.get(G));A._uiSetDate(A.get(ak));},_bindDelegate:function(){var A=this;A[al].delegate("click",A._onClickPrevIcon,W+D,A);A[al].delegate("click",A._onClickNextIcon,W+X,A);A[al].delegate("click",A._onClickToday,W+y,A);
},_createViewTriggerNode:function(aF){var A=this;if(!aF.get(v)){var aG=aF.get(m),aH=A.get(G);aF.set(v,ad.Node.create(S.sub(at,{activeViewClass:(aH==aF)?K:p,name:aG,label:(A.getString(aG)||aG)})));}return aF.get(v);},_getEvents:function(aF,aI){var A=this;var aH=A.get(ax);var aG=[];ad.Array.each(aH,function(aJ){if(aI.apply(A,[aJ])){aG.push(aJ);}else{if(aJ.isRepeatableDate(aF)){var aK=aJ.repeatByDate(aF);aG.push(aK);}}});A.sortEventsByDateAsc(aG);return aG;},_getViewDate:function(){var A=this,aF=A.get(ak),aG=A.get(G);if(aG){aF=aG.getAdjustedViewDate(aF);}return aF;},_onClickToday:function(aF){var A=this;A.set(ak,A.get(G).getToday());aF.preventDefault();},_onClickNextIcon:function(aF){var A=this;A.set(ak,A.get(G).get(d));aF.preventDefault();},_onClickPrevIcon:function(aF){var A=this;A.set(ak,A.get(G).get(am));aF.preventDefault();},_onButtonGroupViewChange:function(aF){var A=this,aG=aF.originEvent.target.attr(aj);A.set(G,A.getViewByName(aG));aF.preventDefault();},_processTemplate:function(aF){var A=this;return S.sub(aF,A.getStrings());},_setEventRecorder:function(aF){var A=this;if(aF){aF.set(N,A);aF.set(ai,A.get(ai));}},_setViews:function(aG){var A=this;var aF=[];ad.Array.each(aG,function(aH){if(t(aH)&&!aH.get(aB)){aH.set(N,A);aH.set(ai,A.get(ai));aF.push(aH);A[R][aH.get(m)]=aH;}});if(!A.get(G)){A.set(G,aG[0]);}return aF;},syncStdContent:function(){var A=this;var aF=A.get(aD);A[O].append(A[ap]);A[O].append(A[k]);A[al].append(A[ae]);A[al].append(A[O]);A[al].append(A[C]);ad.Array.each(aF,function(aG){A[Z].append(A._createViewTriggerNode(aG));});A[w].append(A[al]);A[w].append(A[Z]);A[w].addClass(af);A.setStdModContent(Y.HEADER,A[w].getDOM());A.viewsButtonGroup.render();},_uiSetDate:function(aI){var aF=this;var aH=aF.get(b);var A=aH.call(aF,aI);if(aF.get(aB)){var aG=aF.get(G);if(aG){aG._uiSetDate(aI);aH=aG.get(b);A=aH.call(aG,aI);}aF[C].html(A);aF.syncEventsUI();}}}});ad.Scheduler=H;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource","button-group"]});