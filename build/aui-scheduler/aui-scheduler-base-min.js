AUI.add("aui-scheduler-base",function(ad){var S=ad.Lang,a=S.isArray,e=S.isDate,ar=S.isFunction,J=S.isNumber,I=function(A){return(A instanceof ad.Scheduler);},t=function(A){return(A instanceof ad.SchedulerView);},ab=function(A){return(A instanceof ad.SchedulerEvent);},u=function(A){return(ad.SchedulerCalendar&&(A instanceof ad.SchedulerCalendar));},i=ad.DataType.DateMath,Y=ad.WidgetStdMod,W=".",p="",q=" ",s="scheduler-base",ak="data-view-name",G="activeView",ae="button",ax="clearfix",F="controls",am="controlsNode",al="date",ai="endDate",aj="eventClass",P="eventRecorder",ay="events",aD="hd",w="header",aw="headerNode",n="helper",V="icon",k="iconNextNode",aq="iconPrevNode",aB="locale",m="name",T="nav",O="navNode",b="navigationDateFormatter",o="next",d="nextDate",av="prev",an="prevDate",at="radio",aC="rendered",N="scheduler",az="startDate",E="strings",f="today",af="todayNode",v="triggerNode",z="view",Q="viewDate",C="viewDateNode",R="viewStack",aE="views",Z="viewsNode",B=ad.getClassName,ag=B(n,ax),j=B(V),ap=B(s,F),x=B(s,z,al),g=B(s,aD),X=B(s,V,o),D=B(s,V,av),aA=B(s,T),y=B(s,f),aa=B(s,z),h=B(s,z,p),r=B(s,aE),K="yui3-button-selected",ao='<div class="'+ap+'"></div>',ac='<div class="'+x+'"></div>',c='<div class="'+g+'"></div>',aF='<button class="'+[j,X].join(q)+' yui3-button">Next</button>',ah='<button class="'+[j,D].join(q)+' yui3-button">Prev</button>',l='<div class="'+aA+'"></div>',U='<button class="'+y+' yui3-button">{today}</button>',au='<button class="'+[aa,h].join(q)+'{name}" data-view-name="{name}">{label}</button>',L='<div class="'+r+'"></div>';var M=function(){};M.ATTRS={eventClass:{valueFn:function(){return ad.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:a}};ad.mix(M.prototype,{addEvent:function(aG){var A=this;var aH=[].concat(A.get(ay));if(ad.Array.indexOf(aH,aG)===-1){aH.push(aG);A.set(ay,aH);}},addEvents:function(aG){var A=this;ad.Array.each(A._normalizeEvents(aG),ad.bind(A.addEvent,A));},eachEvent:function(aH){var A=this;var aG=A.get(ay);ad.Array.each(aG,aH,A);},removeEvent:function(aG){var A=this;var aH=[].concat(A.get(ay));if(aH.length){ad.Array.removeItem(aH,aG);A.set(ay,aH);}},removeEvents:function(aG){var A=this;ad.Array.each(A._normalizeEvents(aG),ad.bind(A.removeEvent,A));},_normalizeEvents:function(aH){var A=this;var aG=[];aH=ad.Array(aH);ad.Array.each(aH,function(aI){if(ab(aI)){aG.push(aI);}else{if(u(aI)){if(I(A)){aI.set(N,A);}aG=aG.concat(A._normalizeEvents(aI.get(ay)));}else{aI=new (A.get(aj))(aI);aG.push(aI);}}if(I(A)){aI.set(N,A);aI.set(aj,A.get(aj));}});return aG;},_setEvents:function(aG){var A=this;return A._normalizeEvents(aG);}});ad.SchedulerEventSupport=M;var H=ad.Component.create({NAME:s,ATTRS:{activeView:{validator:t},date:{value:new Date(),validator:e},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormatter:{value:function(aG){var A=this;return ad.DataType.Date.format(aG,{format:"%B %d, %Y",locale:A.get(aB)});},validator:ar},views:{setter:"_setViews",value:[]},viewDate:{getter:"_getViewDate",readOnly:true},firstDayOfWeek:{value:0,validator:J},controlsNode:{valueFn:function(){return ad.Node.create(ao);}},viewDateNode:{valueFn:function(){return ad.Node.create(ac);}},headerNode:{valueFn:function(){return ad.Node.create(c);}},iconNextNode:{valueFn:function(){return ad.Node.create(aF);}},iconPrevNode:{valueFn:function(){return ad.Node.create(ah);}},navNode:{valueFn:function(){return ad.Node.create(l);}},todayNode:{valueFn:function(){return ad.Node.create(this._processTemplate(U));}},viewsNode:{valueFn:function(){return ad.Node.create(L);}}},HTML_PARSER:{controlsNode:W+ap,viewDateNode:W+x,headerNode:W+g,iconNextNode:W+X,iconPrevNode:W+D,navNode:W+aA,todayNode:W+y,viewsNode:W+r},UI_ATTRS:[al,G],AUGMENTS:[ad.SchedulerEventSupport,ad.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[R]={};A[am]=A.get(am);A[C]=A.get(C);A[w]=A.get(aw);A[k]=A.get(k);A[aq]=A.get(aq);A[O]=A.get(O);A[af]=A.get(af);A[Z]=A.get(Z);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ad.Array.each(A.get(ay),function(aG){delete aG._filtered;});},getEventsByDay:function(aG,aH){var A=this;aG=i.safeClearTime(aG);return A._getEvents(aG,function(aI){return i.compare(aI.getClearStartDate(),aG)||(aH&&i.compare(aI.getClearEndDate(),aG));});},getIntersectEvents:function(aG){var A=this;aG=i.safeClearTime(aG);return A._getEvents(aG,function(aI){var aH=aI.getClearStartDate();var aJ=aI.getClearEndDate();return(i.compare(aG,aH)||i.compare(aG,aJ)||i.between(aG,aH,aJ));});},sortEventsByDateAsc:function(aG){var A=this;aG.sort(function(aK,aI){var aJ=aK.get(ai);var aH=aI.get(ai);var aM=aK.get(az);var aL=aI.get(az);if(i.after(aM,aL)||(i.compare(aM,aL)&&i.before(aJ,aH))){return 1;}else{return -1;}});},getViewByName:function(aG){var A=this;return A[R][aG];},getStrings:function(){var A=this;return A.get(E);},getString:function(aG){var A=this;return A.getStrings()[aG];},renderView:function(aG){var A=this;if(aG){aG.show();if(!aG.get(aC)){if(!A.bodyNode){A.setStdModContent(Y.BODY,p);}aG.render(A.bodyNode);}}},plotViewEvents:function(aG){var A=this;aG.plotEvents(A.get(ay));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(G));},renderButtonGroup:function(){var A=this;A.buttonGroup=new ad.ButtonGroup({srcNode:A[Z],type:at,on:{selectionChange:ad.bind(A._onButtonGroupSelectionChange,A)}}).render();},syncStdContent:function(){var A=this;var aG=A.get(aE);A[O].append(A[aq]);A[O].append(A[k]);A[am].append(A[af]);A[am].append(A[O]);A[am].append(A[C]);ad.Array.each(aG,function(aH){A[Z].append(A._createViewTriggerNode(aH));});A[w].append(A[am]);A[w].append(A[Z]);A[w].addClass(ag);A.setStdModContent(Y.HEADER,A[w].getDOM());},_afterActiveViewChange:function(aI){var aG=this;if(aG.get(aC)){var aH=aI.newVal;var A=aI.prevVal;if(A){A.hide();}aG.renderView(aH);
var aJ=aG.get(P);if(aJ){aJ.hideOverlay();}aG._uiSetDate(aG.get(al));}},_afterRender:function(aH){var A=this,aG=A.get(G);A.renderView(aG);A.renderButtonGroup();A._uiSetDate(A.get(al));A._uiSetActiveView(aG);},_bindDelegate:function(){var A=this;A[am].delegate("click",A._onClickPrevIcon,W+D,A);A[am].delegate("click",A._onClickNextIcon,W+X,A);A[am].delegate("click",A._onClickToday,W+y,A);},_createViewTriggerNode:function(aG){var A=this;if(!aG.get(v)){var aH=aG.get(m);aG.set(v,ad.Node.create(S.sub(au,{name:aH,label:(A.getString(aH)||aH)})));}return aG.get(v);},_getEvents:function(aG,aJ){var A=this;var aI=A.get(ay);var aH=[];ad.Array.each(aI,function(aK){if(aJ.apply(A,[aK])){aH.push(aK);}});A.sortEventsByDateAsc(aH);return aH;},_getViewDate:function(){var A=this,aG=A.get(al),aH=A.get(G);if(aH){aG=aH.getAdjustedViewDate(aG);}return aG;},_onClickToday:function(aG){var A=this;A.set(al,A.get(G).getToday());aG.preventDefault();},_onClickNextIcon:function(aG){var A=this;A.set(al,A.get(G).get(d));aG.preventDefault();},_onClickPrevIcon:function(aG){var A=this;A.set(al,A.get(G).get(an));aG.preventDefault();},_onButtonGroupSelectionChange:function(aG){var A=this,aH=aG.originEvent.target.attr(ak);A.set(G,A.getViewByName(aH));aG.preventDefault();},_processTemplate:function(aG){var A=this;return S.sub(aG,A.getStrings());},_setEventRecorder:function(aG){var A=this;if(aG){aG.set(N,A);aG.set(aj,A.get(aj));}},_setViews:function(aH){var A=this;var aG=[];ad.Array.each(aH,function(aI){if(t(aI)&&!aI.get(aC)){aI.set(N,A);aI.set(aj,A.get(aj));aG.push(aI);A[R][aI.get(m)]=aI;}});if(!A.get(G)){A.set(G,aH[0]);}return aG;},_uiSetActiveView:function(aI){var A=this;if(aI){var aH=aI.get(m),aG=A[Z].one(W+h+aH);if(aG){A[Z].all(ae).removeClass(K);aG.addClass(K);}}},_uiSetDate:function(aJ){var aG=this;var aI=aG.get(b);var A=aI.call(aG,aJ);if(aG.get(aC)){var aH=aG.get(G);if(aH){aH._uiSetDate(aJ);aI=aH.get(b);A=aI.call(aH,aJ);}aG[C].html(A);aG.syncEventsUI();}}}});ad.Scheduler=H;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource","button-group"]});