AUI.add("aui-scheduler-base",function(aP){var aw=aP.Lang,d=aw.isArray,bf=aw.isBoolean,k=aw.isDate,ba=aw.isFunction,ah=aw.isNumber,T=aw.isObject,bm=aw.isString,a5=aP.ColorUtil,p=aP.DataType.DateMath,aI=aP.WidgetStdMod,aJ=":",m=".",ak="",F="&ndash;",by=" ",x=function(A){return A instanceof aP.ModelList;},E=function(A){return A instanceof aP.SchedulerView;},i="%H:%M",Z="%l",bw="%M",ax=function(A){var bA=[Z];if(A.getMinutes()>0){bA.push(aJ);bA.push(bw);}if(A.getHours()>=12){bA.push("p");}return bA.join(ak);},aX="data-view-name",D="scheduler-base",V="scheduler-calendar",aK="scheduler-view",ac="activeView",J="all",Y="allDay",ad="borderColor",aU="borderColorRGB",aO="borderStyle",bt="borderWidth",aQ="button",bk="clearfix",a6="color",aZ="colorBrightnessFactor",bh="colorSaturationFactor",aN="content",ab="controls",a2="controlsNode",a0="date",bc="day",I="disabled",aV="endDate",aq="eventRecorder",bv="hd",K="header",bi="headerNode",u="helper",aD="hidden",U="hsbColor",aC="icon",r="iconNextNode",a9="iconPrevNode",ag="icons",at="inherit",a1="isoTime",bs="locale",bq="meeting",t="name",ay="nav",ap="navNode",f="navigationDateFormatter",v="next",h="nextDate",y="node",au="noscroll",aj="pallete",bg="prev",a3="prevDate",bb="radio",am="reminder",bu="rendered",bl="repeated",ao="scheduler",aE="scheduler-event",bp="scrollable",a="short",bo="startDate",aa="strings",aY="title",j="titleDateFormat",l="today",aR="todayNode",H="triggerNode",S="view",X="viewDateNode",ar="viewStack",bx="views",aH="viewsNode",aA="visible",R=aP.getClassName,aS=R(u,bk),q=R(aC),a7=R(D,ab),o=R(D,bv),aG=R(D,aC,v),W=R(D,aC,bg),bn=R(D,ay),P=R(D,l),aL=R(D,S),n=R(D,S,ak),N=R(D,S,a0),C=R(aK,au),c=R(aK,bp),ai="yui3-button-selected",B=R(D,bx),z=R(aE),Q=R(aE,J,bc),aW=R(aE,aN),bj=R(aE,I),L=R(aE,aD),G=R(aE,aC,I),O=R(aE,aC,bq),aB=R(aE,aC,am),e=R(aE,aC,bl),br=R(aE,ag),b=R(aE,bq),w=R(aE,am),aF=R(aE,bl),av=R(aE,a),M=R(aE,aY),a4='<div class="'+a7+'"></div>',g='<div class="'+o+'"></div>',bz='<button type="button" class="'+[q,aG].join(by)+' yui3-button">Next</button>',aT='<button type="button" class="'+[q,W].join(by)+' yui3-button">Prev</button>',s='<div class="'+bn+'"></div>',az='<button type="button" class="'+P+' yui3-button">{today}</button>',be='<button type="button" class="'+[aL,n].join(by)+'{name}" data-view-name="{name}">{label}</button>',aM='<div class="'+N+'"></div>',al='<div class="'+B+'"></div>';var ae=aP.Component.create({NAME:aE,ATTRS:{allDay:{setter:aP.DataType.Boolean.parse,value:false},borderStyle:{value:"solid",validator:bm},borderWidth:{value:"1px",validator:bm},colorBrightnessFactor:{value:0.75,validator:ah},colorSaturationFactor:{value:1.5,validator:ah},content:{validator:bm},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bm},titleDateFormat:{getter:"_getTitleDateFormat",value:function(){var A=this,bA=A.get(ao),bB=bA&&bA.get(ac).get(a1),bC={endDate:F+by+i,startDate:i};if(!bB){bC.endDate=F+by+ax(A.get(aV));bC.startDate=ax(A.get(bo));}if(A.getMinutesDuration()<=30){delete bC.endDate;}else{if(A.get(Y)){bC={};}}return bC;}},endDate:{setter:"_setDate",valueFn:function(){var A=p.clone(this.get(bo));A.setHours(A.getHours()+1);return A;}},eventClass:{valueFn:function(){return aP.SchedulerEvent;}},disabled:{value:false,validator:bf},meeting:{value:false,validator:bf},node:{valueFn:function(){return aP.NodeList.create(aP.Node.create(this.EVENT_NODE_TEMPLATE).setData(aE,this));}},reminder:{value:false,validator:bf},repeated:{value:false,validator:bf},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{setter:"_setDate",valueFn:function(){return new Date();}},visible:{value:true,validator:bf}},EXTENDS:aP.Model,PROPAGATE_ATTRS:[Y,bo,aV,aN,a6,aZ,bh,aO,bt,j,aA,I],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+z+'">'+'<div class="'+M+'"></div>'+'<div class="'+aW+'"></div>'+'<div class="'+br+'">'+'<span class="'+[q,G].join(by)+'"></span>'+'<span class="'+[q,O].join(by)+'"></span>'+'<span class="'+[q,aB].join(by)+'"></span>'+'<span class="'+[q,e].join(by)+'"></span>'+"</div>"+"</div>",initializer:function(){var A=this;A.bindUI();A.syncUI();},bindUI:function(){var A=this;A.after({allDayChange:A._afterAllDayChange,colorChange:A._afterColorChange,disabledChange:A._afterDisabledChange,endDateChange:A._afterEndDateChange,meetingChange:A._afterMeetingChange,reminderChange:A._afterReminderChange,repeatedChange:A._afterRepeatedChange,visibleChange:A._afterVisibleChange});},syncUI:function(){var A=this;A._uiSetAllDay(A.get(Y));A._uiSetColor(A.get(a6));A._uiSetDisabled(A.get(I));A._uiSetEndDate(A.get(aV));A._uiSetMeeting(A.get(bq));A._uiSetReminder(A.get(am));A._uiSetRepeated(A.get(bl));A._uiSetVisible(A.get(aA));A.syncNodeTitleUI();A.syncNodeContentUI();},destroy:function(){var A=this;A.get(y).remove(true);},addPaddingNode:function(){var A=this;A.get(y).push(aP.Node.create(A.EVENT_NODE_TEMPLATE).setData(aE,A));A.syncUI();},clone:function(){var bA=this,A=null,bB=bA.get(ao);if(bB){A=new bB.eventModel();A.copyPropagateAttrValues(bA,null,{silent:true});}return A;},copyDates:function(bA,bB){var A=this;A.setAttrs({endDate:p.clone(bA.get(aV)),startDate:p.clone(bA.get(bo))},bB);},copyPropagateAttrValues:function(bB,bD,bC){var A=this,bA={};A.copyDates(bB,bC);aP.Array.each(A.constructor.PROPAGATE_ATTRS,function(bE){if(!((bD||{}).hasOwnProperty(bE))){var bF=bB.get(bE);if(!T(bF)){bA[bE]=bF;}}});A.setAttrs(bA,bC);},getBorderColor:function(){var A=this;return A[aU].hex;},getDaysDuration:function(){var A=this;return p.getDayOffset(A.get(aV),A.get(bo));},getHoursDuration:function(){var A=this;return p.getHoursOffset(A.get(aV),A.get(bo));},getMinutesDuration:function(){var A=this;return p.getMinutesOffset(A.get(aV),A.get(bo));},getSecondsDuration:function(){var A=this;return p.getSecondsOffset(A.get(aV),A.get(bo));},sameEndDate:function(bA){var A=this;return p.compare(A.get(aV),bA.get(aV));},sameStartDate:function(bA){var A=this;return p.compare(A.get(bo),bA.get(bo));},isAfter:function(bC){var bB=this;var bA=bB.get(bo);var A=bC.get(bo);return p.after(bA,A);},isBefore:function(bC){var bB=this;
var bA=bB.get(bo);var A=bC.get(bo);return p.before(bA,A);},intersects:function(bC){var bB=this;var bD=bB.get(aV);var bA=bB.get(bo);var A=bC.get(bo);return(bB.sameStartDate(bC)||p.between(A,bA,bD));},intersectHours:function(bB){var bA=this;var bD=bA.get(aV);var A=bA.get(bo);var bC=p.clone(A);p.copyHours(bC,bB.get(bo));return(p.compare(A,bC)||p.between(bC,A,bD));},isDayBoundaryEvent:function(){var A=this;return p.isDayBoundary(A.get(bo),A.get(aV));},isDayOverlapEvent:function(){var A=this;return p.isDayOverlap(A.get(bo),A.get(aV));},getClearEndDate:function(){var A=this;return p.safeClearTime(A.get(aV));},getClearStartDate:function(){var A=this;return p.safeClearTime(A.get(bo));},move:function(bB,bA){var A=this;var bC=A.getMinutesDuration();A.setAttrs({endDate:p.add(p.clone(bB),p.MINUTES,bC),startDate:bB},bA);},setContent:function(bA){var A=this;A.get(y).each(function(bC){var bB=bC.one(m+aW);bB.setContent(bA);});},setTitle:function(bA){var A=this;A.get(y).each(function(bB){var bC=bB.one(m+M);bC.setContent(bA);});},syncNodeContentUI:function(){var A=this;A.setContent(A.get(aN));},syncNodeTitleUI:function(){var bA=this,bC=bA.get(j),A=bA.get(bo),bB=bA.get(aV),bD=[];if(bC.startDate){bD.push(bA._formatDate(A,bC.startDate));}if(bC.endDate){bD.push(bA._formatDate(bB,bC.endDate));}bA.setTitle(bD.join(by));},split:function(){var A=this,bB=p.clone(A.get(bo)),bC=p.clone(A.get(aV));if(A.isDayOverlapEvent()&&!A.isDayBoundaryEvent()){var bA=p.clone(bB);bA.setHours(24,0,0,0);return[[bB,p.toMidnight(p.clone(bB))],[bA,p.clone(bC)]];}return[[bB,bC]];},_afterAllDayChange:function(bA){var A=this;A._uiSetAllDay(bA.newVal);},_afterColorChange:function(bA){var A=this;A._uiSetColor(bA.newVal);},_afterDisabledChange:function(bA){var A=this;A._uiSetDisabled(bA.newVal);},_afterEndDateChange:function(bA){var A=this;A._uiSetEndDate(bA.newVal);},_afterMeetingChange:function(bA){var A=this;A._uiSetMeeting(bA.newVal);},_afterReminderChange:function(bA){var A=this;A._uiSetReminder(bA.newVal);},_afterRepeatedChange:function(bA){var A=this;A._uiSetRepeated(bA.newVal);},_afterVisibleChange:function(bA){var A=this;A._uiSetVisible(bA.newVal);},_setColor:function(bA){var A=this;A[U]=a5.rgb2hsb(a5.getRGB(bA));A[ad]=aP.clone(A[U]);A[ad].b*=A.get(aZ);A[ad].s*=A.get(bh);A[aU]=a5.hsb2rgb(A[ad]);return bA;},_setDate:function(bA){var A=this;if(ah(bA)){bA=new Date(bA);}return bA;},_setScheduler:function(bB){var A=this;var bA=A.get(ao);if(bA){A.removeTarget(bA);}A.addTarget(bB);return bB;},_formatDate:function(bB,bC){var bA=this;var A=bA.get(bs);return aP.DataType.Date.format(bB,{format:bC,locale:A});},_getTitleDateFormat:function(bA){var A=this;if(bm(bA)){bA={endDate:bA,startDate:bA};}else{if(ba(bA)){bA=bA.call(A);}}return bA;},_uiSetAllDay:function(bA){var A=this;A.get(y).toggleClass(Q,!!bA);},_uiSetColor:function(bC){var A=this;var bB=A.get(y);var bD=A.getBorderColor();if(bB){var bA={borderWidth:A.get(bt),borderColor:bD,backgroundColor:bC,borderStyle:A.get(aO),color:at};bB.setStyles(bA);}},_uiSetDisabled:function(bA){var A=this;A.get(y).toggleClass(bj,!!bA);},_uiSetEndDate:function(bA){var A=this;A.get(y).toggleClass(av,A.getMinutesDuration()<=30);},_uiSetMeeting:function(bA){var A=this;A.get(y).toggleClass(b,!!bA);},_uiSetReminder:function(bA){var A=this;A.get(y).toggleClass(w,!!bA);},_uiSetRepeated:function(bA){var A=this;A.get(y).toggleClass(aF,!!bA);},_uiSetVisible:function(bA){var A=this;A.get(y).toggleClass(L,!bA);}}});aP.SchedulerEvent=ae;var a8=aP.Base.create(V,aP.ModelList,[],{model:aP.SchedulerEvent,initializer:function(){var A=this;A.after("colorChange",A._afterColorChange);A.after("disabledChange",A._afterDisabledChange);A.after("visibleChange",A._afterVisibleChange);A.after(["add","remove","reset"],A._afterEventsChange);A.on(["remove","reset"],A._onRemoveEvents);A._uiSetEvents(A.toArray());A._uiSetColor(A.get(a6));A._uiSetDisabled(A.get(I));A._uiSetVisible(A.get(aA));},_afterColorChange:function(bA){var A=this;A._uiSetColor(bA.newVal);},_afterDisabledChange:function(bA){var A=this;A._uiSetDisabled(bA.newVal);},_afterEventsChange:function(bA){var A=this;A._uiSetEvents(A.toArray());},_afterVisibleChange:function(bA){var A=this;A._uiSetVisible(bA.newVal);},_onRemoveEvents:function(bB){var A=this;var bA=A.get(ao);if(bA){bA.removeEvents(A);}},_propagateAttrs:function(bA,bB){var A=this;A.each(function(bC){bC.setAttrs(bA,bB);});},_uiSetColor:function(bA){var A=this;A._propagateAttrs({color:A.get(a6)});},_uiSetDisabled:function(bA){var A=this;A._propagateAttrs({disabled:bA});},_uiSetEvents:function(bB){var A=this;var bA=A.get(ao);A._propagateAttrs({color:A.get(a6),disabled:A.get(I),visible:A.get(aA)},{silent:true});if(bA){bA.addEvents(bB);bA.syncEventsUI();}},_uiSetVisible:function(bA){var A=this;A._propagateAttrs({visible:bA});}},{ATTRS:{color:{valueFn:function(){var bA=this;var bB=bA.get(aj);var A=Math.ceil(Math.random()*bB.length)-1;return bB[A];},validator:bm},disabled:{value:false,validator:bf},name:{value:"(no name)",validator:bm},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:d},scheduler:{},visible:{value:true,validator:bf}}});aP.SchedulerCalendar=a8;aP.SchedulerEvents=aP.Base.create("scheduler-events",aP.ModelList,[],{comparator:function(bA){var A=bA.get(bo),bB=bA.get(aV);return A+1/(bB-A);},model:aP.SchedulerEvent},{});var an=function(){};an.ATTRS={};aP.mix(an.prototype,{calendarModel:aP.SchedulerCalendar,eventModel:aP.SchedulerEvent,initializer:function(bA){var A=this;A._events=new aP.SchedulerEvents({after:{add:aP.bind(A._afterAddEvent,A)}});A.addEvents(bA.items||bA.events);},addEvents:function(bB){var A=this,bA=A._toSchedulerEvents(bB);
return A._events.add(bA);},flushEvents:function(){var A=this;A._events.each(function(bA){delete bA._filtered;});},getEvents:function(bB){var A=this,bA=A._events;bA.sort();if(bB){bA=bA.filter(bB);}else{bA=bA.toArray();}return bA;},getEventsByDay:function(bA,bB){var A=this;bA=p.safeClearTime(bA);return A.getEvents(function(bC){return p.compare(bC.getClearStartDate(),bA)||(bB&&p.compare(bC.getClearEndDate(),bA));});},getIntersectEvents:function(bA){var A=this;bA=p.safeClearTime(bA);return A.getEvents(function(bC){var bB=bC.getClearStartDate();var bD=bC.getClearEndDate();return(bC.get(aA)&&(p.compare(bA,bB)||p.compare(bA,bD)||p.between(bA,bB,bD)));});},removeEvents:function(bB){var A=this,bA=A._toSchedulerEvents(bB);return A._events.remove(bA);},_afterAddEvent:function(bA){var A=this;bA.model.set(ao,A);},_toSchedulerEvents:function(bA){var A=this,bB=[];if(x(bA)){bB=bA.toArray();}else{if(d(bA)){aP.Array.each(bA,function(bC){if(x(bC)){bB=bB.concat(bC.toArray());}else{bB.push(bC);}});}else{bB=bA;}}return bB;}});aP.SchedulerEventSupport=an;var af=aP.Component.create({NAME:D,ATTRS:{activeView:{validator:E},date:{value:new Date(),validator:k},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormatter:{value:function(bA){var A=this;return aP.DataType.Date.format(bA,{format:"%B %d, %Y",locale:A.get(bs)});},validator:ba},views:{setter:"_setViews",value:[]},viewDate:{getter:"_getViewDate",readOnly:true},firstDayOfWeek:{value:0,validator:ah},controlsNode:{valueFn:function(){return aP.Node.create(a4);}},viewDateNode:{valueFn:function(){return aP.Node.create(aM);}},headerNode:{valueFn:function(){return aP.Node.create(g);}},iconNextNode:{valueFn:function(){return aP.Node.create(bz);}},iconPrevNode:{valueFn:function(){return aP.Node.create(aT);}},navNode:{valueFn:function(){return aP.Node.create(s);}},todayNode:{valueFn:function(){return aP.Node.create(this._processTemplate(az));}},viewsNode:{valueFn:function(){return aP.Node.create(al);}}},HTML_PARSER:{controlsNode:m+a7,viewDateNode:m+N,headerNode:m+o,iconNextNode:m+aG,iconPrevNode:m+W,navNode:m+bn,todayNode:m+P,viewsNode:m+B},UI_ATTRS:[a0,ac],AUGMENTS:[aP.SchedulerEventSupport,aP.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[ar]={};A[a2]=A.get(a2);A[X]=A.get(X);A[K]=A.get(bi);A[r]=A.get(r);A[a9]=A.get(a9);A[ap]=A.get(ap);A[aR]=A.get(aR);A[aH]=A.get(aH);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},getViewByName:function(bA){var A=this;return A[ar][bA];},getStrings:function(){var A=this;return A.get(aa);},getString:function(bA){var A=this;return A.getStrings()[bA];},renderView:function(bA){var A=this;if(bA){bA.show();if(!bA.get(bu)){if(!A.bodyNode){A.setStdModContent(aI.BODY,ak);}bA.render(A.bodyNode);}}},plotViewEvents:function(bA){var A=this;bA.plotEvents(A.getEvents());},syncEventsUI:function(){var A=this,bA=A.get(ac);if(bA){A.plotViewEvents(bA);}},renderButtonGroup:function(){var A=this;A.buttonGroup=new aP.ButtonGroup({srcNode:A[aH],type:bb,on:{selectionChange:aP.bind(A._onButtonGroupSelectionChange,A)}}).render();},syncStdContent:function(){var A=this;var bA=A.get(bx);A[ap].append(A[a9]);A[ap].append(A[r]);A[a2].append(A[aR]);A[a2].append(A[ap]);A[a2].append(A[X]);aP.Array.each(bA,function(bB){A[aH].append(A._createViewTriggerNode(bB));});A[K].append(A[a2]);A[K].append(A[aH]);A[K].addClass(aS);A.setStdModContent(aI.HEADER,A[K].getDOM());},_afterActiveViewChange:function(bC){var bA=this;if(bA.get(bu)){var bB=bC.newVal;var A=bC.prevVal;if(A){A.hide();}bA.renderView(bB);var bD=bA.get(aq);if(bD){bD.hideOverlay();}bA._uiSetDate(bA.get(a0));}},_afterRender:function(bB){var A=this,bA=A.get(ac);A.renderView(bA);A.renderButtonGroup();A._uiSetDate(A.get(a0));A._uiSetActiveView(bA);},_bindDelegate:function(){var A=this;A[a2].delegate("click",A._onClickPrevIcon,m+W,A);A[a2].delegate("click",A._onClickNextIcon,m+aG,A);A[a2].delegate("click",A._onClickToday,m+P,A);},_createViewTriggerNode:function(bA){var A=this;if(!bA.get(H)){var bB=bA.get(t);bA.set(H,aP.Node.create(aw.sub(be,{name:bB,label:(A.getString(bB)||bB)})));}return bA.get(H);},_getViewDate:function(){var A=this,bA=A.get(a0),bB=A.get(ac);if(bB){bA=bB.getAdjustedViewDate(bA);}return bA;},_onClickToday:function(bB){var A=this,bA=A.get(ac);if(bA){A.set(a0,bA.getToday());}bB.preventDefault();},_onClickNextIcon:function(bB){var A=this,bA=A.get(ac);if(bA){A.set(a0,bA.get(h));}bB.preventDefault();},_onClickPrevIcon:function(bB){var A=this,bA=A.get(ac);if(bA){A.set(a0,bA.get(a3));}bB.preventDefault();},_onButtonGroupSelectionChange:function(bA){var A=this,bB=bA.originEvent.target.attr(aX);A.set(ac,A.getViewByName(bB));bA.preventDefault();},_processTemplate:function(bA){var A=this;return aw.sub(bA,A.getStrings());},_setEventRecorder:function(bA){var A=this;if(bA){bA.setAttrs({scheduler:A},{silent:true});}},_setViews:function(bB){var A=this;var bA=[];aP.Array.each(bB,function(bC){if(E(bC)&&!bC.get(bu)){bC.setAttrs({scheduler:A});bA.push(bC);A[ar][bC.get(t)]=bC;}});if(!A.get(ac)){A.set(ac,bB[0]);}return bA;},_uiSetActiveView:function(bC){var A=this;if(bC){var bB=bC.get(t),bA=A[aH].one(m+n+bB);if(bA){A[aH].all(aQ).removeClass(ai);bA.addClass(ai);}}},_uiSetDate:function(bD){var bA=this;var bC=bA.get(f);var A=bC.call(bA,bD);if(bA.get(bu)){var bB=bA.get(ac);if(bB){bB._uiSetDate(bD);bC=bB.get(f);A=bC.call(bB,bD);}bA[X].html(A);bA.syncEventsUI();}}}});aP.Scheduler=af;var bd=aP.Component.create({NAME:aK,AUGMENTS:[aP.WidgetStdMod],ATTRS:{bodyContent:{value:ak},eventClass:{valueFn:function(){return aP.SchedulerEvent;}},filterFn:{validator:ba,value:function(A){return true;}},height:{value:600},isoTime:{value:false,validator:bf},name:{value:ak,validator:bm},navigationDateFormatter:{value:function(bA){var A=this;var bB=A.get(ao);return aP.DataType.Date.format(bA,{format:"%A, %d %B, %Y",locale:bB.get(bs)});
},validator:ba},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:bf},triggerNode:{setter:aP.one},visible:{value:false}},BIND_UI_ATTRS:[bp],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},getAdjustedViewDate:function(bA){var A=this;return bA;},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return p.clearTime(new Date());},limitDate:function(bA,bB){var A=this;if(p.after(bA,bB)){bA=p.clone(bB);}return bA;},plotEvents:function(){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetDate:function(A){},_afterRender:function(bB){var A=this;var bA=A.get(ao);A._uiSetScrollable(A.get(bp));},_setScheduler:function(bB){var A=this;var bA=A.get(ao);if(bA){A.removeTarget(bA);}if(bB){A.addTarget(bB);bB.after(["*:add","*:remove","*:reset"],aP.bind(A.flushViewCache,A));}return bB;},_uiSetScrollable:function(bB){var A=this;var bA=A.bodyNode;if(bA){bA.toggleClass(c,bB);bA.toggleClass(C,!bB);}}}});aP.SchedulerView=bd;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","button-group","model","model-list","widget-stdmod"]});AUI.add("aui-scheduler-view-day",function(bu){var bE=bu.Lang,az=bE.isBoolean,r=bE.isFunction,al=bE.isNumber,bK=bE.isObject,bn=bE.isString,Y=bu.DataType.DateMath,br=bu.WidgetStdMod,by="a",j=",",Z=".",x="",O="%",a7=" ",o="data-colnumber",bf="scheduler-view",ak="scheduler-view-day",e=bu.cached(function(){var bQ=bu.config.doc,bO=bQ.createElement("div"),A=bQ.getElementsByTagName("body")[0],bP=0.1;if(A){bO.style.cssText="position:absolute;visibility:hidden;overflow:scroll;width:20px;";bO.appendChild(bQ.createElement("p")).style.height="1px";A.insertBefore(bO,A.firstChild);bP=bO.offsetWidth-bO.clientWidth;A.removeChild(bO);}return bP;},null,0.1),D=function(A,bO){return function(bQ){var bP=bQ.all(A);return(bP.size()>=bO)?bP:null;};},be=function(bO,A){return Math.round(bO/A)*A;},bc=function(A){return parseFloat(A)||0;},aJ="activeColumn",bb="activeView",E="allDay",av="boundingBox",S="col",ae="colDaysNode",bw="colHeaderDaysNode",z="colblank",q="coldata",an="colday",a="colgrid",L="colspan",g="coltime",aU="columnData",ay="columnDayHeader",ao="columnShims",aM="columnTime",at="container",M="creationStartDate",a1="date",ba="viewDate",bC="day",J="days",t="delegateConfig",a9="disabled",aT="division",bg="dotted",v="draggingEvent",bl="duration",ag="endDate",bG="eventClass",a8="eventPlaceholder",bM="eventRecorder",l="eventWidth",bq="filterFn",am="first",aL="grid",a0="gridContainer",aF="grip",bL="hd",bt="header",aH="headerDateFormatter",bJ="headerTableNode",aC="headerView",aS="headerViewConfig",aq="headerViewLabelNode",bi="height",aI="horizontal",au="host",aj="hourHeight",n="icon",V="isoTime",N="label",aw="left",af="locale",f="marginRight",P="marker",aG="markercell",aA="markercellsNode",B="markers",a6="markersNode",bN="node",bs="offsetHeight",bv="pad",H="parentNode",aY="proxy",T="px",Q="region",bh="resizer",bo="resizerNode",bd="resizing",aB="right",k="scheduler",ah="scheduler-event",I="shim",bx="startDate",K="startXY",bp="strings",ax="table",a2="tableNode",aV="time",U="timesNode",W="today",aW="top",aZ="view",ad="visible",a5="width",a4="data",u=bu.getClassName,c=u(n),w=u(n,aF,bg,aI),aD=u(bf,ax,a4),ap=u(ah),aP=u(ah,a9),bk=u(ah,aY),F=u(k,W),X=u(k,W,bL),s=u(bf,q),b=u(bf,a),bz=u(bf,aL),bA=u(bf,aL,at),aE=u(bf,bC,bt,S),m=u(bf,bC,bt,bC),bm=u(bf,bC,bt,bC,am),aQ=u(bf,bC,bt,bC,bv,aB),bD=u(bf,bC,bt,ax),aK=u(bf,bC,bt,aZ,N),aR=u(bf,P,aT),bB=u(bf,aG),C=u(bf,B),bj=u(bf,bC,bh),ar=u(bf,bC,bh,n),a3=u(bf,bC,ax),bH=u(bf,bC,ax,S),ai=u(bf,bC,ax,S,I),G=u(bf,bC,ax,z),y=u(bf,bC,ax,an),bF=u(bf,bC,ax,g),aX=u(bf,bC,ax,aV),i='<div class="'+bj+'">'+'<div class="'+[c,w,ar].join(a7)+'"></div>'+"</div>",R='<div class="'+bB+'">'+'<div class="'+aR+'"></div>'+"</div>",h='<span class="'+aK+'">{label}</span>',ab='<table cellspacing="0" cellpadding="0" class="'+a3+'">'+"<tbody>"+'<tr class="'+b+'" height="1">'+'<td height="0" class="'+[bH,G].join(a7)+'"></td>'+'<td class="'+bA+'" colspan="1">'+'<div class="'+bz+'">'+'<div class="'+C+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+s+'">'+'<td class="'+[bH,bF].join(a7)+'"></td>'+"</tr>"+"</tbody>"+"</table>",aN='<td class="'+[bH,y].join(a7)+'" data-colnumber="{colNumber}">'+'<div class="'+ai+'"></div>'+"</td>",d='<div class="'+aX+'">{hour}</div>',ac='<table cellspacing="0" cellpadding="0" class="'+bD+'">'+"<tbody>"+'<tr class="'+aE+'"></tr>'+"</tbody>"+"</table>",aO='<th class="'+m+'" data-colnumber="{colNumber}"><a href="#">&nbsp;</a></th>',aa='<td class="'+[m,bm].join(a7)+'"></td>',p='<th class="'+[m,aQ].join(a7)+'">&nbsp;</th>';var bI=bu.Component.create({NAME:ak,ATTRS:{bodyContent:{value:x},days:{value:1,validator:al},delegateConfig:{value:{},setter:function(bO){var A=this;return bu.merge({dragConfig:{useShim:false},bubbleTargets:A,container:A.get(av),nodes:Z+ap,invalid:"input, select, button, a, textarea, "+Z+aP},bO||{});},validator:bK},eventWidth:{value:95,validator:al},filterFn:{value:function(A){return(A.getHoursDuration()<=24&&!A.get(E));}},headerDateFormatter:{value:function(bO){var A=this;var bP=A.get(k);return bu.DataType.Date.format(bO,{format:"%d %A",locale:bP.get(af)});},validator:bn},headerView:{value:true,validator:az},headerViewConfig:{setter:function(bO){var A=this;return bu.merge({displayDaysInterval:1,displayRows:6,filterFn:function(bP){return((bP.getHoursDuration()>24)||bP.get(E));},height:"auto",visible:true},bO||{});},value:{}},hourHeight:{value:52,validator:al},name:{value:bC},navigationDateFormatter:{value:function(bO){var A=this;var bP=A.get(k);return bu.DataType.Date.format(bO,{format:"%A, %B %d, %Y",locale:bP.get(af)});},validator:r},strings:{value:{allDay:"All day"}},headerTableNode:{valueFn:function(){return bu.Node.create(ac);}},headerViewLabelNode:{valueFn:function(){var bO=this;
var A=bO.get(bp);return bu.Node.create(bE.sub(h,{label:A[E]}));}},resizerNode:{valueFn:function(){return bu.Node.create(i);}},tableNode:{valueFn:function(){return bu.Node.create(ab);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colDaysNode:D(Z+y,1),colHeaderDaysNode:D(Z+m,2),headerTableNode:Z+bD,headerViewLabelNode:Z+aK,markercellsNode:D(Z+bB,24),resizerNode:Z+bj,tableNode:Z+a3,timesNode:D(Z+aX,24)},EXTENDS:bu.SchedulerView,prototype:{initializer:function(){var A=this;A[ae]=A.get(ae);A[bw]=A.get(bw);A[bJ]=A.get(bJ);A[aA]=A.get(aA);A[bo]=A.get(bo);A[a2]=A.get(a2);A[U]=A.get(U);A[aJ]=null;A[aU]=A[a2].one(Z+s);A[ay]=A.headerTableNode.one(Z+aE);A[ao]=A[ae].all(Z+ai);A[aM]=A[a2].one(Z+bF);A[a0]=A[a2].one(Z+bA);A[a6]=A[a2].one(Z+C);if(A.get(aC)){A[aC]=new bu.SchedulerTableView(A.get(aS));}},renderUI:function(){var A=this;A[aM].setContent(A[U]);A[a6].setContent(A[aA]);A[ae].appendTo(A[aU]);A[bw].appendTo(A[ay]);if(A[aC]){A[aC].set(k,A.get(k));A[aC].render();}},bindUI:function(){var A=this;A[bJ].delegate("click",bu.bind(A._onClickDaysHeader,A),Z+m);A[aU].delegate("mousedown",bu.bind(A._onMouseDownTableCol,A),Z+bH);A[aU].delegate("mouseenter",bu.bind(A._onMouseEnterEvent,A),Z+ap);A[aU].delegate("mouseleave",bu.bind(A._onMouseLeaveEvent,A),Z+ap);A[aU].delegate("mousemove",bu.bind(A._onMouseMoveTableCol,A),Z+y);A[aU].delegate("mouseup",bu.bind(A._onMouseUpTableCol,A),Z+bH);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:tickAlignY",A._dragTickAlignY);A.on("schedulerChange",A._onSchedulerChange);A.after("drag:align",A._afterDragAlign);},syncUI:function(){var A=this;bI.superclass.syncUI.apply(this,arguments);A[a0].attr(L,A.get(J));A._setupDragDrop();},syncStdContent:function(){var bO=this;bO.setStdModContent(br.BODY,bO[a2].getDOM());var A=bu.NodeList.create(bO[bJ]);if(bO[aC]){A.push(bO[aC].get(av));A.push(bO.get(aq));}bO.setStdModContent(br.HEADER,A);},calculateEventHeight:function(bP){var bO=this;var A=bO.get(aj);return Math.max(bP*(A/60),A/2);},calculateTop:function(bO){var A=this;return((bO.getHours()*60)+bO.getMinutes()+(bO.getSeconds()/60))*(A.get(aj)/60);},getNextDate:function(){var A=this;var bO=A.get(k).get(a1);return Y.add(bO,Y.DAY,1);},getPrevDate:function(){var A=this;var bO=A.get(k).get(a1);return Y.subtract(bO,Y.DAY,1);},getColumnByDate:function(bO){var A=this;return A[ae].item(A.getDateDaysOffset(bO));},getColumnShimByDate:function(bO){var A=this;return A[ao].item(A.getDateDaysOffset(bO));},getDateByColumn:function(bO){var A=this;var bP=Y.safeClearTime(A.get(k).get(ba));return Y.add(bP,Y.DAY,bO);},getDateDaysOffset:function(bO){var A=this;var bP=Y.safeClearTime(A.get(k).get(ba));return Y.getDayOffset(Y.safeClearTime(bO),bP);},getYCoordTime:function(bR){var bO=this;var A=bO.get(aj);var bS=bc((bR/A).toFixed(2));var bQ=Math.floor((bS*100)%100*0.6);var bP=Math.floor(bS);return[bP,bQ,0];},plotEvent:function(bP){var A=this;var bQ=bP.get(bN);if(bQ.size()<2){bP.addPaddingNode();}var bS=bP.get(bN).item(0);var bO=bP.get(bN).item(1);var bR=A.getColumnShimByDate(bP.get(ag));var bT=A.getColumnShimByDate(bP.get(bx));if(bT){bT.append(bS);if(bP.get(ad)){bS.show();}}else{bS.hide();}if(bR){if(bR.compareTo(bT)||bP.isDayBoundaryEvent()){bO.hide();}else{bR.append(bO);if(bP.get(ad)){bO.show();}}}else{bO.hide();}bP.syncUI();A.syncEventTopUI(bP);A.syncEventHeightUI(bP);},plotEvents:function(){var A=this;var bO=A.get(k);var bP=A.get(bq);A[ao].each(function(bT,bS){var bQ=bO.getEventsByDay(A.getDateByColumn(bS),true);var bR=[];bT.empty();bu.Array.each(bQ,function(bU){if(bP.apply(A,[bU])){A.plotEvent(bU);bR.push(bU);}});A.syncEventsIntersectionUI(bR);});if(A.get(aC)){A.syncHeaderViewUI();}},syncColumnsUI:function(){var A=this;A[ae].each(function(bQ,bP){var bO=A.getDateByColumn(bP);bQ.toggleClass(F,Y.isToday(bO));});},syncDaysHeaderUI:function(){var bO=this;var bQ=bO.get(k).get(ba);var bP=bO.get(aH);var A=bO.get(af);bO[bw].all(by).each(function(bT,bS){var bR=Y.add(bQ,Y.DAY,bS);bT.toggleClass(X,Y.isToday(bR));bT.html(bP.call(bO,bR));});},syncEventsIntersectionUI:function(bO){var A=this;var bP=A.get(l);A.get(k).flushEvents();bu.Array.each(bO,function(bR){var bT=A.findEventIntersections(bR,bO);var bS=bT.length;var bQ=(bP/bS);bu.Array.each(bT,function(bV,bW){var bU=bV.get(bN).item(0);var bY=bQ*bW;var bX=bQ*1.7;if(bW===(bS-1)){bX=bP-bY;}bU.setStyle(a5,bX+O);bU.setStyle(aw,bY+O);var bZ=bU.get(H);if(bZ){bZ.insert(bU,bW);}bV._filtered=true;});});},syncEventHeightUI:function(bQ){var bO=this;var bU=bQ.get(ag);var A=bQ.get(bx);var bR=Y.clone(A);bR.setHours(24,0,0);var bS=Y.getMinutesOffset(bO.limitDate(bU,bR),A);bQ.get(bN).item(0).set(bs,bO.calculateEventHeight(bS));var bP=bQ.get(bN).item(1);if(bP.inDoc()){var bT=Y.getMinutesOffset(bU,Y.toMidnight(bQ.getClearEndDate()));bP.set(bs,bO.calculateEventHeight(bT));}},syncEventTopUI:function(bO){var A=this;bO.get(bN).item(0).setStyle(aW,A.calculateTop(bO.get(bx))+T);bO.get(bN).item(1).setStyle(aW,0);},syncHeaderViewUI:function(){var bO=this;if(bO.get(aC)){var bQ=bO[aC];bQ.plotEvents();var bR=bQ.get(av);bR.setStyle(f,e());var bP=bR.one(Z+aD);var A=Math.max(bP.get(bs),40);bQ.set(bi,A);bO._fillHeight();}},calculateYDelta:function(bP,bO){var A=this;return(bO[1]-bP[1])/(A.get(aj)/2)*30;},findEventIntersections:function(bO,bP){var A=this;var bQ=[];bu.Array.each(bP,function(bR){if(!bO._filtered&&bR.get(ad)&&bO.intersectHours(bR)){bQ.push(bR);}});return bQ;},getXYDelta:function(bO){var A=this;var bP=bO.currentTarget.getXY(),bQ=[bO.pageX,bO.pageY];return bu.Array.map(bP,function(bS,bR){return(bQ[bR]-bS);});},getTickY:function(){var A=this;return be(Math.ceil(A.get(aj)/2),10);},roundToNearestHour:function(bO,bP){var A=this;bO.setHours(bP[0],be(bP[1],A.getTickY()),bP[2]);},_afterDragAlign:function(bP){var bO=this;var A=bP.target;if(!bO[K]){bO[K]=A.actXY;}A.actXY[0]=null;},_dragTickAlignX:function(bP){var bO=this;
var bS=bO[v];if(bS&&!bO[bd]){var bQ=bO[a8];var bR=bc(bP.attr(o))-bO.startColNumber;bO.draggingEventStartDate=Y.add(bS.get(bx),Y.DAY,bR);var A=Y.clone(bO.draggingEventStartDate);Y.copyHours(A,bQ.get(bx));bQ.move(A,{silent:true});bO.plotEvent(bQ);}},_dragTickAlignY:function(A){var bT=this;var bO=bT.get(k);var bV=bO.get(bM);var bQ=bT[v];if(bQ){var bU=A.target.get(au);var bR=bT[a8];var bS=bT.calculateYDelta(bT[K],bU.actXY);if(bT[bd]){var bP=Y.add(bT.draggingEventEndDate,Y.MINUTES,bS);if(Y.getMinutesOffset(bP,bT.draggingEventStartDate)<30){return;}bR.set(ag,bP,{silent:true});}else{bR.move(Y.add(bT.draggingEventStartDate,Y.MINUTES,bS),{silent:true});}bT.plotEvent(bR);}},_setupDragDrop:function(){var bO=this,bR=bO[a8];if(!bR){var bP=bO.get(k);bR=new bP.eventModel({scheduler:bP});bR.removeTarget(bP);bR.get(bN).addClass(bk);bR.set(ad,false,{silent:true});bO[a8]=bR;}if(!bO.delegate){bO.delegate=new bu.DD.Delegate(bO.get(t));}var A=bO.delegate.dd;A.unplug(bu.Plugin.DDConstrained);A.unplug(bu.Plugin.DDNodeScroll);var bQ=bO.bodyNode.get(Q);bQ.bottom=Infinity;bQ.top=-Infinity;A.plug(bu.Plugin.DDConstrained,{bubbleTargets:bO,constrain:bQ,stickY:true,tickY:bO.get(aj)/2});A.plug(bu.Plugin.DDNodeScroll,{node:bO.bodyNode,scrollDelay:150});},_uiSetDate:function(bO){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(bQ){var A=this;var bP=A.get(k);if(bQ.target.test(by)){var bR=bP.getViewByName(bC);if(bR){var bO=bc(bQ.currentTarget.attr(o));bP.set(ba,A.getDateByColumn(bO));bP.set(bb,bR);}}bQ.preventDefault();},_onEventDragEnd:function(bO){var A=this;var bQ=A[v];if(bQ){var bP=A[a8];bP.set(ad,false,{silent:true});bQ.set(ad,true,{silent:true});bQ.copyDates(bP);A.get(k).syncEventsUI();}A[K]=null;A[v]=null;},_onEventDragStart:function(bP){var A=this;var bR=A[v]=A.delegate.dd.get(bN).getData(ah);if(bR){var bQ=A[a8];bQ.copyPropagateAttrValues(bR,null,{silent:true});A.plotEvent(bQ);bR.set(ad,false,{silent:true});A.draggingEventStartDate=Y.clone(bR.get(bx));A.draggingEventEndDate=Y.clone(bR.get(ag));var bO=A.getColumnByDate(bR.get(bx));A.startColNumber=bO?bc(bO.attr(o)):0;}},_onMouseDownTableCol:function(bO){var bT=this;var bS=bO.target;var bQ=bT.get(k);var bU=bQ.get(bM);if(bU&&!bQ.get(a9)){bU.hideOverlay();if(bS.test(Z+ai)){bT[K]=[bO.pageX,bO.pageY];var bV=bc(bO.currentTarget.attr(o));var bP=bT.getDateByColumn(bV);var A=bT.getXYDelta(bO);bT.roundToNearestHour(bP,bT.getYCoordTime(A[1]));var bR=Y.add(bP,Y.MINUTES,bU.get(bl));bU.move(bP,{silent:true});bU.setAttrs({allDay:false,endDate:bR},{silent:true});bT[M]=bP;bO.halt();}else{if(bS.test([Z+bj,Z+ar].join(j))){bT[bd]=true;}}}bT.get(av).unselectable();},_onMouseEnterEvent:function(bP){var A=this;var bQ=bP.currentTarget;var bO=bQ.getData(ah);if(bO&&!bO.get(a9)){A[bo].appendTo(bQ);}},_onMouseLeaveEvent:function(bO){var A=this;if(!A[bd]){A._removeResizer();}},_onMouseMoveTableCol:function(bR){var bO=this;var bQ=bR.currentTarget;var bP=bO.get(k).get(bM);if(bO[aJ]!==bQ){bO[aJ]=bQ;bO._dragTickAlignX(bO[aJ]);}var bS=bO[M];if(bS){var bU=be(bO.calculateYDelta(bO[K],[bR.pageX,bR.pageY]),bO.getTickY());var bT=(bU>=bO._delta);if(bO._delta!==bU){if(bU>0){var A=bT?Math.max(bU,bP.get(bl)):bU;bP.set(ag,Y.add(bS,Y.MINUTES,A),{silent:true});}else{bP.set(bx,Y.add(bS,Y.MINUTES,bU),{silent:true});}bO.plotEvent(bP);bO._delta=bU;}}},_onMouseUpTableCol:function(bQ){var A=this;var bP=A.get(k);var bO=bP.get(bM);if(bO&&!bP.get(a9)){if(A[M]){A.plotEvent(bO);bO.showOverlay([bQ.pageX,bQ.pageY]);}}A[M]=null;A[bd]=false;A[K]=null;A._removeResizer();A.get(av).selectable();},_onSchedulerChange:function(bO){var A=this;if(A[aC]){A[aC].set(k,bO.newVal);}},_removeResizer:function(){var A=this;A[bo].remove();},_valueColDaysNode:function(){var A=this;var bQ=A.get(J);var bO=[],bP=0;while(bQ--){bO.push(bu.Lang.sub(aN,{colNumber:bP++}));}return bu.NodeList.create(bO.join(x));},_valueColHeaderDaysNode:function(){var A=this;var bQ=A.get(J);var bO=[],bP=0;bO.push(aa);while(bQ--){bO.push(bu.Lang.sub(aO,{colNumber:bP++}));}bO.push(p);return bu.NodeList.create(bO.join(x));},_valueMarkercellsNode:function(){var A=this;var bO=[],bP;for(bP=0;bP<=23;bP++){bO.push(R);}return bu.NodeList.create(bO.join(x));},_valueTimesNode:function(){var A=this;var bQ=A.get(V);var bP=[],bO;for(bO=0;bO<=23;bO++){bP.push(bE.sub(d,{hour:bQ?Y.toIsoTimeString(bO):Y.toUsTimeString(bO,false,true)}));}return bu.NodeList.create(bP.join(x));}}});bu.SchedulerDayView=bI;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view-table","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-view-week",function(g){var j=g.Lang,f=j.isFunction,m="",n="&mdash;",o=" ",h=g.DataType.DateMath,i=h.WEEK_LENGTH,b="scheduler-view-week",e="date",l="days",d="firstDayOfWeek",k="locale",p="scheduler",a="week";var c=g.Component.create({NAME:b,ATTRS:{bodyContent:{value:m},days:{value:7},headerViewConfig:{value:{displayDaysInterval:i}},name:{value:a},navigationDateFormatter:{valueFn:function(){return this._valueNavigationDateFormatter;},validator:f}},EXTENDS:g.SchedulerDayView,prototype:{getAdjustedViewDate:function(t){var q=this;var s=q.get(p);var r=s.get(d);return h.getFirstDayOfWeek(t,r);},getNextDate:function(){var q=this;var s=q.get(p);var r=s.get(e);var t=q._firstDayOfWeek(r);return h.add(t,h.WEEK,1);},getPrevDate:function(){var q=this;var s=q.get(p);var r=s.get(e);var t=q._firstDayOfWeek(r);return h.subtract(t,h.WEEK,1);},getToday:function(){var q=this;var r=c.superclass.getToday.apply(this,arguments);return q._firstDayOfWeek(r);},_firstDayOfWeek:function(s){var q=this;var t=q.get(p);var r=t.get(d);return h.getFirstDayOfWeek(s,r);},_valueNavigationDateFormatter:function(t){var s=this;var u=s.get(p);var r=u.get(k);var q=s._firstDayOfWeek(t);var v=g.DataType.Date.format(q,{format:"%B %d",locale:r});var x=h.add(q,h.DAY,s.get(l)-1);var w=g.DataType.Date.format(x,{format:(h.isMonthOverlapWeek(t)?"%B %d":"%d")+", %Y",locale:r});return[v,n,w].join(o);}}});g.SchedulerWeekView=c;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view-day"]});
AUI.add("aui-scheduler-view-table",function(an){var aa=an.Lang,aH=aa.isFunction,aQ=aa.isString,q=an.DataType.DateMath,ai=an.WidgetStdMod,aY=q.WEEK_LENGTH,a6="-",l=".",S="",a5=" ",al="scheduler-view",av="scheduler-view-table",a8=function(A,a9){return function(bb){var ba=bb.all(A);return(ba.size()>=a9)?ba:null;};},aw="body",f="close",ao="col",H="colHeaderDaysNode",w="colgrid",aD="colspan",I="columnDayHeader",J="columnTableGrid",a="container",am="content",az="data",aI="day",i="displayDaysInterval",V="displayRows",ad="div",aA="down",ar="endDate",a4="event",aR="events",O="eventsOverlay",aM="filterFn",B="first",L="firstDayOfWeek",j="grid",C="header",d="headerDateFormatter",z="headerTableNode",af="icon",c="left",aV="locale",aL="more",t="next",v="node",o="overlay",m="right",s="row",P="rowsContainerNode",U="scheduler",ag="scheduler-event",aU="showMore",aS="startDate",M="strings",n="table",aB="tableGridNode",u="tableRowContainer",p="tableRows",aP="tbody",ax="title",a2="tl",k="today",aT="tr",W="viewDate",ac="visible",K=an.getClassName,r=K(af),a3=K(af,"arrowstop-1-l"),g=K(af,"arrowstop-1-r"),aq=K(al,n,w),a7=K(al,n,w,B),aJ=K(al,n,w,k),ak=K(al,n,a),T=K(al,n,aR,o,v),b=K(al,n,aR,o,v,aw),aG=K(al,n,aR,o,v,f),ae=K(al,n,C,ao),ay=K(al,n,C,aI),X=K(al,n,C,n),aj=K(al,n,aL),aX=K(al,n,s),aN=K(al,n,s,a),G=K(al,n,az),E=K(al,n,az,ao),Z=K(al,n,az,ao,ax),a1=K(al,n,az,ao,ax,aA),ab=K(al,n,az,ao,ax,B),N=K(al,n,az,ao,ax,t),Q=K(al,n,az,ao,ax,k),x=K(al,n,az,a4),aO=K(al,n,az,a4,c),aZ=K(al,n,az,a4,m),R=K(al,n,az,B),ah=K(al,n,j),F=K(al,n,j,B),aW='<div class="'+ak+'">'+'<div class="'+aN+'"></div>'+"</div>",ap='<div class="'+T+'">'+'<div class="'+b+'"></div>'+'<a href="javascript:;" class="'+aG+'">{label}</a>'+"</div>",aK='<td class="'+aq+'">&nbsp;</td>',a0='<th class="'+ay+'"><div>&nbsp;</div></th>',h='<table cellspacing="0" cellpadding="0" class="'+X+'">'+"<tbody>"+'<tr class="'+ae+'"></tr>'+"</tbody>"+"</table>",aF='<a href="javascript:;" class="'+aj+'">{label} {count}</a>',aC='<div class="'+aX+'" style="top: {top}%; height: {height}%;"></div>',Y='<table cellspacing="0" cellpadding="0" class="'+G+'">'+"<tbody></tbody>"+"</table>",aE='<table cellspacing="0" cellpadding="0" class="'+ah+'">'+"<tbody>"+"<tr></tr>"+"</tbody>"+"</table>",y='<span class="'+[r,a3].join(a5)+'"></span>',au='<span class="'+[r,g].join(a5)+'"></span>',D='<td class="'+E+'"><div></div></td>',at="<tr></tr>";var e=an.Component.create({NAME:av,ATTRS:{bodyContent:{value:S},displayDaysInterval:{value:42},displayRows:{value:4},fixedHeight:{value:true},name:{value:n},headerDateFormatter:{value:function(a9){var A=this;var ba=A.get(U);return an.DataType.Date.format(a9,{format:"%A",locale:ba.get(aV)});},validator:aQ},navigationDateFormatter:{value:function(a9){var A=this;var ba=A.get(U);return an.DataType.Date.format(a9,{format:"%b %Y",locale:ba.get(aV)});},validator:aH},scrollable:{value:false},strings:{value:{close:"Close",showMore:"Show more"}},headerTableNode:{valueFn:function(){return an.Node.create(h);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},rowsContainerNode:{valueFn:function(){return an.Node.create(aW);}},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{colHeaderDaysNode:a8(l+ay,7),headerTableNode:l+X,rowsContainerNode:l+ak,tableGridNode:a8(l+ah,7)},EXTENDS:an.SchedulerView,prototype:{evtDateStack:null,evtRenderedStack:null,rowDataTableStack:null,initializer:function(){var A=this;A.evtDateStack={};A.evtRenderedStack={};A.rowDataTableStack={};A[H]=A.get(H);A[z]=A.get(z);A[P]=A.get(P);A[aB]=A.get(aB);A[I]=A.headerTableNode.one(l+ae);A[J]=an.NodeList.create();A[u]=A[P].one(l+aN);A[p]=an.NodeList.create();},bindUI:function(){var A=this;A[P].delegate("click",an.bind(A._onClickMore,A),l+aj);},renderUI:function(){var A=this,a9=A._getDisplayRowsCount(),ba;for(ba=0;ba<a9;ba++){A[p].push(A.buildGridRowNode(ba));}A._renderEventsOverlay();A[H].appendTo(A[I]);A[p].appendTo(A[u]);},buildEventsRow:function(a9,be,bd){var A=this;var ba=A.get(V);var bc=0;var bb=an.Node.create(at);A.loopDates(a9,be,function(bn,bj){if(bc>bj){return;}var bo=A.getIntersectEvents(bn);var bl=A._getRenderableEvent(bo,a9,be,bn);var bh=an.Node.create(D);var bg=bh.one(ad);if((ba<bo.length)&&(bd===(ba-1))){var bm=A.get(M);var bi=an.Node.create(aa.sub(aF,{count:(bo.length-(ba-1)),label:bm[aU]}));bi.setData(aR,bo);bg.append(bi);}else{if(bl){var bf=A._getEvtSplitInfo(bl,bn,a9,be);bh.attr(aD,bf.colspan);bc+=(bf.colspan-1);A._syncEventNodeContainerUI(bl,bg,bf);A._syncEventNodeUI(bl,bg,bn);var bk=String(bn.getTime());A.evtRenderedStack[bk].push(bl);}}bc++;bb.append(bh);});return bb;},buildEventsTable:function(A,bc){var bi=this,bg=bi.get(V),bf=q.clearTime(bi._findCurrentIntervalStart()),be=String(bf.getTime()).concat(A.getTime()).concat(bc.getTime()),bh=bi.rowDataTableStack[be],bd;if(!bh){bh=an.Node.create(Y);var bb=bh.one(aP);var ba=bi.buildEventsTitleRow(bh,A,bc);bb.append(ba);for(bd=0;bd<bg;bd++){var a9=bi.buildEventsRow(A,bc,bd);bb.append(a9);}bi.rowDataTableStack[be]=bh;}return bh;},buildEventsTitleRow:function(ba,a9,bc){var A=this;var bb=an.Node.create(at);A.loopDates(a9,bc,function(be,bd){var bf=an.Node.create(D);bf.addClass(Z).toggleClass(ab,(bd===0)).toggleClass(Q,q.isToday(be)).toggleClass(N,q.isToday(q.subtract(be,q.DAY,1))).toggleClass(a1,q.isToday(q.subtract(be,q.WEEK,1)));bb.append(bf.setContent(be.getDate()));});return bb;},buildGridRowNode:function(bd){var ba=this;var bb=ba._getDisplayRowsCount();var a9=100/bb;var A=ba._getTableGridNode(bd);var bc=an.Node.create(aa.sub(aC,{height:a9,top:a9*bd}));bc.append(A.toggleClass(F,(bd===0)));return bc;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtRenderedStack={};A.rowDataTableStack={};},getIntersectEvents:function(a9){var A=this;var bc=A.get(U);var bb=String(a9.getTime());if(!A.evtDateStack[bb]){var ba=bc.getIntersectEvents(a9);A.evtDateStack[bb]=ba.filter(A.get(aM));}return A.evtDateStack[bb];},getNextDate:function(){var A=this;var ba=A.get(U);var bb=ba.get(W);var a9=A.get(i);return q.add(bb,q.DAY,a9);},getPrevDate:function(){var A=this;
var ba=A.get(U);var bb=ba.get(W);var a9=A.get(i);return q.subtract(bb,q.DAY,a9);},hideEventsOverlay:function(){var A=this;A[O].set(ac,false);},loopDates:function(A,bb,be,bf,bd){var bg=this;var a9=q.clone(A);var ba=bb.getTime();var bc;for(bc=0;a9.getTime()<=ba;bc++){be.apply(bg,[a9,bc]);a9=q.add(a9,(bf||q.DAY),(bd||1));}},plotEvents:function(){var a9=this;var bc=a9._findCurrentIntervalStart();var A=q.safeClearTime(bc);a9.flushViewCache();a9.hideEventsOverlay();a9.bodyNode.all(l+G).remove();var ba=a9.get(i);var bb=Math.min(ba,aY);a9[p].each(function(bg,be){var bd=q.add(A,q.DAY,bb*be);var bh=q.add(bd,q.DAY,bb-1);var bf=a9.buildEventsTable(bd,bh);if(be===0){bf.addClass(R);}bg.append(bf);});},syncDaysHeaderUI:function(){var a9=this;var bc=a9.get(U);var bd=bc.get(W);var bb=a9.get(d);var A=a9.get(aV);var ba=a9._findFirstDayOfWeek(bd);a9.colHeaderDaysNode.all(ad).each(function(bg,bf){var be=q.add(ba,q.DAY,bf);bg.html(bb.call(a9,be));});},syncGridUI:function(){var bi=this;var bc=bi.getToday();var a9=bi.get(U);bi[J].removeClass(aJ);var bb=bi._findCurrentIntervalStart();var be=bi._findCurrentIntervalEnd();if(q.between(bc,bb,be)){var A=a9.get(L);var bg=bi._findFirstDayOfWeek(bc);var bd=q.getWeekNumber(bc,A)-q.getWeekNumber(bb,A);var bh=(bc.getDate()-bg.getDate());var ba=bi._getCellIndex([bh,bd]);var bf=bi[J].item(ba);if(bf){bf.addClass(aJ);}}},syncStdContent:function(){var A=this;A.setStdModContent(ai.BODY,A[P].getDOM());A.setStdModContent(ai.HEADER,A[z].getDOM());},_findCurrentIntervalEnd:function(){var A=this;var ba=A.get(U);var bb=ba.get(W);var a9=A.get(i);return q.add(bb,q.DAY,a9);},_findCurrentIntervalStart:function(){var A=this;var a9=A.get(U);return a9.get(W);},_findFirstDayOfWeek:function(ba){var A=this;var bb=A.get(U);var a9=bb.get(L);return q.getFirstDayOfWeek(ba,a9);},_getCellIndex:function(a9){var A=this;return a9[1]*aY+a9[0];},_getDisplayRowsCount:function(){var A=this;var a9=A.get(i);return Math.ceil(a9/aY);},_getDisplayRowDaysCount:function(){var A=this;var a9=A.get(i);return Math.min(a9,aY);},_getEvtLabel:function(ba){var a9=this;var bb=ba.get(ar);var A=ba.get(aS);return[A.getHours(),a6,bb.getHours(),a5,ba.get(am)].join(S);},_getEvtSplitInfo:function(bd,bg,A,bb){var be=this;var a9=bd.getClearStartDate();var bc=bd.getClearEndDate();var bf=q.getDayOffset(bb,bg);var ba={colspan:Math.min(q.getDayOffset(bc,bg),bf)+1,left:q.before(a9,A),right:q.after(bc,bb)};return ba;},_getRenderableEvent:function(bh,A,bb,bi){var bg=this,be=String(bi.getTime()),ba;if(!bg.evtRenderedStack[be]){bg.evtRenderedStack[be]=[];}for(ba=0;ba<bh.length;ba++){var bf=bh[ba];var a9=bf.get(aS);var bd=q.after(bi,a9)&&!q.isDayOverlap(bi,A);var bc=!q.isDayOverlap(a9,bi);var bj=an.Array.indexOf(bg.evtRenderedStack[be],bf)>-1;if(!bj&&(bc||bd)){return bf;}}return null;},_getTableGridNode:function(be){var a9=this,bb=a9.get(i),A=a9[aB].item(be),bd=A.one(aT),ba;for(ba=0;ba<Math.min(bb,aY);ba++){var bc=an.Node.create(aK);bd.append(bc);if(ba===0){bc.addClass(a7);}a9[J].push(bc);}return A;},_onClickMore:function(ba){var A=this;var bb=ba.target;var a9=bb.getData(aR);var bc=an.NodeList.create();an.Array.each(a9,function(be){var bd=be.get(v).item(0).clone();bd.setData(ag,be);bd.setStyles({height:"auto",left:0,position:"relative",top:0,width:"auto"});bc.push(bd);});A[O].bodyNode.one(l+b).setContent(bc);A[O].setAttrs({visible:true,xy:bb.getXY()});},_renderEventsOverlay:function(){var a9=this;var A=a9.get(M);a9[O]=new an.Overlay({align:{points:[a2,a2]},bodyContent:aa.sub(ap,{label:A[f]}),render:a9[P],visible:false,width:250,zIndex:450});a9[O].bodyNode.delegate("click",an.bind(a9.hideEventsOverlay,a9),l+aG);},_syncEventNodeContainerUI:function(a9,bb,ba){var A=this;bb.addClass(x);if(ba.left){bb.addClass(aO).prepend(y);}if(ba.right){bb.addClass(aZ).append(au);}},_syncEventNodeUI:function(bh,a9,bj){var bi=this;var bc=bi.get(U);var A=bc.get(L);var bb=bh.get(v);var ba=bh.get(aS);var bg=q.clearTime(bi._findCurrentIntervalStart());var bd=q.getFirstDayOfWeek(new Date(Math.max(ba,bg)),A);var bf=Math.floor(q.getDayOffset(bj,bd)/aY);if(bb.size()<=bf){bh.addPaddingNode();}var be=bb.item(bf);be.setStyles({height:"auto",left:0,top:0,width:"auto"});be.appendTo(a9);bh.syncUI();},_uiSetDate:function(a9){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;var a9=A.get(i);var ba=Math.min(a9,aY);return A._valueNodeList(ba,a0);},_valueTableGridNode:function(){var A=this;var a9=A.get(i);var ba=Math.min(a9,aY);return A._valueNodeList(ba,aE);},_valueNodeList:function(bb,ba){var A=this;var a9=[];while(bb--){a9.push(ba);}return an.NodeList.create(a9.join(S));}}});an.SchedulerTableView=e;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-base","overlay"]});AUI.add("aui-scheduler-view-table-dd",function(j){var S=j.Lang,G=S.isObject,f=j.DataType.DateMath,K=f.WEEK_LENGTH,p=".",F="scheduler-event",z="scheduler-view",M="boundingBox",C="col",g="colgrid",H="content",h="data",b="dd",i="delegate",w="delegateConfig",y="disabled",B="displayDaysInterval",e="dragNode",c="dragging",l="draggingEvent",E="eventRecorder",m="lasso",P="node",I="offsetHeight",J="offsetWidth",R="proxy",L="proxyNode",u="region",r="rowsContainerNode",s="scheduler",N="startDate",t="table",Q="visible",d=j.getClassName,q=d(F),O=d(F,y),o=d(z,t,g),x=d(z,t,c),k=d(z,t,m),a=d(z,t,R,P),D=d(z,t,h,C),v='<div class="'+k+'"></div>',n='<div class="'+a+'"></div>';j.SchedulerTableViewDD=function(){};j.SchedulerTableViewDD.ATTRS={delegateConfig:{value:{},setter:function(T){var A=this;return j.merge({dragConfig:{offsetNode:false,useShim:false},bubbleTargets:A,container:A.get(M),nodes:p+q,invalid:"input, select, button, a, textarea, "+p+O},T||{});},validator:G}};j.mix(j.SchedulerTableViewDD.prototype,{initializer:function(){var A=this;A[L]=j.Node.create(n);A.after(A.viewDDBindUI,A,"bindUI");A.after(A.viewDDRenderUI,A,"renderUI");A.after(A.viewDDSyncUI,A,"syncUI");},viewDDBindUI:function(){var A=this;var T=A.get(s).get(E);if(T){T.on({cancel:j.bind(A.removeLasso,A),save:j.bind(A.removeLasso,A)});
}A[r].on({mousedown:j.bind(A._onMouseDownGrid,A),mousemove:j.bind(A._onMouseMoveGrid,A),mouseup:j.bind(A._onMouseUpGrid,A)});A.after("drag:align",A._afterDragAlign);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);},viewDDRenderUI:function(){var A=this;},viewDDSyncUI:function(){var A=this;A._setupDragDrop();},removeLasso:function(){var A=this;if(A[m]){A[m].remove();}},removeProxy:function(){var A=this;if(A[L]){A[L].remove();}},renderLasso:function(Z,T){var af=this;var W=Z;var Y=T;if(Z[1]>T[1]){W=T;Y=Z;}var ag=W[0],ab=W[1],U=Y[0],A=Y[1],V;af.removeLasso();af.lasso=j.NodeList.create();for(V=ab;V<=A;V++){var X=af.gridCellHeight,ae=af.gridCellWidth,ac=0,aa=(X*V);if(V===ab){if(ab===A){ac+=Math.min(ag,U)*ae;ae*=Math.abs(U-ag)+1;}else{ac+=ag*ae;ae*=K-ag;}}else{if(V===A){ae*=U+1;}else{ae*=K;}}var ad=j.Node.create(v);af.lasso.push(ad);af[r].append(ad);ad.sizeTo(ae,X);ad.setXY(af._offsetXY([ac,aa],1));}},_afterDragAlign:function(A){var Z=this;var aa=A.target;var W=Z.bodyNode.get(u);var X={bottom:A.pageY,left:A.pageX,right:A.pageX,top:A.pageY};if(!j.DOM.inRegion(null,W,true,X)){return;}var Y=Z[l];var T=[A.pageX,A.pageY];var V=Z._findPosition(Z._offsetXY(T,-1));if(Y&&Z._hasLassoChanged(V)){Z.lassoLastPosition=V;var U=f.add(Z._getPositionDate(V),f.MINUTES,Y.getMinutesDuration());Z.renderLasso(V,Z._getDatePosition(U));}},_findPosition:function(V){var A=this;var U=Math.floor(V[0]/A.gridCellWidth);var T=Math.floor(V[1]/A.gridCellHeight);return[U,T];},_getDatePosition:function(U){var T=this;var V=T._findCurrentIntervalStart();var W=f.getDayOffset(U,V);var A=[];A[1]=Math.floor(W/K);A[0]=W%K;return A;},_getPositionDate:function(U){var T=this;var W=T._findCurrentIntervalStart();var A=f.safeClearTime(T._findFirstDayOfWeek(W));var V=f.add(A,f.DAY,T._getCellIndex(U));V.setHours(0,0,0,0);return V;},_hasLassoChanged:function(T){var A=this;var U=A.lassoLastPosition||A.lassoStartPosition;return U&&((T[0]!==U[0])||(T[1]!==U[1]));},_offsetXY:function(V,U){var A=this;var T=A[r].getXY();return[V[0]+T[0]*U,V[1]+T[1]*U];},_onEventDragEnd:function(T){var A=this;var V=A[l];if(V){var U=A._getPositionDate(A.lassoLastPosition);f.copyHours(U,V.get(N));V.move(U);V.set(Q,true,{silent:true});A[r].removeClass(x).unselectable();T.target.set(e,A.originalDragNode);A.removeLasso();A.removeProxy();A.get(s).syncEventsUI();}A[l]=null;},_onEventDragStart:function(W){var A=this;var X=A[l]=A[i][b].get(P).getData(F);if(X){A._syncCellDimensions();var U=[W.pageX,W.pageY];var V=A._findPosition(A._offsetXY(U,-1));var T=f.add(A._getPositionDate(V),f.MINUTES,X.getMinutesDuration());A.renderLasso(V,A._getDatePosition(T));X.set(Q,false,{silent:true});A._syncProxyNodeUI(X);A.lassoStartPosition=A.lassoLastPosition=V;A[r].addClass(x).unselectable();A.originalDragNode=W.target.get(e);W.target.set(e,A[L]);}},_onMouseDownGrid:function(W){var A=this;var V=A.get(s);var U=V.get(E);var X=W.target;if(U&&X.test([p+o,p+D].join())){A._recording=true;A._syncCellDimensions();var T=A._offsetXY([W.pageX,W.pageY],-1);A.lassoStartPosition=A.lassoLastPosition=A._findPosition(T);A.renderLasso(A.lassoStartPosition,A.lassoLastPosition);A[r].unselectable();}},_onMouseMoveGrid:function(V){var T=this;var W=V.currentTarget;var U=[V.pageX,V.pageY];var A=T._findPosition(T._offsetXY(U,-1));if(T._recording&&T._hasLassoChanged(A)){T.lassoLastPosition=A;T.renderLasso(T.lassoStartPosition,A);}},_onMouseUpGrid:function(Y){var T=this;var X=T.get(s);var V=X.get(E);if(V&&T._recording&&!X.get(y)){var W=T._getPositionDate(T.lassoStartPosition);var U=T._getPositionDate(T.lassoLastPosition);var A=new Date(Math.min(W,U));A.setHours(0,0,0);var Z=new Date(Math.max(W,U));Z.setHours(23,59,59);V.setAttrs({allDay:true,endDate:Z,startDate:A},{silent:true});V.showOverlay([Y.pageX,Y.pageY]);T._recording=false;}},_setupDragDrop:function(){var T=this;if(!T[i]){T[i]=new j.DD.Delegate(T.get(w));}var A=T[i][b];A.unplug(j.Plugin.DDConstrained);A.unplug(j.Plugin.DDNodeScroll);A.unplug(j.Plugin.DDProxy);A.plug(j.Plugin.DDConstrained,{bubbleTargets:T,constrain:T.bodyNode});A.plug(j.Plugin.DDNodeScroll,{node:T.bodyNode,scrollDelay:150});A.plug(j.Plugin.DDProxy,{moveOnEnd:false,positionProxy:false});},_syncCellDimensions:function(){var A=this;var U=A.get(B);var T=Math.ceil(U/K);var V=Math.min(U,K);A.gridCellHeight=A[r].get(I)/T;A.gridCellWidth=A[r].get(J)/V;},_syncProxyNodeUI:function(T){var A=this;var U=T.get(P).item(0);A[L].setStyles({backgroundColor:U.getStyle("backgroundColor"),display:"block",width:"200px"});A[L].appendTo(A[r]);A[L].setContent(T.get(H));}});j.Base.mix(j.SchedulerTableView,[j.SchedulerTableViewDD]);},"@VERSION@",{skinnable:false,requires:["aui-scheduler-view-table","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-view-month",function(o){var f=o.Lang,a=f.isFunction,c=o.DataType.DateMath,r=".",h="col",g="data",d="date",v="firstDayOfWeek",e="locale",m="month",w="nomonth",i="scheduler",j="table",u="tableRowContainer",n="title",q="viewDate",p="scheduler-view",l="scheduler-view-month",t=o.getClassName,s=t(l,j,g,h,w),k=t(p,j,g,h,n);var b=o.Component.create({NAME:l,ATTRS:{displayDaysInterval:{readOnly:true,value:42},name:{value:m},navigationDateFormatter:{value:function(y){var x=this;var z=x.get(i);return o.DataType.Date.format(y,{format:"%B %Y",locale:z.get(e)});},validator:a}},EXTENDS:o.SchedulerTableView,prototype:{getAdjustedViewDate:function(y){var x=this;return c.findMonthStart(y);},getNextDate:function(){var x=this;var z=x.get(i);var y=z.get(d);return c.add(y,c.MONTH,1);},getPrevDate:function(){var x=this;var z=x.get(i);var y=z.get(d);return c.subtract(y,c.MONTH,1);},plotEvents:function(){var x=this;o.SchedulerMonthView.superclass.plotEvents.apply(x,arguments);var y=x.get(i);var C=y.get(q);var B=c.findMonthEnd(C);var A=c.findMonthStart(C);var z=x._findCurrentIntervalStart();var D=x[u].all(r+k);D.each(function(G,E){var F=c.add(z,c.DAY,E);if(c.before(F,A)||c.after(F,B)){G.addClass(s);}});},_findCurrentIntervalStart:function(){var x=this;var y=x.get(i);
var z=y.get(q);return x._findFirstDayOfWeek(z);},_findFirstDayOfWeek:function(z){var x=this;var A=x.get(i);var y=A.get(v);return c.getFirstDayOfWeek(z,y);}}});o.SchedulerMonthView=b;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view-table"]});AUI.add("aui-scheduler-event-recorder",function(y){var at=y.Lang,G=at.isArray,S=at.isObject,p=at.isString,C=at.isUndefined,ah=y.IO.prototype._serialize,o=y.DataType.DateMath,K="-",E=".",d=" ",R="scheduler-event",ap="scheduler-event-recorder",e="activeView",N="arrow",aa="body",u="bodyContent",n="borderRadius",ai="boundingBox",P="cancel",X="click",t="constrain",T="content",r="date",Z="dateFormat",s="delete",ao="endDate",h="event",k="footerContent",c="form",M="header",ag="isoTime",aq="node",U="offsetHeight",Y="offsetWidth",D="overlay",al="overlayOffset",ar="px",an="recorder",af="rendered",I="region",am="right",W="save",H="scheduler",ae="schedulerChange",q="shadow",ak="startDate",a="strings",f="submit",j="template",Q="title",ad="toolbar",L="top",ac="visibleChange",m=y.getClassName,F=m(R),ab=m(R,Q),x=m(R,an),w=m(H,h,an,D),b=m(H,h,an,D,N),v=m(H,h,an,D,N,L),V=m(H,h,an,D,N,q),O=m(H,h,an,D,aa),J=m(H,h,an,D,T),l=m(H,h,an,D,r),aj=m(H,h,an,D,c),B=m(H,h,an,D,M),z=new y.Template('<div class="',V," ",b,'"></div>','<div class="',b,'"></div>','<input type="hidden" name="startDate" value="{startDate}" />','<input type="hidden" name="endDate" value="{endDate}" />','<div class="',B,'">','<input class="',J,'" name="content" value="{content}" />',"</div>",'<div class="',O,'">','<label class="',l,'">{date}</label>',"</div>"),i='<form class="'+aj+'" id="schedulerEventRecorderForm"></form>';var g=y.Component.create({NAME:ap,ATTRS:{allDay:{value:false},content:{},duration:{value:60},dateFormat:{validator:p,value:"%a, %B %d,"},event:{},eventClass:{valueFn:function(){return y.SchedulerEvent;}},strings:{value:{},setter:function(A){return y.merge({"delete":"Delete","description-hint":"e.g., Dinner at Brian's",cancel:"Cancel",description:"Description",edit:"Edit",save:"Save",when:"When"},A||{});},validator:S},overlay:{validator:S,value:{constrain:true,visible:false,width:300,zIndex:500}},overlayOffset:{value:[15,-38],validator:G},template:{value:z},toolbar:{setter:function(av){var au=this;var A=au.get(a);return y.merge({children:[{handler:y.bind(au._handleSaveEvent,au),label:A[W]},{handler:y.bind(au._handleCancelEvent,au),label:A[P]},{handler:y.bind(au._handleDeleteEvent,au),label:A[s]}]},av||{});},validator:S,value:{}}},EXTENDS:y.SchedulerEvent,prototype:{initializer:function(){var A=this;A.get(aq).addClass(x);A.publish("cancel",{defaultFn:A._defCancelEventFn});A.publish("delete",{defaultFn:A._defDeleteEventFn});A.publish("edit",{defaultFn:A._defEditEventFn});A.publish("save",{defaultFn:A._defSaveEventFn});A.after(ae,A._afterSchedulerChange);A[D]=new y.Overlay(A.get(D));A[ad]=new y.Toolbar(A.get(ad));},getOverlayContentNode:function(){var A=this;var au=A[D].get(ai);return au.one(E+J);},getUpdatedSchedulerEvent:function(av){var A=this,aw=A.get(h),au={silent:!aw},ax=A.serializeForm();if(!aw){aw=A.clone();}aw.set(H,A.get(H),{silent:true});aw.setAttrs(y.merge(ax,av),au);return aw;},_afterSchedulerChange:function(aw){var A=this;var av=aw.newVal;var au=av.get(ai);au.delegate(X,y.bind(A._onClickSchedulerEvent,A),E+F);},_defCancelEventFn:function(au){var A=this;A.get(aq).remove();A.hideOverlay();},_defDeleteEventFn:function(av){var A=this;var au=A.get(H);au.removeEvents(A.get(h));A.hideOverlay();au.syncEventsUI();},_defEditEventFn:function(av){var A=this;var au=A.get(H);A.hideOverlay();au.syncEventsUI();},_defSaveEventFn:function(av){var A=this;var au=A.get(H);au.addEvents(av.newSchedulerEvent);A.hideOverlay();au.syncEventsUI();},_handleCancelEvent:function(au){var A=this;A.fire("cancel");au.preventDefault();},_handleDeleteEvent:function(au){var A=this;A.fire("delete",{schedulerEvent:A.get(h)});au.preventDefault();},_handleSaveEvent:function(av){var A=this,au=A.get(h)?"edit":"save";A.fire(au,{newSchedulerEvent:A.getUpdatedSchedulerEvent()});av.preventDefault();},_onClickSchedulerEvent:function(av){var A=this;var au=av.currentTarget.getData(R);if(au){A.set(h,au,{silent:true});A.showOverlay([av.pageX,av.pageY]);A.get(aq).remove();}},_onOverlayVisibleChange:function(au){var A=this;if(au.newVal){A.populateForm();if(!A.get(h)){var av=A.getOverlayContentNode();if(av){setTimeout(function(){av.selectText();},0);}}}else{A.set(h,null,{silent:true});A.get(aq).remove();}},_onSubmitForm:function(au){var A=this;A._handleSaveEvent(au);},_renderOverlay:function(){var au=this;var A=au.get(a);au[D].render();au[ad].render();var av=au[D].get(ai);av.addClass(w);au[D].set(k,au[ad].get(ai));au[D].on(ac,y.bind(au._onOverlayVisibleChange,au));au.formNode=y.Node.create(i);au[D].set(u,au.formNode);au.formNode.on(f,y.bind(au._onSubmitForm,au));},getFormattedDate:function(){var av=this;var au=av.get(Z);var ax=(av.get(h)||av);var az=ax.get(ao);var ay=ax.get(H);var A=ax.get(ak);var aw=(ay.get(e).get(ag)?o.toIsoTimeString:o.toUsTimeString);return[ax._formatDate(A,au),aw(A),K,aw(az)].join(d);},getTemplateData:function(){var au=this,A=au.get(a),av=au.get(h)||au,aw=av.get(T);if(C(aw)){aw=A["description-hint"];}return{content:aw,date:au.getFormattedDate(),endDate:av.get(ao).getTime(),startDate:av.get(ak).getTime()};},hideOverlay:function(){var A=this;A[D].hide();},populateForm:function(){var A=this;A.formNode.setContent(A.get(j).parse(A.getTemplateData()));},serializeForm:function(){var A=this;return y.QueryString.parse(ah(A.formNode.getDOM()));},showOverlay:function(aJ,az){var aH=this,aB=aJ.concat([]),aA=aH[D],ay=aA.get(ai);if(!aH[D].get(af)){aH._renderOverlay();}aA.show();var aG=ay.all(E+b),aF=aG.item(0),au=aF.get(Y),aC=aF.get(U);aG.removeClass(v);aG.show();aJ[0]-=ay.get(Y)/2;aJ[1]-=(ay.get(U)+(aC/2));var ax=aA.getConstrainedXY(aJ);if(ax[1]!==aJ[1]){aJ[1]=(aB[1]+(aC/2));aG.addClass(v);}aA.set("xy",aJ);aJ=aA.get("xy");var aE={left:aB[0],right:aB[0],top:aB[1],bottom:aB[1]},aw=ay.getStyle(n).replace(ar,"");if(!y.DOM.inRegion(null,ay.get(I),true,aE)){var av=(au/2)-aw,aD=Math.max(aJ[0],aB[0]),aI=aJ[0]+ay.get(Y)-au,A=Math.min(aD,aI);
A-=av;aG.setX(A);}else{aG.hide();}}}});y.SchedulerEventRecorder=g;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-base","aui-template","aui-toolbar","io-form","querystring","overlay"]});AUI.add("aui-scheduler",function(a){},"@VERSION@",{use:["aui-scheduler-base","aui-scheduler-view-day","aui-scheduler-view-week","aui-scheduler-view-table","aui-scheduler-view-table-dd","aui-scheduler-view-month","aui-scheduler-event-recorder"],skinnable:false});