AUI.add("aui-scheduler-base",function(ab){var O=ab.Lang,av=O.isString,a=O.isArray,d=O.isDate,I=O.isNumber,B=O.isObject,H=function(A){return(A instanceof ab.Scheduler);},s=function(A){return(A instanceof ab.SchedulerView);},Z=function(A){return(A instanceof ab.SchedulerEvent);},t=function(A){return(ab.SchedulerCalendar&&(A instanceof ab.SchedulerCalendar));},h=ab.DataType.DateMath,V=ab.WidgetStdMod,T=".",o="",p=" ",r="scheduler-base",ah="data-view-name",F="activeView",au="clearfix",E="controls",aj="controlsNode",am="current",aa="currentDate",X="currentDateNode",ai="date",af="endDate",ag="eventClass",aw="events",aB="hd",v="header",at="headerNode",m="helper",R="icon",j="iconNextNode",ap="iconPrevNode",az="locale",l="name",P="nav",M="navNode",ao="navigationDateFormat",n="next",c="nextDate",ar="prev",ak="prevDate",aA="rendered",L="scheduler",ax="startDate",D="strings",e="today",ac="todayNode",u="triggerNode",y="view",N="viewStack",aC="views",W="viewsNode",z=ab.getClassName,ad=z(m,au),i=z(R),an=z(r,E),S=z(r,am,ai),f=z(r,aB),U=z(r,R,n),C=z(r,R,ar),ay=z(r,P),x=z(r,e),Y=z(r,y),g=z(r,y,o),q=z(r,aC),al='<div class="'+an+'"></div>',w='<div class="'+S+'"></div>',b='<div class="'+f+'"></div>',aD='<a href="#" class="'+[i,U].join(p)+'">Next</a>',ae='<a href="#" class="'+[i,C].join(p)+'">Prev</a>',k='<div class="'+ay+'"></div>',Q='<a href="#" class="'+x+'">{today}</a>',aq='<a href="#" class="'+[Y,g].join(p)+'{name}" data-view-name="{name}">{label}</a>',J='<div class="'+q+'"></div>';var K=function(){};K.ATTRS={eventClass:{valueFn:function(){return ab.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:a}};ab.mix(K.prototype,{addEvent:function(aE){var A=this;var aF=A.get(aw);if(ab.Array.indexOf(aF,aE)>-1){ab.Array.removeItem(aF,aE);}aF.push(aE);A.set(aw,aF);},addEvents:function(aE){var A=this;ab.Array.each(A._normalizeEvents(aE),ab.bind(A.addEvent,A));},eachEvent:function(aF){var A=this;var aE=A.get(aw);ab.Array.each(aE,aF,A);},removeEvent:function(aE){var A=this;var aF=A.get(aw);if(aF.length){ab.Array.removeItem(aF,aE);A.set(aw,aF);}},removeEvents:function(aE){var A=this;ab.Array.each(A._normalizeEvents(aE),ab.bind(A.removeEvent,A));},_normalizeEvents:function(aF){var A=this;var aE=[];aF=ab.Array(aF);ab.Array.each(aF,function(aG){if(Z(aG)){aE.push(aG);}else{if(t(aG)){if(H(A)){aG.set(L,A);}aE=aE.concat(A._normalizeEvents(aG.get(aw)));}else{aG=new (A.get(ag))(aG);aE.push(aG);}}if(H(A)){aG.set(L,A);aG.set(ag,A.get(ag));}});return aE;},_setEvents:function(aE){var A=this;return A._normalizeEvents(aE);}});ab.SchedulerEventSupport=K;var G=ab.Component.create({NAME:r,ATTRS:{activeView:{validator:s},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(aF){var A=this;var aE=A.get(F);if(aE){return aE.get(ao);}return aF;},value:"%A - %d %b %Y",validator:av},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:d},firstDayOfWeek:{value:0,validator:I},controlsNode:{valueFn:function(){return ab.Node.create(al);}},currentDateNode:{valueFn:function(){return ab.Node.create(w);}},headerNode:{valueFn:function(){return ab.Node.create(b);}},iconNextNode:{valueFn:function(){return ab.Node.create(aD);}},iconPrevNode:{valueFn:function(){return ab.Node.create(ae);}},navNode:{valueFn:function(){return ab.Node.create(k);}},todayNode:{valueFn:function(){return ab.Node.create(this._processTemplate(Q));}},viewsNode:{valueFn:function(){return ab.Node.create(J);}}},HTML_PARSER:{controlsNode:T+an,currentDateNode:T+S,headerNode:T+f,iconNextNode:T+U,iconPrevNode:T+C,navNode:T+ay,todayNode:T+x,viewsNode:T+q},UI_ATTRS:[aa],AUGMENTS:[ab.SchedulerEventSupport,ab.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[N]={};A[aj]=A.get(aj);A[X]=A.get(X);A[v]=A.get(at);A[j]=A.get(j);A[ap]=A.get(ap);A[M]=A.get(M);A[ac]=A.get(ac);A[W]=A.get(W);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ab.Array.each(A.get(aw),function(aE){aE.eachRepeatedEvent(function(aF){delete aF._filtered;});delete aE._filtered;});},getEventsByDay:function(aE,aF){var A=this;aE=h.safeClearTime(aE);return A._getEvents(aE,function(aG){return h.compare(aG.getClearStartDate(),aE)||(aF&&h.compare(aG.getClearEndDate(),aE));});},getIntersectEvents:function(aE){var A=this;aE=h.safeClearTime(aE);return A._getEvents(aE,function(aG){var aF=aG.getClearStartDate();var aH=aG.getClearEndDate();return(h.compare(aE,aF)||h.compare(aE,aH)||h.between(aE,aF,aH));});},sortEventsByDateAsc:function(aE){var A=this;aE.sort(function(aI,aG){var aH=aI.get(af);var aF=aG.get(af);var aK=aI.get(ax);var aJ=aG.get(ax);if(h.after(aK,aJ)||(h.compare(aK,aJ)&&h.before(aH,aF))){return 1;}else{return -1;}});},getViewByName:function(aE){var A=this;return A[N][aE];},getStrings:function(){var A=this;return A.get(D);},getString:function(aE){var A=this;return A.getStrings()[aE];},renderView:function(aE){var A=this;if(aE){aE.show();if(!aE.get(aA)){if(!A.bodyNode){A.setStdModContent(V.BODY,o);}aE.render(A.bodyNode);}}},plotViewEvents:function(aE){var A=this;aE.plotEvents(A.get(aw));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(F));},_afterActiveViewChange:function(aG){var aE=this;if(aE.get(aA)){var aF=aG.newVal;var A=aG.prevVal;if(A){A.hide();}aE.renderView(aF);}},_afterRender:function(aE){var A=this;A.renderView(A.get(F));},_bindDelegate:function(){var A=this;A[W].delegate("click",A._onClickViewTrigger,T+Y,A);A[aj].delegate("click",A._onClickPrevIcon,T+C,A);A[aj].delegate("click",A._onClickNextIcon,T+U,A);A[aj].delegate("click",A._onClickToday,T+x,A);},_createViewTriggerNode:function(aE){var A=this;if(!aE.get(u)){var aF=aE.get(l);aE.set(u,ab.Node.create(O.sub(aq,{name:aF,label:(A.getString(aF)||aF)})));}return aE.get(u);},_getEvents:function(aE,aH){var A=this;var aG=A.get(aw);
var aF=[];ab.Array.each(aG,function(aI){if(aH.apply(A,[aI])){aF.push(aI);}else{if(aI.isRepeatableDate(aE)){var aJ=aI.repeatByDate(aE);aF.push(aJ);}}});A.sortEventsByDateAsc(aF);return aF;},_onClickToday:function(aE){var A=this;A.set(aa,A.get(F).getToday());aE.preventDefault();},_onClickNextIcon:function(aE){var A=this;A.set(aa,A.get(F).get(c));aE.preventDefault();},_onClickPrevIcon:function(aE){var A=this;A.set(aa,A.get(F).get(ak));aE.preventDefault();},_onClickViewTrigger:function(aE){var A=this;var aF=aE.currentTarget.attr(ah);A.set(F,A.getViewByName(aF));aE.preventDefault();},_processTemplate:function(aE){var A=this;return O.sub(aE,A.getStrings());},_setEventRecorder:function(aE){var A=this;if(aE){aE.set(L,A);aE.set(ag,A.get(ag));}},_setViews:function(aF){var A=this;var aE=[];ab.Array.each(aF,function(aG){if(s(aG)&&!aG.get(aA)){aG.set(L,A);aG.set(ag,A.get(ag));aE.push(aG);A[N][aG.get(l)]=aG;}});if(!A.get(F)){A.set(F,aF[0]);}return aE;},syncStdContent:function(){var A=this;var aE=A.get(aC);A[M].append(A[ap]);A[M].append(A[j]);A[aj].append(A[ac]);A[aj].append(A[M]);A[aj].append(A[X]);ab.Array.each(aE,function(aF){A[W].append(A._createViewTriggerNode(aF));});A[v].append(A[aj]);A[v].append(A[W]);A[v].addClass(ad);A.setStdModContent(V.HEADER,A[v].getDOM());},_uiSetCurrentDate:function(aG){var A=this;var aF=ab.DataType.Date.format(aG,{format:A.get(ao),locale:A.get(az)});A[X].html(aF);if(A.get(aA)){var aE=A.get(F);if(aE){aE._uiSetCurrentDate(aG);}A.syncEventsUI();}}}});ab.Scheduler=G;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(b0){var cd=b0.Lang,cq=cd.isObject,bS=cd.isString,aU=cd.isBoolean,aD=cd.isNumber,bI=function(A){return parseFloat(A)||0;},bK=function(cu,A){return Math.round(cu/A)*A;},ao=b0.DataType.DateMath,bX=b0.WidgetStdMod,aJ=ao.WEEK_LENGTH,bL="scheduler-view",aC="scheduler-view-day",b4="scheduler-view-week",ck="scheduler-view-month",a7="activeColumn",bH="activeView",aP="boundingBox",af="col",av="colDaysNode",b2="colHeaderDaysNode",G="colblank",w="coldata",aF="colday",a="colgrid",U="colspan",m="coltime",bk="columnData",aT="columnDayHeader",aH="columnShims",aN="columnTableGrid",bd="columnTime",aM="container",aK="content",a6="creationEndDate",X="creationStartDate",bb="currentDate",bx="data",ca="day",R="days",B="delegateConfig",bF="disabled",V="div",bj="division",Z="down",D="draggingEvent",bQ="duration",ay="endDate",a2="event",cl="eventClass",bE="eventPlaceholder",cs="eventRecorder",q="eventWidth",aE="first",b5="firstDayOfWeek",a9="grid",bu="gridContainer",cr="hd",bZ="header",ba="headerDateFormat",cp="headerTableNode",aO="host",aB="hourHeight",s="icon",aj="isoTime",aQ="left",aw="locale",aa="marker",a4="markercell",aX="markercellsNode",I="markers",bA="markersNode",bC="month",a8="monthContainerNode",e="monthRows",aL="next",ct="node",ai="nomonth",ap="noscroll",bY="offsetHeight",b1="pad",aG="paddingNode",cf="parentEvent",O="parentNode",br="proxy",ag="px",ab="region",aR="rendered",bW="repeated",aY="right",bp="row",p="scheduler",az="scheduler-event",W="scrollable",Q="shim",b3="startDate",T="startXY",aS="table",z="tableGridNode",bv="tableNode",bs="tbody",f="td",bm="time",ah="timesNode",h="title",ak="today",bq="top",au="visible",cg="week",by="width",t="data-colnumber",k="a",bJ="-",bM=".",bG="",bz="%",S=" ",C=b0.getClassName,bl=C(bL,ap),ac=C(bL,W);var aW=b0.Component.create({NAME:bL,AUGMENTS:[b0.WidgetStdMod],ATTRS:{bodyContent:{value:bG},eventClass:{valueFn:function(){return b0.SchedulerEvent;}},height:{value:600},isoTime:{value:false,validator:aU},name:{value:bG,validator:bS},navigationDateFormat:{value:"%A - %d %B, %Y",validator:bS},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:aU},triggerNode:{setter:b0.one},visible:{value:false}},BIND_UI_ATTRS:[W],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var cv=A.get(p);var cu=cv.get(bb);cv.set(bb,cu);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return ao.clearTime(new Date());},limitDate:function(cu,cv){var A=this;if(ao.after(cu,cv)){cu=ao.clone(cv);}return cu;},plotEvents:function(){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(cu){var A=this;A.adjustCurrentDate();A._uiSetScrollable(A.get(W));},_setScheduler:function(cv){var A=this;var cu=A.get(p);if(cu){A.removeTarget(cu);}if(cv){A.addTarget(cv);cv.after("eventsChange",b0.bind(A.flushViewCache,A));}return cv;},_uiSetScrollable:function(cv){var A=this;var cu=A.bodyNode;if(cu){cu.toggleClass(ac,cv);cu.toggleClass(bl,!cv);}},_uiSetVisible:function(cu){var A=this;aW.superclass._uiSetVisible.apply(this,arguments);if(cu&&A.get(aR)){A.adjustCurrentDate();}}}});b0.SchedulerView=aW;var bD=cd.sub;var L=function(A,cu){return function(cw){var cv=cw.all(A);return(cv.size()>=cu)?cv:null;};},aI=C(az),bg=C(az,bF),bO=C(az,br),N=C(p,ak),an=C(p,ak,cr),x=C(bL,w),c=C(bL,a),b6=C(bL,a9),b7=C(bL,a9,aM),bi=C(bL,aa,bj),b9=C(bL,a4),J=C(bL,I),bw=C(bL,aS),cc=C(bL,ca,bZ,aS),r=C(bL,ca,bZ,ca),bh=C(bL,ca,bZ,ca,b1,aY),bR=C(bL,ca,bZ,ca,aE),a1=C(bL,ca,bZ,af),cn=C(bL,aS,af),aA=C(bL,aS,af,Q),M=C(bL,aS,G),F=C(bL,aS,aF),ch=C(bL,aS,m),bo=C(bL,aS,bm),ad='<div class="'+b9+'">'+'<div class="'+bi+'"></div>'+"</div>",ar='<table cellspacing="0" cellpadding="0" class="'+bw+'">'+"<tbody>"+'<tr class="'+c+'" height="1">'+'<td height="0" class="'+[cn,M].join(S)+'"></td>'+'<td class="'+b7+'" colspan="1">'+'<div class="'+b6+'">'+'<div class="'+J+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+x+'">'+'<td class="'+[cn,ch].join(S)+'"></td>'+"</tr>"+"</tbody>"+"</table>",be='<td class="'+[cn,F].join(S)+'" data-colnumber="{colNumber}">'+'<div class="'+aA+'"></div>'+"</td>",j='<div class="'+bo+'">{hour}</div>',at='<table cellspacing="0" cellpadding="0" class="'+cc+'">'+"<tbody>"+'<tr class="'+a1+'"></tr>'+"</tbody>"+"</table>",bf='<th class="'+r+'" data-colnumber="{colNumber}"><a href="#">&nbsp;</a></th>',aq='<td class="'+[r,bR].join(S)+'"></td>',u='<th class="'+[r,bh].join(S)+'">&nbsp;</th>';
var co=b0.Component.create({NAME:aC,ATTRS:{bodyContent:{value:bG},days:{value:1,validator:aD},delegateConfig:{value:{},setter:function(cu){var A=this;return b0.merge({dragConfig:{useShim:false},bubbleTargets:A,container:A.get(aP),nodes:bM+aI,invalid:"input, select, button, a, textarea, "+bM+bg},cu||{});},validator:cq},headerDateFormat:{value:"%d %A",validator:bS},name:{value:ca},hourHeight:{value:52,validator:aD},eventWidth:{value:95,validator:aD},headerTableNode:{valueFn:function(){return b0.Node.create(at);}},tableNode:{valueFn:function(){return b0.Node.create(ar);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colDaysNode:L(bM+F,1),colHeaderDaysNode:L(bM+r,2),headerTableNode:bM+cc,markercellsNode:L(bM+b9,24),tableNode:bM+bw,timesNode:L(bM+bo,24)},EXTENDS:b0.SchedulerView,prototype:{initializer:function(){var A=this;A[av]=A.get(av);A[b2]=A.get(b2);A[cp]=A.get(cp);A[aX]=A.get(aX);A[bv]=A.get(bv);A[ah]=A.get(ah);A[a7]=null;A[bk]=A[bv].one(bM+x);A[aT]=A.headerTableNode.one(bM+a1);A[aH]=A[av].all(bM+aA);A[bd]=A[bv].one(bM+ch);A[bu]=A[bv].one(bM+b7);A[bA]=A[bv].one(bM+J);},renderUI:function(){var A=this;A[bd].setContent(A[ah]);A[bA].setContent(A[aX]);A[av].appendTo(A[bk]);A[b2].appendTo(A[aT]);},bindUI:function(){var A=this;A.headerTableNode.delegate("click",b0.bind(A._onClickDaysHeader,A),bM+r);A[bk].delegate("mousedown",b0.bind(A._onMouseDownTableCol,A),bM+cn);A[bk].delegate("mouseup",b0.bind(A._onMouseUpTableCol,A),bM+cn);A[bk].delegate("mousemove",b0.bind(A._onMouseMoveTableCol,A),bM+F);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:tickAlignY",A._dragTickAlignY);A.after("drag:align",A._afterDragAlign);},syncUI:function(){var A=this;co.superclass.syncUI.apply(this,arguments);A[bu].attr(U,A.get(R));A._setupDragDrop();},syncStdContent:function(){var A=this;A.setStdModContent(bX.BODY,A[bv].getDOM());A.setStdModContent(bX.HEADER,A[cp].getDOM());},calculateEventHeight:function(cv){var cu=this;var A=cu.get(aB);return Math.max(cv*(A/60),A/2);},calculateTop:function(cu){var A=this;return((cu.getHours()*60)+cu.getMinutes()+(cu.getSeconds()/60))*(A.get(aB)/60);},getNextDate:function(){var A=this;var cu=A.get(p).get(bb);return ao.add(cu,ao.DAY,1);},getPrevDate:function(){var A=this;var cu=A.get(p).get(bb);return ao.subtract(cu,ao.DAY,1);},getColumnByDate:function(cu){var A=this;return A[av].item(A.getDateDaysOffset(cu));},getColumnShimByDate:function(cu){var A=this;return A[aH].item(A.getDateDaysOffset(cu));},getDateByColumn:function(cv){var A=this;var cu=ao.safeClearTime(A.get(p).get(bb));return ao.add(cu,ao.DAY,cv);},getDateDaysOffset:function(cv){var A=this;var cu=ao.safeClearTime(A.get(p).get(bb));return ao.getDayOffset(ao.safeClearTime(cv),cu);},getYCoordTime:function(cx){var cu=this;var A=cu.get(aB);var cy=bI((cx/A).toFixed(2));var cw=Math.floor((cy*100)%100*0.6);var cv=Math.floor(cy);return[cv,cw,0];},plotEvent:function(cv){var A=this;var cx=cv.get(ct);var cu=cv.get(aG);var cw=A.getColumnShimByDate(cv.get(ay));var cy=A.getColumnShimByDate(cv.get(b3));if(cy){cy.append(cx);if(cv.get(au)){cx.show();}}else{cx.hide();}if(cw){if(cw.compareTo(cy)||cv.isDayBoundaryEvent()){cu.hide();}else{cw.append(cu);if(cv.get(au)){cu.show();}}}else{cu.hide();}A.syncEventTopUI(cv);A.syncEventHeightUI(cv);},plotEvents:function(){var A=this;var cu=A.get(p);A[aH].each(function(cx,cw){var cv=cu.getEventsByDay(A.getDateByColumn(cw),true);cx.empty();b0.Array.each(cv,function(cy){if(cy.getHoursDuration()<=24){A.plotEvent(cy);}});A.syncEventsIntersectionUI(cv);});},syncColumnsUI:function(){var A=this;A[av].each(function(cw,cv){var cu=A.getDateByColumn(cv);cw.toggleClass(N,ao.isToday(cu));});},syncDaysHeaderUI:function(){var cv=this;var cw=cv.get(p).get(bb);var cu=cv.get(ba);var A=cv.get(aw);cv[b2].all(k).each(function(cz,cy){var cx=ao.add(cw,ao.DAY,cy);var cA=b0.DataType.Date.format(cx,{format:cu,locale:A});cz.toggleClass(an,ao.isToday(cx));cz.html(cA);});},syncEventsIntersectionUI:function(cu){var A=this;var cv=A.get(q);A.get(p).flushEvents();b0.Array.each(cu,function(cx){var cz=A.findEventIntersections(cx,cu);var cy=cz.length;var cw=(cv/cy);b0.Array.each(cz,function(cB,cC){var cA=cB.get(ct);var cE=cw*cC;var cD=cw*1.7;if(cC===(cy-1)){cD=cv-cE;}cA.setStyle(by,cD+bz);cA.setStyle(aQ,cE+bz);var cF=cA.get(O);if(cF){cF.insert(cA,cC);}cB._filtered=true;});});},syncEventHeightUI:function(cw){var cu=this;var cA=cw.get(ay);var A=cw.get(b3);var cx=ao.clone(A);cx.setHours(24,0,0);var cy=ao.getMinutesOffset(cu.limitDate(cA,cx),A);cw.get(ct).set(bY,cu.calculateEventHeight(cy));var cv=cw.get(aG);if(cv.inDoc()){var cz=ao.getMinutesOffset(cA,ao.toMidnight(cw.getClearEndDate()));cv.set(bY,cu.calculateEventHeight(cz));}},syncEventTopUI:function(cu){var A=this;cu.get(aG).setStyle(bq,0);cu.get(ct).setStyle(bq,A.calculateTop(cu.get(b3))+ag);},calculateYDelta:function(cv,cu){var A=this;return(cu[1]-cv[1])/(A.get(aB)/2)*30;},findEventIntersections:function(cu,cv){var A=this;var cw=[];b0.Array.each(cv,function(cx){if(!cu._filtered&&cu.intersectHours(cx)&&(!cx.isDayOverlapEvent()||cx.isDayBoundaryEvent())){cw.push(cx);}});return cw;},getXYDelta:function(cu){var A=this;var cv=cu.currentTarget.getXY(),cw=[cu.pageX,cu.pageY];return b0.Array.map(cv,function(cy,cx){return(cw[cx]-cy);});},getTickY:function(){var A=this;return bK(Math.ceil(A.get(aB)/2),10);},roundToNearestHour:function(cu,cv){var A=this;cu.setHours(cv[0],bK(cv[1],A.getTickY()),cv[2]);},_afterDragAlign:function(cv){var cu=this;var A=cv.target;if(!cu[T]){cu[T]=A.actXY;}A.actXY[0]=null;},_dragTickAlignX:function(cv){var cu=this;var cy=cu[D];if(cy){var cw=cu[bE];var cx=bI(cv.attr(t))-cu.startColNumber;cu.activeColumnDate=ao.add(cy.get(b3),ao.DAY,cx);var A=ao.clone(cu.activeColumnDate);ao.copyHours(A,cw.get(b3));cw.move(A);cu.plotEvent(cw);}},_dragTickAlignY:function(cv){var cu=this;var cy=cu[D];if(cy){var A=cv.target.get(aO);
var cw=cu[bE];var cx=cu.calculateYDelta(cu[T],A.actXY);cw.move(ao.add(cu.activeColumnDate,ao.MINUTES,cx));cu.plotEvent(cw);}},_setupDragDrop:function(){var cu=this;if(!cu[bE]){var cv=cu.get(p);cu[bE]=new (cu.get(cl))({scheduler:cv});cu[bE].removeTarget(cv);cu[bE].get(ct).addClass(bO).hide();cu[bE].get(aG).addClass(bO).hide();}if(!cu.delegate){cu.delegate=new b0.DD.Delegate(cu.get(B));}var A=cu.delegate.dd;A.unplug(b0.Plugin.DDConstrained);A.unplug(b0.Plugin.DDNodeScroll);var cw=cu.bodyNode.get(ab);cw.bottom=Infinity;cw.top=-Infinity;A.plug(b0.Plugin.DDConstrained,{bubbleTargets:cu,constrain:cw,stickY:true,tickY:cu.get(aB)/2});A.plug(b0.Plugin.DDNodeScroll,{node:cu.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(cu){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(cw){var A=this;var cv=A.get(p);if(cw.target.test(k)){var cx=cv.getViewByName(ca);if(cx){var cu=bI(cw.currentTarget.attr(t));cv.set(bb,A.getDateByColumn(cu));cv.set(bH,cx);}}cw.preventDefault();},_onEventDragEnd:function(cu){var A=this;var cw=A[D];if(cw){var cv=A[bE];cv.set(au,false);cw.set(au,true);cw.copyDates(cv);A.get(p).syncEventsUI();}A[T]=null;A[D]=null;},_onEventDragStart:function(cv){var A=this;var cx=A[D]=A.delegate.dd.get(ct).getData(az);if(cx){var cw=A[bE];cw.copyPropagateAttrValues(cx);A.plotEvent(cw);cx.set(au,false);A.activeColumnDate=ao.clone(cx.get(b3));var cu=A.getColumnByDate(cx.get(b3));A.startColNumber=cu?bI(cu.attr(t)):0;}},_onMouseDownTableCol:function(cy){var cu=this;var cx=cu.get(p);var cw=cx.get(cs);if(cw&&!cx.get(bF)){cw.hideOverlay();if(cy.target.test(bM+aA)){cu[T]=[cy.pageX,cy.pageY];var cv=bI(cy.currentTarget.attr(t));var A=cu.getDateByColumn(cv);var cz=cu.getXYDelta(cy);cu.roundToNearestHour(A,cu.getYCoordTime(cz[1]));var cA=ao.add(A,ao.MINUTES,cw.get(bQ));cw.move(A);cw.set(ay,cA);cu[X]=A;cu[a6]=cA;cy.halt();}}cu.get(aP).unselectable();},_onMouseMoveTableCol:function(cx){var A=this;var cw=cx.currentTarget;var cu=A.get(p).get(cs);if(A[a7]!==cw){A[a7]=cw;A._dragTickAlignX(A[a7]);}var cv=A[a6];var cy=A[X];if(cy){var cz=bK(A.calculateYDelta(A[T],[cx.pageX,cx.pageY]),A.getTickY());if(A._delta!==cz){if(cz>0){cu.set(ay,ao.add(cv,ao.MINUTES,cz));}else{cu.set(b3,ao.add(cy,ao.MINUTES,cz));}A.plotEvent(cu);A._delta=cz;}}},_onMouseUpTableCol:function(cw){var A=this;var cv=A.get(p);var cu=cv.get(cs);if(cu&&!cv.get(bF)){if(A[X]){A.plotEvent(cu);cu.showOverlay();}}A[X]=null;A[a6]=null;A[T]=null;A.get(aP).selectable();},_valueColDaysNode:function(){var A=this;var cw=A.get(R);var cu=[],cv=0;while(cw--){cu.push(b0.Lang.sub(be,{colNumber:cv++}));}return b0.NodeList.create(cu.join(bG));},_valueColHeaderDaysNode:function(){var A=this;var cw=A.get(R);var cu=[],cv=0;cu.push(aq);while(cw--){cu.push(b0.Lang.sub(bf,{colNumber:cv++}));}cu.push(u);return b0.NodeList.create(cu.join(bG));},_valueMarkercellsNode:function(){var A=this;var cu=[],cv;for(cv=0;cv<=23;cv++){cu.push(ad);}return b0.NodeList.create(cu.join(bG));},_valueTimesNode:function(){var A=this;var cw=A.get(aj);var cv=[],cu;for(cu=0;cu<=23;cu++){cv.push(bD(j,{hour:cw?ao.toIsoTimeString(cu):ao.toUsTimeString(cu,false,true)}));}return b0.NodeList.create(cv.join(bG));}}});b0.SchedulerDayView=co;var al=b0.Component.create({NAME:b4,ATTRS:{bodyContent:{value:bG},days:{value:7},name:{value:cg}},EXTENDS:b0.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var cw=A.get(p);var cu=cw.get(bb);var cv=cw.get(b5);cw.set(bb,ao.getFirstDayOfWeek(cu,cv));},getNextDate:function(){var A=this;var cv=A.get(p);var cu=cv.get(bb);var cw=A._firstDayOfWeek(cu);return ao.add(cw,ao.WEEK,1);},getPrevDate:function(){var A=this;var cv=A.get(p);var cu=cv.get(bb);var cw=A._firstDayOfWeek(cu);return ao.subtract(cw,ao.WEEK,1);},getToday:function(){var A=this;var cu=al.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(cu);},_firstDayOfWeek:function(cv){var A=this;var cw=A.get(p);var cu=cw.get(b5);return ao.getFirstDayOfWeek(cv,cu);}}});b0.SchedulerWeekView=al;var g=C(s),l=C(s,"arrowstop-1-l"),ci=C(s,"arrowstop-1-r"),bV=C(bL,bC,a),n=C(bL,bC,a,aE),b=C(bL,bC,a,ak),i=C(bL,bC,aM),a3=C(bL,bC,bZ,af),v=C(bL,bC,bZ,ca),cj=C(bL,bC,bZ,aS),bU=C(bL,bC,bp),am=C(bL,bC,bp,aM),bB=C(bL,bC,aS,bx),bT=C(bL,bC,aS,bx,af),a0=C(bL,bC,aS,bx,af,ai),aV=C(bL,bC,aS,bx,af,h),cm=C(bL,bC,aS,bx,af,h,Z),ae=C(bL,bC,aS,bx,af,h,aE),y=C(bL,bC,aS,bx,af,h,aL),P=C(bL,bC,aS,bx,af,h,ak),bn=C(bL,bC,aS,bx,a2),d=C(bL,bC,aS,bx,a2,aQ),o=C(bL,bC,aS,bx,a2,bW),bN=C(bL,bC,aS,bx,a2,aY),aZ=C(bL,bC,aS,bx,aE),bc=C(bL,bC,aS,a9),ce=C(bL,bC,aS,a9,aE),E='<table cellspacing="0" cellpadding="0" class="'+cj+'">'+"<tbody>"+'<tr class="'+a3+'"></tr>'+"</tbody>"+"</table>",K='<th class="'+v+'"><div>&nbsp;</div></th>',cb='<div class="'+i+'">'+'<div class="'+am+'">'+'<div class="'+bU+'" style="top: 0; height: 16.6667%;"></div>'+'<div class="'+bU+'" style="top: 16.6667%; height: 16.6667%;"></div>'+'<div class="'+bU+'" style="top: 33.3333%; height: 16.6667%;"></div>'+'<div class="'+bU+'" style="top: 50%; height: 16.6667%;"></div>'+'<div class="'+bU+'" style="top: 66.6667%; height: 16.6667%;"></div>'+'<div class="'+bU+'" style="top: 83.3333%; height: 16.6667%;"></div>'+"</div>"+"</div>",bt='<table cellspacing="0" cellpadding="0" class="'+bc+'">'+"<tbody>"+"<tr>"+'<td class="'+[bV,n].join(S)+'">&nbsp;</td>'+'<td class="'+bV+'">&nbsp;</td>'+'<td class="'+bV+'">&nbsp;</td>'+'<td class="'+bV+'">&nbsp;</td>'+'<td class="'+bV+'">&nbsp;</td>'+'<td class="'+bV+'">&nbsp;</td>'+'<td class="'+bV+'">&nbsp;</td>'+"</tr>"+"</tbody>"+"</table>",bP='<table cellspacing="0" cellpadding="0" class="'+bB+'">'+"<tbody></tbody>"+"</table>",b8="<tr></tr>",a5='<td class="'+bT+'"><div></div></td>',Y='<span class="'+[g,l].join(S)+'"></span>',H='<span class="'+[g,ci].join(S)+'"></span>';var ax=b0.Component.create({NAME:ck,ATTRS:{bodyContent:{value:bG},name:{value:bC},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},monthContainerNode:{valueFn:function(){return b0.Node.create(cb);}},headerTableNode:{valueFn:function(){return b0.Node.create(E);
}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{tableGridNode:L(bM+bc,7),colHeaderDaysNode:L(bM+v,7),monthContainerNode:bM+i,headerTableNode:bM+cj},EXTENDS:b0.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};A[b2]=A.get(b2);A[cp]=A.get(cp);A[a8]=A.get(a8);A[z]=A.get(z);A[aT]=A.headerTableNode.one(bM+a3);A[aN]=A[z].all(f);A[e]=A[a8].all(bM+bU);},renderUI:function(){var A=this;A.colHeaderDaysNode.appendTo(A[aT]);A[e].each(function(cw,cv){var cu=A[z].item(cv);cw.append(cu.toggleClass(ce,(cv===0)));});},buildEventsTable:function(cu,cz){var cF=this;var cC=5;var cw=ao.clearTime(cF._findCurrentMonthEnd());var cE=ao.clearTime(cF._findCurrentMonthStart());var cB=String(cE.getTime()).concat(cu.getTime()).concat(cz.getTime());var cA=cF.evtDataTableStack[cB];if(!cA){cA=b0.Node.create(bP);var cD=cA.one(bs);var cx=b0.Node.create(b8);cF.loopDates(cu,cz,function(cH,cG){var cI=b0.Node.create(a5);cI.addClass(aV).toggleClass(ae,(cG===0)).toggleClass(P,ao.isToday(cH)).toggleClass(y,ao.isToday(ao.subtract(cH,ao.DAY,1))).toggleClass(cm,ao.isToday(ao.subtract(cH,ao.WEEK,1)));if(ao.before(cH,cE)||ao.after(cH,cw)){cI.addClass(a0);}cx.append(cI.setContent(cH.getDate()));});cD.append(cx);var A;for(A=0;A<cC;A++){var cy=0;var cv=b0.Node.create(b8);cF.loopDates(cu,cz,function(cL,cJ){if(cy<=cJ){var cK=cF.getIntersectEvents(cL),cH=cK[A];var cM=b0.Node.create(a5);if(cH){var cG=cM.one(V);var cI=cF._getEvtSplitInfo(cH,cu,cz);cM.attr(U,cI.colspan);cG.addClass(bn).setContent(cF._getEvtLabel(cH));if(cI.left){cG.addClass(d).prepend(Y);}if(cI.right){cG.addClass(bN).append(H);}if(cH.get(cf)){cG.addClass(o);}cy+=cI.colspan;}else{cy++;}cv.append(cM);}});cD.append(cv);}cF.evtDataTableStack[cB]=cA;}return cA;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(cu){var A=this;var cw=A.get(p);var cv=String(cu.getTime());if(!A.evtDateStack[cv]){A.evtDateStack[cv]=cw.getIntersectEvents(cu);}return A.evtDateStack[cv];},loopDates:function(A,cw,cz,cA,cy){var cB=this;var cu=ao.clone(A);var cv=cw.getTime(),cx;for(cx=0;cu.getTime()<=cv;cx++){cz.apply(cB,[cu,cx]);cu=ao.add(cu,(cA||ao.DAY),(cy||1));}},plotEvents:function(){var cu=this;var cv=cu._findCurrentMonthStart();var A=ao.safeClearTime(cu._findFirstDayOfWeek(cv));cu.bodyNode.all(bM+bB).remove();cu[e].each(function(cz,cx){var cw=ao.add(A,ao.WEEK,cx);var cA=ao.add(cw,ao.DAY,aJ-1);var cy=cu.buildEventsTable(cw,cA);if(cx===0){cy.addClass(aZ);}cz.append(cy);});},syncStdContent:function(){var A=this;A.setStdModContent(bX.BODY,A[a8].getDOM());A.setStdModContent(bX.HEADER,A.headerTableNode.getDOM());},syncGridUI:function(){var cB=this;var cv=cB.getToday();var cu=cB.get(p);cB[aN].removeClass(b);if(ao.isSameMonth(cv,cu.get(bb))){var A=cu.get(b5);var cx=cB._findCurrentMonthStart();var cz=cB._findFirstDayOfWeek(cv);var cw=ao.getWeekNumber(cv,A)-ao.getWeekNumber(cx,A);var cA=(cv.getDate()-cz.getDate());var cy=cB[z].item(cw).all(f).item(cA);if(cy){cy.addClass(b);}}},adjustCurrentDate:function(){var A=this;var cu=A.get(p);cu.set(bb,A._findCurrentMonthStart());},getNextDate:function(){var A=this;var cv=A.get(p);var cu=cv.get(bb);return ao.add(cu,ao.MONTH,1);},getPrevDate:function(){var A=this;var cv=A.get(p);var cu=cv.get(bb);return ao.subtract(cu,ao.MONTH,1);},syncDaysHeaderUI:function(){var cv=this;var cy=cv.get(p);var cw=cy.get(bb);var cu=cv.get(ba);var A=cv.get(aw);var cx=cv._findFirstDayOfWeek(cw);cv.colHeaderDaysNode.all(V).each(function(cB,cA){var cz=ao.add(cx,ao.DAY,cA);var cC=b0.DataType.Date.format(cz,{format:cu,locale:A});cB.html(cC);});},_findCurrentMonthEnd:function(){var A=this;var cv=A.get(p);var cu=cv.get(bb);return ao.findMonthEnd(cu);},_findCurrentMonthStart:function(){var A=this;var cv=A.get(p);var cu=cv.get(bb);return ao.findMonthStart(cu);},_findFirstDayOfWeek:function(cv){var A=this;var cw=A.get(p);var cu=cw.get(b5);return ao.getFirstDayOfWeek(cv,cu);},_getEvtLabel:function(cv){var cu=this;var cw=cv.get(ay);var A=cv.get(b3);return[A.getHours(),bJ,cw.getHours(),S,cv.get(aK)].join(bG);},_getEvtSplitInfo:function(cA,A,cy){var cB=this;var cu=cA.getClearStartDate();var cz=cA.getClearEndDate();var cx=cA.getDaysDuration();var cw={};var cv=1;if(ao.after(cu,A)){cv=Math.min(cx,Math.abs(ao.getDayOffset(cy,cu))+1);if(cv>1){cw.right=true;}}else{cv=Math.abs(ao.getDayOffset(cz,A)+1);if(cv>1){cw.left=true;}}cw.colspan=Math.min(cv,aJ);if(cv>=aJ){cw.right=true;cw.left=true;}return cw;},_uiSetCurrentDate:function(cu){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;return A._valueNodeList(aJ,K);},_valueTableGridNode:function(){var A=this;return A._valueNodeList(aJ,bt);},_valueNodeList:function(cw,cv){var A=this;var cu=[];while(cw--){cu.push(cv);}return b0.NodeList.create(cu.join(bG));}}});b0.SchedulerMonthView=ax;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-event",function(aN){var aq=aN.Lang,bm=aq.isString,f=aq.isDate,bd=aq.isFunction,J=aq.isObject,bg=aq.isBoolean,af=aq.isNumber,a2=aN.ColorUtil,j=aN.DataType.DateMath,a9=aN.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),bi="-",v="&ndash;",aB=".",r="",s=" ",n="_",aQ="_propagateSet",R="activeView",U="borderColor",aS="borderColorRGB",aL="borderStyle",bt="borderWidth",M="Change",a7="color",a0="colorBrightnessFactor",bh="colorSaturationFactor",aJ="content",aj="contentNode",y="disabled",a4="duration",aT="endDate",aW="eventClass",au="eventStack",bn="events",ax="hidden",K="hsbColor",aw="icon",ac="icons",a5="id",a1="isoTime",bs="locale",a3="never",p="node",h="overlay",aP="parentEvent",by="recorder",aR="repeat",bl="repeated",Q="repeatedEvents",bf="repeater",ai="scheduler",ay="scheduler-event",aA="scheduler-event-recorder",bp="startDate",bb="template",aZ="title",e="titleDateFormat",I="titleNode",at="visible",k="paddingNode",m="paddingContentNode",aO="paddingTitleNode",d="%H:%M",ba="%I:%M",G=aN.getClassName,l=G(aw),u=G(ay),aU=G(ay,aJ),E=G(ay,ax),bk=G(ay,y),ar=G(ay,by),aE=G(ay,bl),ap=G(ay,bf),F=G(ay,aZ),br=G(ay,ac),x=G(ay,aw,y),b=G(ay,aw,bl),bv=G(ay,aw,bf);
var W=aN.Component.create({NAME:ay,ATTRS:{borderStyle:{value:"solid",validator:bm},borderWidth:{value:"1px",validator:bm},colorBrightnessFactor:{value:0.75,validator:af},colorSaturationFactor:{value:1.5,validator:af},content:{value:"(no title)",validator:bm},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bm},titleDateFormat:{getter:"_getTitleDateFormat",validator:bm},endDate:{setter:"_setDate",valueFn:function(){var A=j.clone(this.get(bp));A.setHours(A.getHours()+1);return A;}},eventClass:{valueFn:function(){return aN.SchedulerEvent;}},disabled:{value:false,validator:bg},node:{valueFn:function(){return aN.Node.create(this.EVENT_NODE_TEMPLATE).setData(ay,this);},setter:aN.one},paddingNode:{readOnly:true,valueFn:function(){return aN.Node.create(this.EVENT_NODE_TEMPLATE).setData(ay,this);}},parentEvent:{},repeat:{value:r,setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{setter:"_setDate",valueFn:function(){return new Date();}},visible:{value:true,validator:bg}},EXTENDS:aN.Base,PROPAGATE_ATTRS:[bp,aT,aJ,a7,a0,bh,aL,bt,e,at,y],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+u+'">'+'<div class="'+F+'"></div>'+'<div class="'+aU+'"></div>'+'<div class="'+br+'">'+'<span class="'+[l,b].join(s)+'"></span>'+'<span class="'+[l,bv].join(s)+'"></span>'+'<span class="'+[l,x].join(s)+'"></span>'+"</div>"+"</div>",eventStack:null,initializer:function(){var A=this;var X=A.get(p);var L=A.get(k);A[au]={};aN.Array.each(A.get(aW).PROPAGATE_ATTRS,function(Y){A.after(Y+M,A._propagateAttrChange);});A._bindUIAttrs();A[aj]=X.one(aB+aU);A[I]=X.one(aB+F);A[m]=L.one(aB+aU);A[aO]=L.one(aB+F);A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(L,X){L.destroy();});A[au]={};A.get(k).remove(true);A.get(p).remove(true);},copyDates:function(L){var A=this;A.set(aT,j.clone(L.get(aT)));A.set(bp,j.clone(L.get(bp)));},copyPropagateAttrValues:function(L,X){var A=this;A.copyDates(L);aN.Array.each(A.get(aW).PROPAGATE_ATTRS,function(Y){if(!((X||{}).hasOwnProperty(Y))){var bD=L.get(Y);if(!J(bD)){A.set(Y,bD);}}});},getBorderColor:function(){var A=this;return A[aS].hex;},getDaysDuration:function(){var A=this;return j.getDayOffset(A.get(aT),A.get(bp));},getHoursDuration:function(){var A=this;return j.getHoursOffset(A.get(aT),A.get(bp));},getMinutesDuration:function(){var A=this;return j.getMinutesOffset(A.get(aT),A.get(bp));},getSecondsDuration:function(){var A=this;return j.getSecondsOffset(A.get(aT),A.get(bp));},sameEndDate:function(L){var A=this;return j.compare(A.get(aT),L.get(aT));},sameStartDate:function(L){var A=this;return j.compare(A.get(bp),L.get(bp));},isAfter:function(Y){var X=this;var L=X.get(bp);var A=Y.get(bp);return j.after(L,A);},isBefore:function(Y){var X=this;var L=X.get(bp);var A=Y.get(bp);return j.before(L,A);},repeatByDate:function(X){var L=this;var Y=L.uidByDate(X);if(!L[au][Y]){var A=j.clone(X);var bE=j.clone(X);j.copyHours(A,L.get(bp));j.copyHours(bE,L.get(aT));var bD=new L.get(aW)({endDate:bE,parentEvent:L,scheduler:L.get(ai),startDate:A});bD.copyPropagateAttrValues(L);L[au][Y]=bD;}return L[au][Y];},intersects:function(Y){var X=this;var bD=X.get(aT);var L=X.get(bp);var A=Y.get(bp);return(X.sameStartDate(Y)||j.between(A,L,bD));},intersectHours:function(X){var L=this;var bD=L.get(aT);var A=L.get(bp);var Y=j.clone(A);j.copyHours(Y,X.get(bp));return(j.compare(A,Y)||j.between(Y,A,bD));},isDayBoundaryEvent:function(){var A=this;return j.isDayBoundary(A.get(bp),A.get(aT));},isDayOverlapEvent:function(){var A=this;return j.isDayOverlap(A.get(bp),A.get(aT));},isRepeatableDate:function(L){var A=this;var X=A.get(aR);return(X&&X.validate(A,L));},getClearEndDate:function(){var A=this;return j.safeClearTime(A.get(aT));},getClearStartDate:function(){var A=this;return j.safeClearTime(A.get(bp));},move:function(L){var A=this;var X=A.getMinutesDuration();A.set(bp,L);A.set(aT,j.add(j.clone(L),j.MINUTES,X));},uidByDate:function(L){var A=this;L=f(L)?j.safeClearTime(L):A.getClearStartDate();return[ay,L.getTime()].join(n);},setContent:function(X,L){var A=this;A._setContent(aj,X,L);A._setContent(m,X,L);},setTitle:function(X,L){var A=this;A._setContent(I,X,L);A._setContent(aO,X,L);},syncNodeUI:function(L){var A=this;A._syncUIAttrs();A.syncNodeColorUI(L);A.syncNodeTitleUI(L);A.syncNodeContentUI(L);},syncNodeColorUI:function(L){var A=this;var bD=A.get(p);var X=A.get(k);var bE=A.getBorderColor();if(bD&&X){var Y={borderWidth:A.get(bt),borderColor:bE,backgroundColor:A.get(a7),borderStyle:A.get(aL)};bD.setStyles(Y);X.setStyles(Y);}if(L){A.eachRepeatedEvent(function(bF,bG){bF.syncNodeColorUI();});}},syncNodeContentUI:function(L){var A=this;A.setContent(A.get(aJ),L);},syncNodeTitleUI:function(L){var A=this;var Y=A._formatDate(A.get(bp));var X=A._formatDate(A.get(aT));A.setTitle([Y,X].join(s+v+s),L);},split:function(){var A=this,X=j.clone(A.get(bp)),Y=j.clone(A.get(aT));if(A.isDayOverlapEvent()&&!A.isDayBoundaryEvent()){var L=j.clone(X);L.setHours(24,0,0,0);return[[X,j.toMidnight(j.clone(X))],[L,j.clone(Y)]];}return[[X,Y]];},eachRepeatedEvent:function(L){var A=this;aN.each(A[au],L,A);},unlink:function(){var A=this;if(A.get(aP)){A.set(aP,null);}else{A.eachRepeatedEvent(function(L,X){L.unlink();});}A[au]={};A.syncNodeUI();},_afterDisabledChange:function(L){var A=this;A._uiSetDisabled(L.newVal);},_afterVisibleChange:function(L){var A=this;A._uiSetVisible(L.newVal);},_afterRepeatChange:function(L){var A=this;A._uiSetRepeat(L.newVal);},_afterParentEventChange:function(L){var A=this;A._uiSetParentEvent(L.newVal);},_bindUIAttrs:function(){var A=this;A.after({disabledChange:A._afterDisabledChange,visibleChange:A._afterVisibleChange,parentEventChange:A._afterParentEventChange,repeatChange:A._afterRepeatChange});A._syncUIAttrs();},_propagateAttrChange:function(Y){var A=this;var X=Y.attrName;var L=Y.newVal;A.eachRepeatedEvent(function(bD,bE){var bF=bD[aQ+a9(X)];if(bF){bF.apply(A,[bD,X,L]);}else{bD.set(X,Y.newVal);}bD.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,L,Y){var X=j.clone(A.get(aT));
j.copyHours(X,Y);A.set(aT,X);},_propagateSetStartDate:function(L,X,Y){var A=j.clone(L.get(bp));j.copyHours(A,Y);L.set(bp,A);},_setColor:function(L){var A=this;A[K]=a2.rgb2hsb(a2.getRGB(L));A[U]=aN.clone(A[K]);A[U].b*=A.get(a0);A[U].s*=A.get(bh);A[aS]=a2.hsb2rgb(A[U]);return L;},_setContent:function(X,bD,L){var A=this;var Y=A[X];if(Y){Y.setContent(bD);}if(L){A.eachRepeatedEvent(function(bE,bF){bE[X].setContent(bD);});}},_setDate:function(L){var A=this;if(af(L)){L=new Date(L);}return L;},_setRepeat:function(L){var A=this;if(bm(L)){L=aN.SchedulerEventRepeat[L];}return J(L)?L:null;},_setScheduler:function(X){var A=this;var L=A.get(ai);if(L){A.removeTarget(L);}A.addTarget(X);return X;},_syncUIAttrs:function(){var A=this;A._uiSetDisabled(A.get(y));A._uiSetVisible(A.get(at));A._uiSetParentEvent(A.get(aP));A._uiSetRepeat(A.get(aR));},_formatDate:function(X,Y){var L=this;var A=L.get(bs);Y=Y||L.get(e);return aN.DataType.Date.format(X,{format:Y,locale:A});},_getTitleDateFormat:function(X){var A=this;if(!bm(X)){var L=A.get(ai);X=(L&&L.get(R).get(a1))?d:ba;}return X;},_uiSetDisabled:function(L){var A=this;A.get(p).toggleClass(bk,!!L);A.get(k).toggleClass(bk,!!L);},_uiSetParentEvent:function(L){var A=this;A.get(p).toggleClass(aE,!!L);A.get(k).toggleClass(aE,!!L);},_uiSetRepeat:function(X){var A=this;var L=!!X&&X!==aN.SchedulerEventRepeat[a3];A.get(p).toggleClass(ap,L);A.get(k).toggleClass(ap,L);},_uiSetVisible:function(L){var A=this;A.get(p).toggleClass(E,!L);A.get(k).toggleClass(E,!L);}}});aN.SchedulerEvent=W;aN.SchedulerEventRepeat={never:{description:"Never repeat",validate:function(A,L){return false;},value:"never"},daily:{description:"Every day",validate:function(A,L){return true;},value:"daily"},monthly:{description:"Every month",validate:function(L,X){var Y=L.get(aT);var A=L.get(bp);return(A.getDate()===X.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,L){return j.isMonWedOrFri(L);},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,L){return j.isTueOrThu(L);},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,L){return j.isWeekDay(L);},value:"weekDays"},weekly:{description:"Every week",validate:function(L,X){var Y=L.get(aT);var A=L.get(bp);return(A.getDay()===X.getDay());},value:"weekly"},yearly:{description:"Every year",validate:function(L,X){var Y=L.get(aT);var A=L.get(bp);return((A.getMonth()===X.getMonth())&&(A.getDay()===X.getDay()));},value:"yearly"}};var az=aN.Lang,a=az.isArray,J=az.isObject,R="activeView",c="arrow",aY="body",aD="bodyContent",q="boundingBox",aC="cancel",a6="click",aJ="content",aX="date",aK="dateFormat",am="delete",be="description",S="edit",bx="event",aW="eventClass",D="footerContent",aH="form",C="header",w="hide",a1="isoTime",aI="link",p="node",h="overlay",T="overlayOffset",by="recorder",bu="rendered",aR="repeat",a8="save",ai="scheduler",o="schedulerChange",ay="scheduler-event",aA="scheduler-event-recorder",aG="shadow",aF="show",H="startDateChange",P="strings",bb="template",aZ="title",bw="tl",ae="toolbar",bo="submit",bq="value",aV="visibleChange",ab="when",ao="x",an="y",ah="cancel",O="delete",B="edit",aM="save",bz="-",g=".",ag="",i="#",t=aN.IO.prototype._serialize,G=aN.getClassName,u=G(ai,bx),ar=G(ai,bx,by),bA=G(ai,bx,by,h),z=G(ai,bx,by,h,c),bj=G(ai,bx,by,h,c,aG),al=G(ai,bx,by,h,aY),bc=G(ai,bx,by,h,aJ),ak=G(ai,bx,by,h,aX),V=G(ai,bx,by,h,aH),bC=G(ai,bx,by,h,C),Z=G(ai,bx,by,h,aI),av=G(ai,bx,by,h,aR),F=G(ai,bx,aZ),N=new aN.Template('<div class="',bj," ",z,'"></div>','<div class="',z,'"></div>','<input type="hidden" name="startDate" value="{startDate}" />','<input type="hidden" name="endDate" value="{endDate}" />','<div class="',bC,'">','<input class="',bc,'" name="content" value="{content}" />',"</div>",'<div class="',al,'">','<label class="',ak,'">{date}</label>','<select class="',av,'" name="repeat">','<tpl for="eventRepeat">','<option {[ (parent.repeat && parent.repeat.value) == parent.eventRepeat[$i].value ? \'selected="selected"\' : "" ]} value="{value}">{description}</option>',"</tpl>","</select>","</div>"),ad='<a class="'+Z+'" href="javascript:;">{delete}</a>',bB='<form class="'+V+'" id="schedulerEventRecorderForm"></form>';var aa=aN.Component.create({NAME:aA,ATTRS:{content:{value:ag},duration:{value:60},dateFormat:{validator:bm,value:"%a, %B %d,"},event:{},eventClass:{valueFn:function(){return aN.SchedulerEvent;}},strings:{value:{},setter:function(A){return aN.merge({"delete":"Delete","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",save:"Save",when:"When"},A||{});},validator:J},overlay:{validator:J,value:{align:{points:[bw,bw]},visible:false,width:300,zIndex:500}},overlayOffset:{value:[95,-31],validator:a},template:{value:N},toolbar:{setter:function(X){var L=this;var A=L.get(P);return aN.merge({children:[{handler:aN.bind(L._handleSaveEvent,L),label:A[a8]},{handler:aN.bind(L._handleCancelEvent,L),label:A[aC]}]},X||{});},validator:J,value:{}}},EXTENDS:aN.SchedulerEvent,prototype:{initializer:function(){var A=this;A.get(p).addClass(ar);A.publish(ah,{defaultFn:A._defCancelEventFn});A.publish(O,{defaultFn:A._defDeleteEventFn});A.publish(B,{defaultFn:A._defEditEventFn});A.publish(aM,{defaultFn:A._defSaveEventFn});A.after(o,A._afterSchedulerChange);A[h]=new aN.Overlay(A.get(h));A[ae]=new aN.Toolbar(A.get(ae));},_afterSchedulerChange:function(Y){var A=this;var X=Y.newVal;var L=X.get(q);L.delegate(a6,aN.bind(A._onClickSchedulerEvent,A),g+u);},_defCancelEventFn:function(L){var A=this;A.get(p).remove();A.hideOverlay();},_defDeleteEventFn:function(X){var A=this;var L=A.get(ai);L.removeEvent(A.get(bx));A.hideOverlay();L.syncEventsUI();},_defEditEventFn:function(X){var A=this;var L=A.get(ai);A.hideOverlay();L.syncEventsUI();},_defSaveEventFn:function(X){var A=this;var L=A.get(ai);L.addEvent(X.newSchedulerEvent);A.hideOverlay();L.syncEventsUI();},_handleCancelEvent:function(L){var A=this;
A.fire(ah);L.preventDefault();},_handleSaveEvent:function(L){var A=this;A.fire(A.get(bx)?B:aM,{newSchedulerEvent:A.getEventCopy()});L.preventDefault();},_onClickDelete:function(){var A=this;A.fire(O,{schedulerEvent:A.get(bx)});},_onClickSchedulerEvent:function(X){var A=this;var L=X.currentTarget.getData(ay);if(L){A.set(bx,L);A.showOverlay(X.currentTarget);A.get(p).remove();}},_onOverlayVisibleChange:function(Y){var L=this;if(Y.newVal){L.populateForm();if(!L.get(bx)){var X=L[h].get(q);var A=X.one(g+bc);setTimeout(function(){A.selectText();},0);L.deleteNode.hide();}else{L.deleteNode.show();}}else{L.set(bx,null);L.get(p).remove();}},_onSubmitForm:function(L){var A=this;A._handleSaveEvent(L);},_renderOverlay:function(){var L=this;var A=L.get(P);L[h].render();L[ae].render();var X=L[h].get(q);X.addClass(bA);L[h].set(D,L[ae].get(q));L[h].on(aV,aN.bind(L._onOverlayVisibleChange,L));L.deleteNode=aN.Node.create(az.sub(ad,{"delete":A[am]}));L[h].footerNode.append(L.deleteNode);L.formNode=aN.Node.create(bB);L[h].set(aD,L.formNode);L.deleteNode.on(a6,aN.bind(L._onClickDelete,L));L.formNode.on(bo,aN.bind(L._onSubmitForm,L));},getEventCopy:function(){var A=this;var X=A.get(bx);if(!X){X=new (A.get(aW))({endDate:A.get(aT),scheduler:A.get(ai),startDate:A.get(bp)});X.copyPropagateAttrValues(A,{content:true});}var L=A.serializeForm();X.set(aJ,L[aJ]);X.set(aR,L[aR]);return X;},getFormattedDate:function(){var X=this;var L=X.get(aK);var bD=(X.get(bx)||X);var bF=bD.get(aT);var bE=bD.get(ai);var A=bD.get(bp);var Y=(bE.get(R).get(a1)?j.toIsoTimeString:j.toUsTimeString);return[bD._formatDate(A,L),Y(A),bi,Y(bF)].join(s);},getTemplateData:function(){var L=this;var A=L.get(P);var X=(L.get(bx)||L);return{content:X.get(aJ)||A["description-hint"],date:L.getFormattedDate(),endDate:X.get(aT).getTime(),eventRepeat:L.eventRepeatArray,repeat:X.get(aR),startDate:X.get(bp).getTime()};},hideOverlay:function(){var A=this;A[h].hide();},populateForm:function(){var A=this;if(!A.eventRepeatArray){A.eventRepeatArray=[];aN.each(aN.SchedulerEventRepeat,function(X){A.eventRepeatArray.push({description:X[be],value:X[bq]});});}var L=(A.get(bx)||A);A.formNode.setContent(A.get(bb).parse(A.getTemplateData()));},serializeForm:function(){var A=this;return aN.QueryString.parse(t(A.formNode.getDOM()));},showOverlay:function(X,Y){var A=this;if(!A[h].get(bu)){A._renderOverlay();}A[h].show();if(!X){var L=(A.get(bx)||A).get(p);X=L.one(g+F);}A[h].set("align.node",X);Y=Y||A.get(T);A[h].move(A[h].get(ao)+Y[0],A[h].get(an)+Y[1]);}}});aN.SchedulerEventRecorder=aa;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-template","aui-toolbar","io-form","querystring","overlay"]});AUI.add("aui-scheduler-calendar",function(d){var i=d.Lang,j=i.isArray,c=i.isBoolean,b=i.isString,g=function(n){return(n instanceof d.SchedulerEvent);},a="color",l="events",h="pallete",m="scheduler",e="scheduler-calendar",k="visible";var f=d.Component.create({NAME:e,ATTRS:{color:{valueFn:function(){var o=this;var p=o.get(h);var n=Math.ceil(Math.random()*p.length)-1;return p[n];},validator:b},name:{value:"(no name)",validator:b},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:j},scheduler:{lazyAdd:false,setter:"_setScheduler"},visible:{value:true,validator:c}},EXTENDS:d.Base,AUGMENTS:d.SchedulerEventSupport,prototype:{initializer:function(){var n=this;n.after("colorChange",n._afterColorChange);n.on("eventsChange",n._onEventsChange);n.on("visibleChange",n._onVisibleChange);n._uiSetVisible(n.get(k));n._uiSetEvents(n.get(l));},syncEventsColor:function(o){var n=this;d.Array.each(o||n.get(l),function(p){p.set(a,n.get(a));});},_afterColorChange:function(o){var n=this;n.syncEventsColor(n.get(l));},_onEventsChange:function(o){var n=this;var p=o.newVal;var q=n.get(k);d.Array.each(p,function(r){r.set(k,q);});n._uiSetEvents(p);},_onVisibleChange:function(o){var n=this;n._uiSetVisible(o.newVal);},_setScheduler:function(p){var n=this;var o=n.get(m);if(o){n.removeTarget(o);}n.addTarget(p);return p;},_uiSetEvents:function(p){var n=this;var o=n.get(m);n.syncEventsColor(p);if(o){o.removeEvents(n);o.addEvents(p);o.syncEventsUI();}},_uiSetVisible:function(o){var n=this;n.eachEvent(function(p){p.set(k,o);});}}});d.SchedulerCalendar=f;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:false});AUI.add("aui-scheduler",function(a){},"@VERSION@",{skinnable:true,use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event","aui-scheduler-calendar"]});