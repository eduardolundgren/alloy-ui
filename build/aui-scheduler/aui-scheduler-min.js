AUI.add("aui-scheduler-base",function(ac){var P=ac.Lang,aw=P.isString,a=P.isArray,d=P.isDate,I=P.isNumber,B=P.isObject,H=function(A){return(A instanceof ac.Scheduler);},s=function(A){return(A instanceof ac.SchedulerView);},aa=function(A){return(A instanceof ac.SchedulerEvent);},t=function(A){return(ac.SchedulerCalendar&&(A instanceof ac.SchedulerCalendar));},h=ac.DataType.DateMath,W=ac.WidgetStdMod,U=".",o="",p=" ",r="scheduler-base",ai="data-view-name",F="activeView",av="clearfix",E="controls",ak="controlsNode",an="current",ab="currentDate",Y="currentDateNode",aj="date",ag="endDate",ah="eventClass",N="eventRecorder",ax="events",aC="hd",v="header",au="headerNode",m="helper",S="icon",j="iconNextNode",aq="iconPrevNode",aA="locale",l="name",Q="nav",M="navNode",ap="navigationDateFormat",n="next",c="nextDate",at="prev",al="prevDate",aB="rendered",L="scheduler",ay="startDate",D="strings",e="today",ad="todayNode",u="triggerNode",y="view",O="viewStack",aD="views",X="viewsNode",z=ac.getClassName,ae=z(m,av),i=z(S),ao=z(r,E),T=z(r,an,aj),f=z(r,aC),V=z(r,S,n),C=z(r,S,at),az=z(r,Q),x=z(r,e),Z=z(r,y),g=z(r,y,o),q=z(r,aD),am='<div class="'+ao+'"></div>',w='<div class="'+T+'"></div>',b='<div class="'+f+'"></div>',aE='<a href="#" class="'+[i,V].join(p)+'">Next</a>',af='<a href="#" class="'+[i,C].join(p)+'">Prev</a>',k='<div class="'+az+'"></div>',R='<a href="#" class="'+x+'">{today}</a>',ar='<a href="#" class="'+[Z,g].join(p)+'{name}" data-view-name="{name}">{label}</a>',J='<div class="'+q+'"></div>';var K=function(){};K.ATTRS={eventClass:{valueFn:function(){return ac.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:a}};ac.mix(K.prototype,{addEvent:function(aF){var A=this;var aG=A.get(ax);if(ac.Array.indexOf(aG,aF)>-1){ac.Array.removeItem(aG,aF);}aG.push(aF);A.set(ax,aG);},addEvents:function(aF){var A=this;ac.Array.each(A._normalizeEvents(aF),ac.bind(A.addEvent,A));},eachEvent:function(aG){var A=this;var aF=A.get(ax);ac.Array.each(aF,aG,A);},removeEvent:function(aF){var A=this;var aG=A.get(ax);if(aG.length){ac.Array.removeItem(aG,aF);A.set(ax,aG);}},removeEvents:function(aF){var A=this;ac.Array.each(A._normalizeEvents(aF),ac.bind(A.removeEvent,A));},_normalizeEvents:function(aG){var A=this;var aF=[];aG=ac.Array(aG);ac.Array.each(aG,function(aH){if(aa(aH)){aF.push(aH);}else{if(t(aH)){if(H(A)){aH.set(L,A);}aF=aF.concat(A._normalizeEvents(aH.get(ax)));}else{aH=new (A.get(ah))(aH);aF.push(aH);}}if(H(A)){aH.set(L,A);aH.set(ah,A.get(ah));}});return aF;},_setEvents:function(aF){var A=this;return A._normalizeEvents(aF);}});ac.SchedulerEventSupport=K;var G=ac.Component.create({NAME:r,ATTRS:{activeView:{validator:s},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(aG){var A=this;var aF=A.get(F);if(aF){return aF.get(ap);}return aG;},value:"%A - %d %b %Y",validator:aw},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:d},firstDayOfWeek:{value:0,validator:I},controlsNode:{valueFn:function(){return ac.Node.create(am);}},currentDateNode:{valueFn:function(){return ac.Node.create(w);}},headerNode:{valueFn:function(){return ac.Node.create(b);}},iconNextNode:{valueFn:function(){return ac.Node.create(aE);}},iconPrevNode:{valueFn:function(){return ac.Node.create(af);}},navNode:{valueFn:function(){return ac.Node.create(k);}},todayNode:{valueFn:function(){return ac.Node.create(this._processTemplate(R));}},viewsNode:{valueFn:function(){return ac.Node.create(J);}}},HTML_PARSER:{controlsNode:U+ao,currentDateNode:U+T,headerNode:U+f,iconNextNode:U+V,iconPrevNode:U+C,navNode:U+az,todayNode:U+x,viewsNode:U+q},UI_ATTRS:[ab],AUGMENTS:[ac.SchedulerEventSupport,ac.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[O]={};A[ak]=A.get(ak);A[Y]=A.get(Y);A[v]=A.get(au);A[j]=A.get(j);A[aq]=A.get(aq);A[M]=A.get(M);A[ad]=A.get(ad);A[X]=A.get(X);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ac.Array.each(A.get(ax),function(aF){aF.eachRepeatedEvent(function(aG){delete aG._filtered;});delete aF._filtered;});},getEventsByDay:function(aF,aG){var A=this;aF=h.safeClearTime(aF);return A._getEvents(aF,function(aH){return h.compare(aH.getClearStartDate(),aF)||(aG&&h.compare(aH.getClearEndDate(),aF));});},getIntersectEvents:function(aF){var A=this;aF=h.safeClearTime(aF);return A._getEvents(aF,function(aH){var aG=aH.getClearStartDate();var aI=aH.getClearEndDate();return(h.compare(aF,aG)||h.compare(aF,aI)||h.between(aF,aG,aI));});},sortEventsByDateAsc:function(aF){var A=this;aF.sort(function(aJ,aH){var aI=aJ.get(ag);var aG=aH.get(ag);var aL=aJ.get(ay);var aK=aH.get(ay);if(h.after(aL,aK)||(h.compare(aL,aK)&&h.before(aI,aG))){return 1;}else{return -1;}});},getViewByName:function(aF){var A=this;return A[O][aF];},getStrings:function(){var A=this;return A.get(D);},getString:function(aF){var A=this;return A.getStrings()[aF];},renderView:function(aF){var A=this;if(aF){aF.show();if(!aF.get(aB)){if(!A.bodyNode){A.setStdModContent(W.BODY,o);}aF.render(A.bodyNode);}}},plotViewEvents:function(aF){var A=this;aF.plotEvents(A.get(ax));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(F));},_afterActiveViewChange:function(aH){var aF=this;if(aF.get(aB)){var aG=aH.newVal;var A=aH.prevVal;if(A){A.hide();}aF.renderView(aG);var aI=aF.get(N);if(aI){aI.hideOverlay();}}},_afterRender:function(aF){var A=this;A.renderView(A.get(F));},_bindDelegate:function(){var A=this;A[X].delegate("click",A._onClickViewTrigger,U+Z,A);A[ak].delegate("click",A._onClickPrevIcon,U+C,A);A[ak].delegate("click",A._onClickNextIcon,U+V,A);A[ak].delegate("click",A._onClickToday,U+x,A);},_createViewTriggerNode:function(aF){var A=this;if(!aF.get(u)){var aG=aF.get(l);aF.set(u,ac.Node.create(P.sub(ar,{name:aG,label:(A.getString(aG)||aG)})));}return aF.get(u);
},_getEvents:function(aF,aI){var A=this;var aH=A.get(ax);var aG=[];ac.Array.each(aH,function(aJ){if(aI.apply(A,[aJ])){aG.push(aJ);}else{if(aJ.isRepeatableDate(aF)){var aK=aJ.repeatByDate(aF);aG.push(aK);}}});A.sortEventsByDateAsc(aG);return aG;},_onClickToday:function(aF){var A=this;A.set(ab,A.get(F).getToday());aF.preventDefault();},_onClickNextIcon:function(aF){var A=this;A.set(ab,A.get(F).get(c));aF.preventDefault();},_onClickPrevIcon:function(aF){var A=this;A.set(ab,A.get(F).get(al));aF.preventDefault();},_onClickViewTrigger:function(aF){var A=this;var aG=aF.currentTarget.attr(ai);A.set(F,A.getViewByName(aG));aF.preventDefault();},_processTemplate:function(aF){var A=this;return P.sub(aF,A.getStrings());},_setEventRecorder:function(aF){var A=this;if(aF){aF.set(L,A);aF.set(ah,A.get(ah));}},_setViews:function(aG){var A=this;var aF=[];ac.Array.each(aG,function(aH){if(s(aH)&&!aH.get(aB)){aH.set(L,A);aH.set(ah,A.get(ah));aF.push(aH);A[O][aH.get(l)]=aH;}});if(!A.get(F)){A.set(F,aG[0]);}return aF;},syncStdContent:function(){var A=this;var aF=A.get(aD);A[M].append(A[aq]);A[M].append(A[j]);A[ak].append(A[ad]);A[ak].append(A[M]);A[ak].append(A[Y]);ac.Array.each(aF,function(aG){A[X].append(A._createViewTriggerNode(aG));});A[v].append(A[ak]);A[v].append(A[X]);A[v].addClass(ae);A.setStdModContent(W.HEADER,A[v].getDOM());},_uiSetCurrentDate:function(aH){var A=this;var aG=ac.DataType.Date.format(aH,{format:A.get(ap),locale:A.get(aA)});A[Y].html(aG);if(A.get(aB)){var aF=A.get(F);if(aF){aF._uiSetCurrentDate(aH);}A.syncEventsUI();}}}});ac.Scheduler=G;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(cF){var cT=cF.Lang,bc=cT.isBoolean,z=cT.isFunction,aM=cT.isNumber,c8=cT.isObject,ct=cT.isString,cf=function(A){return parseFloat(A)||0;},ci=function(dd,A){return Math.round(dd/A)*A;},av=cF.DataType.DateMath,cA=cF.WidgetStdMod,aU=av.WEEK_LENGTH,ck="scheduler-view",aL="scheduler-view-day",c0="scheduler-view-month",ca="scheduler-view-table",cK="scheduler-view-week",bq="activeColumn",ce="activeView",P="allDay",a2="boundingBox",db="cancel",al="col",aC="colDaysNode",cI="colHeaderDaysNode",K="colblank",y="coldata",aO="colday",a="colgrid",Z="colspan",o="coltime",bL="columnData",ba="columnDayHeader",aQ="columnShims",aZ="columnTableGrid",by="columnTime",aY="container",aV="content",bp="creationEndDate",ac="creationStartDate",bx="currentDate",bZ="data",cQ="day",V="days",D="delegateConfig",cd="disabled",a7="displayDaysInterval",aa="div",bJ="division",c3="dotted",ae="down",H="draggingEvent",cs="duration",aG="endDate",bk="event",c2="eventClass",cc="eventPlaceholder",da="eventRecorder",t="eventWidth",cz="filterFn",aN="first",cL="firstDayOfWeek",b3="fixedHeight",bt="grid",bW="gridContainer",bl="grip",c9="hd",cC="header",bv="headerDateFormat",c6="headerTableNode",bg="headerView",bH="headerViewConfig",aS="headerViewLabelNode",cp="height",bn="horizontal",a1="host",aJ="hourHeight",v="icon",v="icon",ap="isoTime",af="label",a8="lasso",a3="left",aD="locale",m="marginRight",ah="marker",bm="markercell",be="markercellsNode",L="markers",b5="markersNode",b7="month",br="monthContainerNode",cM="monthRowContainer",e="monthRows",E="mousedown",N="mousemove",a6="mouseup",aW="next",dc="node",ao="nomonth",aw="noscroll",cB="offsetHeight",cD="offsetWidth",cG="pad",aP="paddingNode",cV="parentEvent",T="parentNode",bS="proxy",am="px",ai="region",a4="rendered",cx="repeated",cn="resizer",cu="resizerNode",ch="resizing",bf="right",bP="row",bO="rowsContainerNode",cj="save",s="scheduler",aI="scheduler-event",ab="scrollable",U="shim",cJ="startDate",Y="startXY",cv="strings",a5="table",C="tableGridNode",bX="tableNode",b8="tableRowContainer",cZ="tableRows",bU="tbody",g="td",bM="time",an="timesNode",i="title",aq="today",bQ="top",c7="tr",bV="view",aB="visible",cW="week",b1="width",w="data-colnumber",k="a",bI=",",cg="-",cm=".",cb="",b2="%",X=" ",F=cF.getClassName,bK=F(ck,aw),ag=F(ck,ab);var bd=cF.Component.create({NAME:ck,AUGMENTS:[cF.WidgetStdMod],ATTRS:{bodyContent:{value:cb},eventClass:{valueFn:function(){return cF.SchedulerEvent;}},filterFn:{validator:z,value:function(A){return true;}},height:{value:600},isoTime:{value:false,validator:bc},name:{value:cb,validator:ct},navigationDateFormat:{value:"%A - %d %B, %Y",validator:ct},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:bc},triggerNode:{setter:cF.one},visible:{value:false}},BIND_UI_ATTRS:[ab],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var de=A.get(s);var dd=de.get(bx);de.set(bx,dd);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return av.clearTime(new Date());},limitDate:function(dd,de){var A=this;if(av.after(dd,de)){dd=av.clone(de);}return dd;},plotEvents:function(){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(dd){var A=this;A.adjustCurrentDate();A._uiSetScrollable(A.get(ab));},_setScheduler:function(de){var A=this;var dd=A.get(s);if(dd){A.removeTarget(dd);}if(de){A.addTarget(de);de.after("eventsChange",cF.bind(A.flushViewCache,A));}return de;},_uiSetScrollable:function(de){var A=this;var dd=A.bodyNode;if(dd){dd.toggleClass(ag,de);dd.toggleClass(bK,!de);}},_uiSetVisible:function(dd){var A=this;bd.superclass._uiSetVisible.apply(this,arguments);if(dd&&A.get(a4)){A.adjustCurrentDate();}}}});cF.SchedulerView=bd;var b9=cT.sub;var l=cF.cached(function(){var df=cF.config.doc,dd=df.createElement("div"),A=df.getElementsByTagName("body")[0],de=0.1;if(A){dd.style.cssText="position:absolute;visibility:hidden;overflow:scroll;width:20px;";dd.appendChild(df.createElement("p")).style.height="1px";A.insertBefore(dd,A.firstChild);de=dd.offsetWidth-dd.clientWidth;A.removeChild(dd);}return de;},null,0.1);
var O=function(A,dd){return function(df){var de=df.all(A);return(de.size()>=dd)?de:null;};},h=F(v),I=F(v,bl,c3,bn),aR=F(aI),bD=F(aI,cd),cq=F(aI,bS),S=F(s,aq),at=F(s,aq,c9),B=F(ck,y),d=F(ck,a),cN=F(ck,bt),cO=F(ck,bt,aY),aT=F(ck,cQ,cn,v),co=F(ck,cQ,cn),bG=F(ck,ah,bJ),cP=F(ck,bm),M=F(ck,L),bY=F(ck,cQ,a5),cS=F(ck,cQ,cC,a5),u=F(ck,cQ,cC,cQ),bF=F(ck,cQ,cC,cQ,cG,bf),cr=F(ck,cQ,cC,cQ,aN),bj=F(ck,cQ,cC,al),bs=F(ck,cQ,cC,bV,af),c4=F(ck,cQ,a5,al),aH=F(ck,cQ,a5,al,U),R=F(ck,cQ,a5,K),J=F(ck,cQ,a5,aO),cX=F(ck,cQ,a5,o),bN=F(ck,cQ,a5,bM),q='<div class="'+co+'">'+'<div class="'+[h,I,aT].join(X)+'"></div>'+"</div>",aj='<div class="'+cP+'">'+'<div class="'+bG+'"></div>'+"</div>",p='<span class="'+bs+'">{label}</span>',az='<table cellspacing="0" cellpadding="0" class="'+bY+'">'+"<tbody>"+'<tr class="'+d+'" height="1">'+'<td height="0" class="'+[c4,R].join(X)+'"></td>'+'<td class="'+cO+'" colspan="1">'+'<div class="'+cN+'">'+'<div class="'+M+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+B+'">'+'<td class="'+[c4,cX].join(X)+'"></td>'+"</tr>"+"</tbody>"+"</table>",bz='<td class="'+[c4,J].join(X)+'" data-colnumber="{colNumber}">'+'<div class="'+aH+'"></div>'+"</td>",j='<div class="'+bN+'">{hour}</div>',aA='<table cellspacing="0" cellpadding="0" class="'+cS+'">'+"<tbody>"+'<tr class="'+bj+'"></tr>'+"</tbody>"+"</table>",bC='<th class="'+u+'" data-colnumber="{colNumber}"><a href="#">&nbsp;</a></th>',ay='<td class="'+[u,cr].join(X)+'"></td>',x='<th class="'+[u,bF].join(X)+'">&nbsp;</th>';var c5=cF.Component.create({NAME:aL,ATTRS:{bodyContent:{value:cb},days:{value:1,validator:aM},delegateConfig:{value:{},setter:function(dd){var A=this;return cF.merge({dragConfig:{useShim:false},bubbleTargets:A,container:A.get(a2),nodes:cm+aR,invalid:"input, select, button, a, textarea, "+cm+bD},dd||{});},validator:c8},eventWidth:{value:95,validator:aM},filterFn:{value:function(A){return(A.getHoursDuration()<=24&&!A.get(P));}},headerDateFormat:{value:"%d %A",validator:ct},headerView:{value:true,validator:bc},headerViewConfig:{setter:function(dd){var A=this;return cF.merge({displayDaysInterval:1,displayRows:6,filterFn:function(de){return((de.getHoursDuration()>24)||de.get(P));},height:"auto",visible:true},dd||{});},value:{}},hourHeight:{value:52,validator:aM},name:{value:cQ},strings:{value:{allDay:"All day"}},headerTableNode:{valueFn:function(){return cF.Node.create(aA);}},headerViewLabelNode:{valueFn:function(){var dd=this;var A=dd.get(cv);return cF.Node.create(b9(p,{label:A[P]}));}},resizerNode:{valueFn:function(){return cF.Node.create(q);}},tableNode:{valueFn:function(){return cF.Node.create(az);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colDaysNode:O(cm+J,1),colHeaderDaysNode:O(cm+u,2),headerTableNode:cm+cS,headerViewLabelNode:cm+bs,markercellsNode:O(cm+cP,24),resizerNode:cm+co,tableNode:cm+bY,timesNode:O(cm+bN,24)},EXTENDS:cF.SchedulerView,prototype:{initializer:function(){var A=this;A[aC]=A.get(aC);A[cI]=A.get(cI);A[c6]=A.get(c6);A[be]=A.get(be);A[cu]=A.get(cu);A[bX]=A.get(bX);A[an]=A.get(an);A[bq]=null;A[bL]=A[bX].one(cm+B);A[ba]=A.headerTableNode.one(cm+bj);A[aQ]=A[aC].all(cm+aH);A[by]=A[bX].one(cm+cX);A[bW]=A[bX].one(cm+cO);A[b5]=A[bX].one(cm+M);if(A.get(bg)){A[bg]=new cF.SchedulerTableView(A.get(bH));}},renderUI:function(){var A=this;A[by].setContent(A[an]);A[b5].setContent(A[be]);A[aC].appendTo(A[bL]);A[cI].appendTo(A[ba]);if(A[bg]){A[bg].set(s,A.get(s));A[bg].render();}},bindUI:function(){var A=this;A[c6].delegate("click",cF.bind(A._onClickDaysHeader,A),cm+u);A[bL].delegate("mousedown",cF.bind(A._onMouseDownTableCol,A),cm+c4);A[bL].delegate("mouseenter",cF.bind(A._onMouseEnterEvent,A),cm+aR);A[bL].delegate("mouseleave",cF.bind(A._onMouseLeaveEvent,A),cm+aR);A[bL].delegate("mousemove",cF.bind(A._onMouseMoveTableCol,A),cm+J);A[bL].delegate("mouseup",cF.bind(A._onMouseUpTableCol,A),cm+c4);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:tickAlignY",A._dragTickAlignY);A.on("schedulerChange",A._onSchedulerChange);A.after("drag:align",A._afterDragAlign);},syncUI:function(){var A=this;c5.superclass.syncUI.apply(this,arguments);A[bW].attr(Z,A.get(V));A._setupDragDrop();},syncStdContent:function(){var dd=this;dd.setStdModContent(cA.BODY,dd[bX].getDOM());var A=cF.NodeList.create(dd[c6]);if(dd[bg]){A.push(dd[bg].get(a2));A.push(dd.get(aS));}dd.setStdModContent(cA.HEADER,A);},calculateEventHeight:function(de){var dd=this;var A=dd.get(aJ);return Math.max(de*(A/60),A/2);},calculateTop:function(dd){var A=this;return((dd.getHours()*60)+dd.getMinutes()+(dd.getSeconds()/60))*(A.get(aJ)/60);},getNextDate:function(){var A=this;var dd=A.get(s).get(bx);return av.add(dd,av.DAY,1);},getPrevDate:function(){var A=this;var dd=A.get(s).get(bx);return av.subtract(dd,av.DAY,1);},getColumnByDate:function(dd){var A=this;return A[aC].item(A.getDateDaysOffset(dd));},getColumnShimByDate:function(dd){var A=this;return A[aQ].item(A.getDateDaysOffset(dd));},getDateByColumn:function(de){var A=this;var dd=av.safeClearTime(A.get(s).get(bx));return av.add(dd,av.DAY,de);},getDateDaysOffset:function(de){var A=this;var dd=av.safeClearTime(A.get(s).get(bx));return av.getDayOffset(av.safeClearTime(de),dd);},getYCoordTime:function(dg){var dd=this;var A=dd.get(aJ);var dh=cf((dg/A).toFixed(2));var df=Math.floor((dh*100)%100*0.6);var de=Math.floor(dh);return[de,df,0];},plotEvent:function(de){var A=this;var df=de.get(dc);if(df.size()<2){de.addPaddingNode();}var dh=de.get(dc).item(0);var dd=de.get(dc).item(1);var dg=A.getColumnShimByDate(de.get(aG));var di=A.getColumnShimByDate(de.get(cJ));if(di){di.append(dh);if(de.get(aB)){dh.show();}}else{dh.hide();}if(dg){if(dg.compareTo(di)||de.isDayBoundaryEvent()){dd.hide();}else{dg.append(dd);if(de.get(aB)){dd.show();}}}else{dd.hide();}A.syncEventTopUI(de);A.syncEventHeightUI(de);},plotEvents:function(){var A=this;var dd=A.get(s);var de=A.get(cz);
A[aQ].each(function(di,dh){var df=dd.getEventsByDay(A.getDateByColumn(dh),true);var dg=[];di.empty();cF.Array.each(df,function(dj){if(de.apply(A,[dj])){A.plotEvent(dj);dg.push(dj);}});A.syncEventsIntersectionUI(dg);});if(A.get(bg)){A.syncHeaderViewUI();}},syncColumnsUI:function(){var A=this;A[aC].each(function(df,de){var dd=A.getDateByColumn(de);df.toggleClass(S,av.isToday(dd));});},syncDaysHeaderUI:function(){var de=this;var df=de.get(s).get(bx);var dd=de.get(bv);var A=de.get(aD);de[cI].all(k).each(function(di,dh){var dg=av.add(df,av.DAY,dh);var dj=cF.DataType.Date.format(dg,{format:dd,locale:A});di.toggleClass(at,av.isToday(dg));di.html(dj);});},syncEventsIntersectionUI:function(dd){var A=this;var de=A.get(t);A.get(s).flushEvents();cF.Array.each(dd,function(dg){var di=A.findEventIntersections(dg,dd);var dh=di.length;var df=(de/dh);cF.Array.each(di,function(dk,dl){var dj=dk.get(dc).item(0);var dn=df*dl;var dm=df*1.7;if(dl===(dh-1)){dm=de-dn;}dj.setStyle(b1,dm+b2);dj.setStyle(a3,dn+b2);var dp=dj.get(T);if(dp){dp.insert(dj,dl);}dk._filtered=true;});});},syncEventHeightUI:function(df){var dd=this;var dj=df.get(aG);var A=df.get(cJ);var dg=av.clone(A);dg.setHours(24,0,0);var dh=av.getMinutesOffset(dd.limitDate(dj,dg),A);df.get(dc).item(0).set(cB,dd.calculateEventHeight(dh));var de=df.get(dc).item(1);if(de.inDoc()){var di=av.getMinutesOffset(dj,av.toMidnight(df.getClearEndDate()));de.set(cB,dd.calculateEventHeight(di));}},syncEventTopUI:function(dd){var A=this;dd.get(dc).item(0).setStyle(bQ,A.calculateTop(dd.get(cJ))+am);dd.get(dc).item(1).setStyle(bQ,0);},syncHeaderViewUI:function(){var dd=this;if(dd.get(bg)){var df=dd[bg];df.plotEvents();var dg=df.get(a2);dg.setStyle(m,l());var de=dg.one(cm+bi);var A=Math.max(de.get(cB),40);console.log(A);df.set(cp,A);dd._fillHeight();}},calculateYDelta:function(de,dd){var A=this;return(dd[1]-de[1])/(A.get(aJ)/2)*30;},findEventIntersections:function(dd,de){var A=this;var df=[];cF.Array.each(de,function(dg){if(!dd._filtered&&dd.intersectHours(dg)){df.push(dg);}});return df;},getXYDelta:function(dd){var A=this;var de=dd.currentTarget.getXY(),df=[dd.pageX,dd.pageY];return cF.Array.map(de,function(dh,dg){return(df[dg]-dh);});},getTickY:function(){var A=this;return ci(Math.ceil(A.get(aJ)/2),10);},roundToNearestHour:function(dd,de){var A=this;dd.setHours(de[0],ci(de[1],A.getTickY()),de[2]);},_afterDragAlign:function(de){var dd=this;var A=de.target;if(!dd[Y]){dd[Y]=A.actXY;}A.actXY[0]=null;},_dragTickAlignX:function(de){var dd=this;var dh=dd[H];if(dh&&!dd[ch]){var df=dd[cc];var dg=cf(de.attr(w))-dd.startColNumber;dd.draggingEventStartDate=av.add(dh.get(cJ),av.DAY,dg);var A=av.clone(dd.draggingEventStartDate);av.copyHours(A,df.get(cJ));df.move(A);dd.plotEvent(df);}},_dragTickAlignY:function(A){var dj=this;var de=dj.get(s);var dl=de.get(da);var dg=dj[H];if(dg){var dk=A.target.get(a1);var dh=dj[cc];var di=dj.calculateYDelta(dj[Y],dk.actXY);if(dj[ch]){var df=av.add(dj.draggingEventEndDate,av.MINUTES,di);if(av.getMinutesOffset(df,dj.draggingEventStartDate)<=dl.get(cs)){return;}dh.set(aG,df);}else{dh.move(av.add(dj.draggingEventStartDate,av.MINUTES,di));}dj.plotEvent(dh);}},_setupDragDrop:function(){var dd=this;if(!dd[cc]){var de=dd.get(s);dd[cc]=new (dd.get(c2))({scheduler:de});dd[cc].removeTarget(de);dd[cc].get(dc).addClass(cq).hide();}if(!dd.delegate){dd.delegate=new cF.DD.Delegate(dd.get(D));}var A=dd.delegate.dd;A.unplug(cF.Plugin.DDConstrained);A.unplug(cF.Plugin.DDNodeScroll);var df=dd.bodyNode.get(ai);df.bottom=Infinity;df.top=-Infinity;A.plug(cF.Plugin.DDConstrained,{bubbleTargets:dd,constrain:df,stickY:true,tickY:dd.get(aJ)/2});A.plug(cF.Plugin.DDNodeScroll,{node:dd.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(dd){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(df){var A=this;var de=A.get(s);if(df.target.test(k)){var dg=de.getViewByName(cQ);if(dg){var dd=cf(df.currentTarget.attr(w));de.set(bx,A.getDateByColumn(dd));de.set(ce,dg);}}df.preventDefault();},_onEventDragEnd:function(dd){var A=this;var df=A[H];if(df){var de=A[cc];de.set(aB,false);df.set(aB,true);df.copyDates(de);A.get(s).syncEventsUI();}A[Y]=null;A[H]=null;},_onEventDragStart:function(de){var A=this;var dg=A[H]=A.delegate.dd.get(dc).getData(aI);if(dg){var df=A[cc];df.copyPropagateAttrValues(dg);A.plotEvent(df);dg.set(aB,false);A.draggingEventStartDate=av.clone(dg.get(cJ));A.draggingEventEndDate=av.clone(dg.get(aG));var dd=A.getColumnByDate(dg.get(cJ));A.startColNumber=dd?cf(dd.attr(w)):0;}},_onMouseDownTableCol:function(dd){var di=this;var dh=dd.target;var df=di.get(s);var dj=df.get(da);if(dj&&!df.get(cd)){dj.hideOverlay();if(dh.test(cm+aH)){di[Y]=[dd.pageX,dd.pageY];var dk=cf(dd.currentTarget.attr(w));var de=di.getDateByColumn(dk);var A=di.getXYDelta(dd);di.roundToNearestHour(de,di.getYCoordTime(A[1]));var dg=av.add(de,av.MINUTES,dj.get(cs));dj.move(de);dj.set(P,false);dj.set(aG,dg);di[ac]=de;di[bp]=dg;dd.halt();}else{if(dh.test([cm+co,cm+aT].join(bI))){di[ch]=true;}}}di.get(a2).unselectable();},_onMouseEnterEvent:function(de){var A=this;var df=de.currentTarget;var dd=df.getData(aI);if(dd&&!dd.get(cd)){A[cu].appendTo(df);}},_onMouseLeaveEvent:function(dd){var A=this;if(!A[ch]){A._removeResizer();}},_onMouseMoveTableCol:function(dg){var A=this;var df=dg.currentTarget;var dd=A.get(s).get(da);if(A[bq]!==df){A[bq]=df;A._dragTickAlignX(A[bq]);}var de=A[bp];var dh=A[ac];if(dh){var di=ci(A.calculateYDelta(A[Y],[dg.pageX,dg.pageY]),A.getTickY());if(A._delta!==di){if(di>0){dd.set(aG,av.add(de,av.MINUTES,di));}else{dd.set(cJ,av.add(dh,av.MINUTES,di));}A.plotEvent(dd);A._delta=di;}}},_onMouseUpTableCol:function(df){var A=this;var de=A.get(s);var dd=de.get(da);if(dd&&!de.get(cd)){if(A[ac]){A.plotEvent(dd);dd.showOverlay([df.pageX,df.pageY]);}}A[ac]=null;A[bp]=null;A[ch]=false;A[Y]=null;A._removeResizer();A.get(a2).selectable();},_onSchedulerChange:function(dd){var A=this;if(A[bg]){A[bg].set(s,dd.newVal);}},_removeResizer:function(){var A=this;A[cu].remove();},_valueColDaysNode:function(){var A=this;
var df=A.get(V);var dd=[],de=0;while(df--){dd.push(cF.Lang.sub(bz,{colNumber:de++}));}return cF.NodeList.create(dd.join(cb));},_valueColHeaderDaysNode:function(){var A=this;var df=A.get(V);var dd=[],de=0;dd.push(ay);while(df--){dd.push(cF.Lang.sub(bC,{colNumber:de++}));}dd.push(x);return cF.NodeList.create(dd.join(cb));},_valueMarkercellsNode:function(){var A=this;var dd=[],de;for(de=0;de<=23;de++){dd.push(aj);}return cF.NodeList.create(dd.join(cb));},_valueTimesNode:function(){var A=this;var df=A.get(ap);var de=[],dd;for(dd=0;dd<=23;dd++){de.push(b9(j,{hour:df?av.toIsoTimeString(dd):av.toUsTimeString(dd,false,true)}));}return cF.NodeList.create(de.join(cb));}}});cF.SchedulerDayView=c5;var ar=cF.Component.create({NAME:cK,ATTRS:{bodyContent:{value:cb},days:{value:7},headerViewConfig:{value:{displayDaysInterval:aU}},name:{value:cW}},EXTENDS:cF.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var df=A.get(s);var dd=df.get(bx);var de=df.get(cL);df.set(bx,av.getFirstDayOfWeek(dd,de));},getNextDate:function(){var A=this;var de=A.get(s);var dd=de.get(bx);var df=A._firstDayOfWeek(dd);return av.add(df,av.WEEK,1);},getPrevDate:function(){var A=this;var de=A.get(s);var dd=de.get(bx);var df=A._firstDayOfWeek(dd);return av.subtract(df,av.WEEK,1);},getToday:function(){var A=this;var dd=ar.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(dd);},_firstDayOfWeek:function(de){var A=this;var df=A.get(s);var dd=df.get(cL);return av.getFirstDayOfWeek(de,dd);}}});cF.SchedulerWeekView=ar;var h=F(v),n=F(v,"arrowstop-1-l"),cY=F(v,"arrowstop-1-r"),r=F(ck,a5,a),aX=F(ck,a5,a,aN),ax=F(ck,a5,a,aq),bA=F(ck,a5,aY),au=F(ck,a5,cC,al),cU=F(ck,a5,cC,cQ),c=F(ck,a5,cC,a5),G=F(ck,a5,a8),cE=F(ck,a5,bP),b0=F(ck,a5,bP,aY),bi=F(ck,a5,bZ),cy=F(ck,a5,bZ,al),bT=F(ck,a5,bZ,al,i),cw=F(ck,a5,bZ,al,i,ae),b4=F(ck,a5,bZ,al,i,aN),c1=F(ck,a5,bZ,al,i,aW),bE=F(ck,a5,bZ,al,i,aq),aE=F(ck,a5,bZ,bk),b=F(ck,a5,bZ,bk,a3),cH=F(ck,a5,bZ,bk,cx),ak=F(ck,a5,bZ,bk,bf),ad=F(ck,a5,bZ,aN),aK=F(ck,a5,bt),b6=F(ck,a5,bt,aN),a0='<div class="'+bA+'">'+'<div class="'+b0+'"></div>'+"</div>",cl='<td class="'+r+'">&nbsp;</td>',f='<th class="'+cU+'"><div>&nbsp;</div></th>',W='<table cellspacing="0" cellpadding="0" class="'+c+'">'+"<tbody>"+'<tr class="'+au+'"></tr>'+"</tbody>"+"</table>",bR='<div class="'+G+'"></div>',bw='<div class="'+cE+'" style="top: {top}%; height: {height}%;"></div>',bB='<table cellspacing="0" cellpadding="0" class="'+bi+'">'+"<tbody></tbody>"+"</table>",a9='<table cellspacing="0" cellpadding="0" class="'+aK+'">'+"<tbody>"+"<tr></tr>"+"</tbody>"+"</table>",Q='<span class="'+[h,n].join(X)+'"></span>',bo='<span class="'+[h,cY].join(X)+'"></span>',bu='<td class="'+cy+'"><div></div></td>',cR="<tr></tr>";var bb=cF.Component.create({NAME:ca,ATTRS:{bodyContent:{value:cb},displayDaysInterval:{value:42},displayRows:{value:4},fixedHeight:{value:true},name:{value:a5},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},headerTableNode:{valueFn:function(){return cF.Node.create(W);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},rowsContainerNode:{valueFn:function(){return cF.Node.create(a0);}},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{colHeaderDaysNode:O(cm+cU,7),headerTableNode:cm+c,rowsContainerNode:cm+bA,tableGridNode:O(cm+aK,7)},EXTENDS:cF.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};A[cI]=A.get(cI);A[c6]=A.get(c6);A[bO]=A.get(bO);A[C]=A.get(C);A[ba]=A.headerTableNode.one(cm+au);A[aZ]=cF.NodeList.create();A[b8]=A[bO].one(cm+b0);A[cZ]=cF.NodeList.create();},bindUI:function(){var A=this;var dd=A.get(s).get(da);dd.on({cancel:cF.bind(A.removeLasso,A),save:cF.bind(A.removeLasso,A)});A[bO].on({mousedown:cF.bind(A._onMouseDownGrid,A),mousemove:cF.bind(A._onMouseMoveGrid,A),mouseup:cF.bind(A._onMouseUpGrid,A)});},renderUI:function(){var dd=this;var dg=dd.get(a7);var de=Math.ceil(dg/aU);var di=100/de;for(var df=0;df<de;df++){var A=dd._getTableGridNode(df);var dh=cF.Node.create(cT.sub(bw,{height:di,top:di*df}));dh.append(A.toggleClass(b6,(df===0)));dd[cZ].push(dh);}dd[cI].appendTo(dd[ba]);dd[cZ].appendTo(dd[b8]);},buildEventsTable:function(dd,dh){var dq=this;var di=dq.get(a7);var dm=dq.get("displayRows");var dr=dq.get(cz);var dp=av.clearTime(dq._findCurrentIntervalEnd());var dl=av.clearTime(dq._findCurrentIntervalStart());var dk=String(dl.getTime()).concat(dd.getTime()).concat(dh.getTime());var dj=dq.evtDataTableStack[dk];if(!dj){dj=cF.Node.create(bB);var dn=dj.one(bU);var df=cF.Node.create(cR);dq.loopDates(dd,dh,function(dt,ds){var du=cF.Node.create(bu);du.addClass(bT).toggleClass(b4,(ds===0)).toggleClass(bE,av.isToday(dt)).toggleClass(c1,av.isToday(av.subtract(dt,av.DAY,1))).toggleClass(cw,av.isToday(av.subtract(dt,av.WEEK,1)));df.append(du.setContent(dt.getDate()));});dn.append(df);var A;for(A=0;A<dm;A++){var dg=0;var de=cF.Node.create(cR);dq.loopDates(dd,dh,function(dD,dy){if(dg<=dy){var dE=dq.getIntersectEvents(dD),dB=dE[A];var dv=cF.Node.create(bu);if(dB&&dr.apply(dq,[dB])){var dt=dB.get(cJ);var dz=!av.isDayOverlap(dt,dD);var dA=av.after(dD,dt)&&!av.isDayOverlap(dD,dd);if(dz||dA){var du=dB.get(dc);var dw=av.getFirstDayOfWeek(new Date(Math.max(dt,dl)));var dC=Math.floor(av.getDayOffset(dD,dw)/aU);if(du.size()<=dC){dB.addPaddingNode();}var dx=du.item(dC);dx.setStyles({height:"auto",left:0,top:0,width:"auto"});dB.syncNodeUI();var ds=dv.one(aa);dx.appendTo(ds);var dF=dq._getEvtSplitInfo(dB,dD,dd,dh);dv.attr(Z,dF.colspan);ds.addClass(aE);if(dF.left){ds.addClass(b).prepend(Q);}if(dF.right){ds.addClass(ak).append(bo);}if(dB.get(cV)){ds.addClass(cH);}dg+=dF.colspan;}else{dg++;}}else{dg++;}de.append(dv);}});dn.append(de);}dq.evtDataTableStack[dk]=dj;}return dj;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(dd){var A=this;var dg=A.get(s);var df=String(dd.getTime());if(!A.evtDateStack[df]){var de=dg.getIntersectEvents(dd);
A.evtDateStack[df]=de.filter(A.get(cz));}return A.evtDateStack[df];},getNextDate:function(){var A=this;var df=A.get(s);var dd=df.get(bx);var de=A.get(a7);return av.add(dd,av.DAY,de);},getPrevDate:function(){var A=this;var df=A.get(s);var dd=df.get(bx);var de=A.get(a7);return av.subtract(dd,av.DAY,de);},loopDates:function(A,df,di,dj,dh){var dk=this;var dd=av.clone(A);var de=df.getTime(),dg;for(dg=0;dd.getTime()<=de;dg++){di.apply(dk,[dd,dg]);dd=av.add(dd,(dj||av.DAY),(dh||1));}},plotEvents:function(){var dd=this;var dg=dd._findCurrentIntervalStart();var A=av.safeClearTime(dg);dd.flushViewCache();dd.bodyNode.all(cm+bi).remove();var de=dd.get(a7);var df=Math.min(de,aU);dd[cZ].each(function(dk,di){var dh=av.add(A,av.DAY,df*di);var dl=av.add(dh,av.DAY,df-1);var dj=dd.buildEventsTable(dh,dl);if(di===0){dj.addClass(ad);}dk.append(dj);});},removeLasso:function(){var A=this;if(A.lasso){A.lasso.remove();}},renderLasso:function(dj,dd){var dq=this;var dg=dj;var di=dd;if(dj[1]>dd[1]){dg=dd;di=dj;}var dr=dg[0],dl=dg[1],de=di[0],A=di[1];dq.removeLasso();dq.lasso=cF.NodeList.create();for(var df=dl;df<=A;df++){var dh=dq.gridCellHeight,dp=dq.gridCellWidth,dm=0,dk=(dh*df);if(df===dl){if(dl===A){dm+=Math.min(dr,de)*dp;dp*=Math.abs(de-dr)+1;}else{dm+=dr*dp;dp*=aU-dr;}}else{if(df===A){dp*=de+1;}else{dp*=aU;}}var dn=cF.Node.create(bR);dq.lasso.push(dn);dq[bO].append(dn);dn.sizeTo(dp,dh);dn.setXY(dq._offsetXY([dm,dk],1));}},syncDaysHeaderUI:function(){var de=this;var dh=de.get(s);var df=dh.get(bx);var dd=de.get(bv);var A=de.get(aD);var dg=de._findFirstDayOfWeek(df);de.colHeaderDaysNode.all(aa).each(function(dk,dj){var di=av.add(dg,av.DAY,dj);var dl=cF.DataType.Date.format(di,{format:dd,locale:A});dk.html(dl);});},syncGridUI:function(){var dm=this;var dg=dm.getToday();var dd=dm.get(s);dm[aZ].removeClass(ax);var df=dm._findCurrentIntervalStart();var di=dm._findCurrentIntervalEnd();if(av.between(dg,df,di)){var A=dd.get(cL);var dk=dm._findFirstDayOfWeek(dg);var dh=av.getWeekNumber(dg,A)-av.getWeekNumber(df,A);var dl=(dg.getDate()-dk.getDate());var de=dm._getCellIndex([dl,dh]);var dj=dm[aZ].item(de);if(dj){dj.addClass(ax);}}},syncStdContent:function(){var A=this;A.setStdModContent(cA.BODY,A[bO].getDOM());A.setStdModContent(cA.HEADER,A[c6].getDOM());},_findCurrentIntervalEnd:function(){var A=this;var df=A.get(s);var dd=df.get(bx);var de=A.get(a7);return av.add(dd,av.DAY,de);},_findCurrentIntervalStart:function(){var A=this;var dd=A.get(s);return dd.get(bx);},_findFirstDayOfWeek:function(de){var A=this;var df=A.get(s);var dd=df.get(cL);return av.getFirstDayOfWeek(de,dd);},_getCellIndex:function(dd){var A=this;return dd[1]*aU+dd[0];},_getEvtLabel:function(de){var dd=this;var df=de.get(aG);var A=de.get(cJ);return[A.getHours(),cg,df.getHours(),X,de.get(aV)].join(cb);},_getEvtSplitInfo:function(dh,dk,A,df){var di=this;var dd=dh.getClearStartDate();var dg=dh.getClearEndDate();var dj=av.getDayOffset(df,dk);var de={colspan:Math.min(av.getDayOffset(dg,dk),dj)+1,left:av.before(dd,A),right:av.after(dg,df)};return de;},_getPositionDate:function(de){var dd=this;var df=dd._findCurrentIntervalStart();var A=av.safeClearTime(dd._findFirstDayOfWeek(df));return av.add(A,av.DAY,dd._getCellIndex(de));},_getTableGridNode:function(di){var dd=this;var df=dd.get(a7);var A=dd[C].item(di);var dh=A.one(c7);for(var de=0;de<Math.min(df,aU);de++){var dg=cF.Node.create(cl);dh.append(dg);dd[aZ].push(dg);}return A;},_offsetXY:function(df,de){var A=this;var dd=A[bO].getXY();return[df[0]+dd[0]*de,df[1]+dd[1]*de];},_onMouseDownGrid:function(dh){var A=this;var di=dh.target;if(di.test([cm+r,cm+cy].join(bI))){A._recording=true;var df=A.get(a7);var dd=Math.ceil(df/aU);var dg=Math.min(df,aU);A.gridCellHeight=A[bO].get(cB)/dd;A.gridCellWidth=A[bO].get(cD)/dg;var de=A._offsetXY([dh.pageX,dh.pageY],-1);A.lassoStartPosition=A.lassoLastPosition=A._findPosition(de);A.renderLasso(A.lassoStartPosition,A.lassoLastPosition);A[bO].unselectable();}},_onMouseMoveGrid:function(dg){var dd=this;var dh=dg.currentTarget;var de=dd._offsetXY([dg.pageX,dg.pageY],-1);var df=dd.lassoLastPosition||dd.lassoStartPosition;var A=dd._findPosition(de);var di=df&&((A[0]!==df[0])||(A[1]!==df[1]));if(di&&dd._recording){dd.lassoLastPosition=A;dd.renderLasso(dd.lassoStartPosition,A);}},_onMouseUpGrid:function(di){var dd=this;var dh=dd.get(s);var df=dh.get(da);if(df&&dd._recording&&!dh.get(cd)){var dg=dd._getPositionDate(dd.lassoStartPosition);var de=dd._getPositionDate(dd.lassoLastPosition);var A=new Date(Math.min(dg,de));A.setHours(0,0,0);var dj=new Date(Math.max(dg,de));dj.setHours(23,59,59);df.set(P,true);df.set(aG,dj);df.set(cJ,A);df.showOverlay([di.pageX,di.pageY]);dd._recording=false;}},_findPosition:function(df){var A=this;var de=Math.floor(df[0]/A.gridCellWidth);var dd=Math.floor(df[1]/A.gridCellHeight);return[de,dd];},_uiSetCurrentDate:function(dd){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;var dd=A.get(a7);var de=Math.min(dd,aU);return A._valueNodeList(de,f);},_valueTableGridNode:function(){var A=this;var dd=A.get(a7);var de=Math.min(dd,aU);return A._valueNodeList(de,a9);},_valueNodeList:function(df,de){var A=this;var dd=[];while(df--){dd.push(de);}return cF.NodeList.create(dd.join(cb));}}});cF.SchedulerTableView=bb;var bh=F(c0,a5,bZ,al,ao);var aF=cF.Component.create({NAME:c0,ATTRS:{displayDaysInterval:{readOnly:true,value:42},name:{value:b7}},EXTENDS:cF.SchedulerTableView,prototype:{getNextDate:function(){var A=this;var de=A.get(s);var dd=de.get(bx);return av.add(dd,av.MONTH,1);},getPrevDate:function(){var A=this;var de=A.get(s);var dd=de.get(bx);return av.subtract(dd,av.MONTH,1);},plotEvents:function(){var A=this;cF.SchedulerMonthView.superclass.plotEvents.apply(A,arguments);var de=A.get(s);var dd=de.get(bx);var dh=av.findMonthEnd(dd);var dg=av.findMonthStart(dd);var df=A._findCurrentIntervalStart();var di=A[b8].all(cm+bT);di.each(function(dl,dj){var dk=av.add(df,av.DAY,dj);if(av.before(dk,dg)||av.after(dk,dh)){dl.addClass(bh);}});
},_findCurrentIntervalStart:function(){var A=this;var df=A.get(s);var dd=df.get(bx);var de=av.findMonthStart(dd);return A._findFirstDayOfWeek(de);},_findFirstDayOfWeek:function(de){var A=this;var df=A.get(s);var dd=df.get(cL);return av.getFirstDayOfWeek(de,dd);}}});cF.SchedulerMonthView=aF;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-event",function(aJ){var am=aJ.Lang,bi=am.isString,f=am.isDate,a8=am.isFunction,G=am.isObject,bb=am.isBoolean,ac=am.isNumber,aX=aJ.ColorUtil,j=aJ.DataType.DateMath,a4=aJ.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),bd="-",t="&ndash;",ax=".",p="",q=" ",l="_",aL="_propagateSet",Q="activeView",T="borderColor",aN="borderColorRGB",aH="borderStyle",bp="borderWidth",I="Change",a2="color",aV="colorBrightnessFactor",bc="colorSaturationFactor",aF="content",w="disabled",aZ="duration",aO="endDate",aR="eventClass",ap="eventStack",bj="events",at="hidden",H="hsbColor",ar="icon",aa="icons",a0="id",aW="isoTime",bo="locale",aY="never",n="node",h="overlay",aK="parentEvent",bu="recorder",aM="repeat",bh="repeated",P="repeatedEvents",ba="repeater",af="scheduler",au="scheduler-event",aw="scheduler-event-recorder",bl="startDate",a6="template",aU="title",e="titleDateFormat",an="visible",d="%H:%M",a5="%I:%M",E=aJ.getClassName,k=E(ar),s=E(au),aP=E(au,aF),C=E(au,at),bf=E(au,w),ao=E(au,bu),aA=E(au,bh),al=E(au,ba),D=E(au,aU),bn=E(au,aa),v=E(au,ar,w),b=E(au,ar,bh),br=E(au,ar,ba);var V=aJ.Component.create({NAME:au,ATTRS:{allDay:{value:false,validator:bb},borderStyle:{value:"solid",validator:bi},borderWidth:{value:"1px",validator:bi},colorBrightnessFactor:{value:0.75,validator:ac},colorSaturationFactor:{value:1.5,validator:ac},content:{value:"(no title)",validator:bi},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bi},titleDateFormat:{getter:"_getTitleDateFormat",validator:bi},endDate:{setter:"_setDate",valueFn:function(){var A=j.clone(this.get(bl));A.setHours(A.getHours()+1);return A;}},eventClass:{valueFn:function(){return aJ.SchedulerEvent;}},disabled:{value:false,validator:bb},node:{valueFn:function(){return aJ.NodeList.create(aJ.Node.create(this.EVENT_NODE_TEMPLATE).setData(au,this));}},parentEvent:{},repeat:{value:p,setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{setter:"_setDate",valueFn:function(){return new Date();}},visible:{value:true,validator:bb}},EXTENDS:aJ.Base,PROPAGATE_ATTRS:[bl,aO,aF,a2,aV,bc,aH,bp,e,an,w],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+s+'">'+'<div class="'+D+'"></div>'+'<div class="'+aP+'"></div>'+'<div class="'+bn+'">'+'<span class="'+[k,b].join(q)+'"></span>'+'<span class="'+[k,br].join(q)+'"></span>'+'<span class="'+[k,v].join(q)+'"></span>'+"</div>"+"</div>",eventStack:null,initializer:function(){var A=this;var L=A.get(n);A[ap]={};aJ.Array.each(A.get(aR).PROPAGATE_ATTRS,function(X){A.after(X+I,A._propagateAttrChange);});A._bindUIAttrs();A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(L,X){L.destroy();});A[ap]={};A.get(n).remove(true);},addPaddingNode:function(){var A=this;A.get(n).push(aJ.Node.create(A.EVENT_NODE_TEMPLATE).setData(au,A));A.syncNodeUI();},copyDates:function(L){var A=this;A.set(aO,j.clone(L.get(aO)));A.set(bl,j.clone(L.get(bl)));},copyPropagateAttrValues:function(L,X){var A=this;A.copyDates(L);aJ.Array.each(A.get(aR).PROPAGATE_ATTRS,function(Y){if(!((X||{}).hasOwnProperty(Y))){var bz=L.get(Y);if(!G(bz)){A.set(Y,bz);}}});},getBorderColor:function(){var A=this;return A[aN].hex;},getDaysDuration:function(){var A=this;return j.getDayOffset(A.get(aO),A.get(bl));},getHoursDuration:function(){var A=this;return j.getHoursOffset(A.get(aO),A.get(bl));},getMinutesDuration:function(){var A=this;return j.getMinutesOffset(A.get(aO),A.get(bl));},getSecondsDuration:function(){var A=this;return j.getSecondsOffset(A.get(aO),A.get(bl));},sameEndDate:function(L){var A=this;return j.compare(A.get(aO),L.get(aO));},sameStartDate:function(L){var A=this;return j.compare(A.get(bl),L.get(bl));},isAfter:function(Y){var X=this;var L=X.get(bl);var A=Y.get(bl);return j.after(L,A);},isBefore:function(Y){var X=this;var L=X.get(bl);var A=Y.get(bl);return j.before(L,A);},repeatByDate:function(X){var L=this;var Y=L.uidByDate(X);if(!L[ap][Y]){var A=j.clone(X);var bA=j.clone(X);j.copyHours(A,L.get(bl));j.copyHours(bA,L.get(aO));var bz=new L.get(aR)({endDate:bA,parentEvent:L,scheduler:L.get(af),startDate:A});bz.copyPropagateAttrValues(L);L[ap][Y]=bz;}return L[ap][Y];},intersects:function(Y){var X=this;var bz=X.get(aO);var L=X.get(bl);var A=Y.get(bl);return(X.sameStartDate(Y)||j.between(A,L,bz));},intersectHours:function(X){var L=this;var bz=L.get(aO);var A=L.get(bl);var Y=j.clone(A);j.copyHours(Y,X.get(bl));return(j.compare(A,Y)||j.between(Y,A,bz));},isDayBoundaryEvent:function(){var A=this;return j.isDayBoundary(A.get(bl),A.get(aO));},isDayOverlapEvent:function(){var A=this;return j.isDayOverlap(A.get(bl),A.get(aO));},isRepeatableDate:function(L){var A=this;var X=A.get(aM);return(X&&X.validate(A,L));},getClearEndDate:function(){var A=this;return j.safeClearTime(A.get(aO));},getClearStartDate:function(){var A=this;return j.safeClearTime(A.get(bl));},move:function(L){var A=this;var X=A.getMinutesDuration();A.set(bl,L);A.set(aO,j.add(j.clone(L),j.MINUTES,X));},uidByDate:function(L){var A=this;L=f(L)?j.safeClearTime(L):A.getClearStartDate();return[au,L.getTime()].join(l);},setContent:function(X,L){var A=this;A.get(n).each(function(bz){var Y=bz.one(g+aP);Y.setContent(X);});if(L){A.eachRepeatedEvent(function(Y,bz){Y.setContent(X);});}},setTitle:function(X,L){var A=this;A.get(n).each(function(Y){var bz=Y.one(g+D);bz.setContent(X);});if(L){A.eachRepeatedEvent(function(Y,bz){Y.setTitle(X);});}},syncNodeUI:function(L){var A=this;A._syncUIAttrs();A.syncNodeColorUI(L);A.syncNodeTitleUI(L);A.syncNodeContentUI(L);},syncNodeColorUI:function(L){var A=this;var Y=A.get(n);
var bz=A.getBorderColor();if(Y){var X={borderWidth:A.get(bp),borderColor:bz,backgroundColor:A.get(a2),borderStyle:A.get(aH)};Y.setStyles(X);}if(L){A.eachRepeatedEvent(function(bA,bB){bA.syncNodeColorUI();});}},syncNodeContentUI:function(L){var A=this;A.setContent(A.get(aF),L);},syncNodeTitleUI:function(L){var A=this;var Y=A._formatDate(A.get(bl));var X=A._formatDate(A.get(aO));A.setTitle([Y,X].join(q+t+q),L);},split:function(){var A=this,X=j.clone(A.get(bl)),Y=j.clone(A.get(aO));if(A.isDayOverlapEvent()&&!A.isDayBoundaryEvent()){var L=j.clone(X);L.setHours(24,0,0,0);return[[X,j.toMidnight(j.clone(X))],[L,j.clone(Y)]];}return[[X,Y]];},eachRepeatedEvent:function(L){var A=this;aJ.each(A[ap],L,A);},unlink:function(){var A=this;if(A.get(aK)){A.set(aK,null);}else{A.eachRepeatedEvent(function(L,X){L.unlink();});}A[ap]={};A.syncNodeUI();},_afterDisabledChange:function(L){var A=this;A._uiSetDisabled(L.newVal);},_afterVisibleChange:function(L){var A=this;A._uiSetVisible(L.newVal);},_afterRepeatChange:function(L){var A=this;A._uiSetRepeat(L.newVal);},_afterParentEventChange:function(L){var A=this;A._uiSetParentEvent(L.newVal);},_bindUIAttrs:function(){var A=this;A.after({disabledChange:A._afterDisabledChange,visibleChange:A._afterVisibleChange,parentEventChange:A._afterParentEventChange,repeatChange:A._afterRepeatChange});A._syncUIAttrs();},_propagateAttrChange:function(Y){var A=this;var X=Y.attrName;var L=Y.newVal;A.eachRepeatedEvent(function(bz,bA){var bB=bz[aL+a4(X)];if(bB){bB.apply(A,[bz,X,L]);}else{bz.set(X,Y.newVal);}bz.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,L,Y){var X=j.clone(A.get(aO));j.copyHours(X,Y);A.set(aO,X);},_propagateSetStartDate:function(L,X,Y){var A=j.clone(L.get(bl));j.copyHours(A,Y);L.set(bl,A);},_setColor:function(L){var A=this;A[H]=aX.rgb2hsb(aX.getRGB(L));A[T]=aJ.clone(A[H]);A[T].b*=A.get(aV);A[T].s*=A.get(bc);A[aN]=aX.hsb2rgb(A[T]);return L;},_setDate:function(L){var A=this;if(ac(L)){L=new Date(L);}return L;},_setRepeat:function(L){var A=this;if(bi(L)){L=aJ.SchedulerEventRepeat[L];}return G(L)?L:null;},_setScheduler:function(X){var A=this;var L=A.get(af);if(L){A.removeTarget(L);}A.addTarget(X);return X;},_syncUIAttrs:function(){var A=this;A._uiSetDisabled(A.get(w));A._uiSetVisible(A.get(an));A._uiSetParentEvent(A.get(aK));A._uiSetRepeat(A.get(aM));},_formatDate:function(X,Y){var L=this;var A=L.get(bo);Y=Y||L.get(e);return aJ.DataType.Date.format(X,{format:Y,locale:A});},_getTitleDateFormat:function(X){var A=this;if(!bi(X)){var L=A.get(af);X=(L&&L.get(Q).get(aW))?d:a5;}return X;},_uiSetDisabled:function(L){var A=this;A.get(n).toggleClass(bf,!!L);},_uiSetParentEvent:function(L){var A=this;A.get(n).toggleClass(aA,!!L);},_uiSetRepeat:function(X){var A=this;var L=!!X&&X!==aJ.SchedulerEventRepeat[aY];A.get(n).toggleClass(al,L);},_uiSetVisible:function(L){var A=this;A.get(n).toggleClass(C,!L);}}});aJ.SchedulerEvent=V;aJ.SchedulerEventRepeat={never:{description:"Never repeat",validate:function(A,L){return false;},value:"never"},daily:{description:"Every day",validate:function(A,L){return true;},value:"daily"},monthly:{description:"Every month",validate:function(L,X){var Y=L.get(aO);var A=L.get(bl);return(A.getDate()===X.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,L){return j.isMonWedOrFri(L);},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,L){return j.isTueOrThu(L);},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,L){return j.isWeekDay(L);},value:"weekDays"},weekly:{description:"Every week",validate:function(L,X){var Y=L.get(aO);var A=L.get(bl);return(A.getDay()===X.getDay());},value:"weekly"},yearly:{description:"Every year",validate:function(L,X){var Y=L.get(aO);var A=L.get(bl);return((A.getMonth()===X.getMonth())&&(A.getDay()===X.getDay()));},value:"yearly"}};var av=aJ.Lang,a=av.isArray,G=av.isObject,Q="activeView",J="allDay",c="arrow",aT="body",az="bodyContent",o="boundingBox",ay="cancel",a1="click",aF="content",aS="date",aG="dateFormat",ai="delete",a9="description",R="edit",bt="event",aR="eventClass",B="footerContent",aD="form",z="header",u="hide",aW="isoTime",aE="link",n="node",O="offsetHeight",bg="offsetWidth",h="overlay",S="overlayOffset",bu="recorder",bq="rendered",aM="repeat",a3="save",af="scheduler",m="schedulerChange",au="scheduler-event",aw="scheduler-event-recorder",aC="shadow",aB="show",F="startDateChange",N="strings",a6="template",aU="title",bs="tl",ab="toolbar",bk="submit",bm="value",aQ="visibleChange",Z="when",ak="x",aj="y",ae="cancel",M="delete",y="edit",aI="save",bv="-",g=".",ad="",i="#",r=aJ.IO.prototype._serialize,E=aJ.getClassName,s=E(af,bt),ao=E(af,bt,bu),bw=E(af,bt,bu,h),x=E(af,bt,bu,h,c),be=E(af,bt,bu,h,c,aC),ah=E(af,bt,bu,h,aT),a7=E(af,bt,bu,h,aF),ag=E(af,bt,bu,h,aS),U=E(af,bt,bu,h,aD),by=E(af,bt,bu,h,z),aq=E(af,bt,bu,h,aM),D=E(af,bt,aU),K=new aJ.Template('<div class="',be," ",x,'"></div>','<div class="',x,'"></div>','<input type="hidden" name="startDate" value="{startDate}" />','<input type="hidden" name="endDate" value="{endDate}" />','<div class="',by,'">','<input class="',a7,'" name="content" value="{content}" />',"</div>",'<div class="',ah,'">','<label class="',ag,'">{date}</label>','<select class="',aq,'" name="repeat">','<tpl for="eventRepeat">','<option {[ (parent.repeat && parent.repeat.value) == parent.eventRepeat[$i].value ? \'selected="selected"\' : "" ]} value="{value}">{description}</option>',"</tpl>","</select>","</div>"),bx='<form class="'+U+'" id="schedulerEventRecorderForm"></form>';var W=aJ.Component.create({NAME:aw,ATTRS:{allDay:{value:false},content:{value:ad},duration:{value:60},dateFormat:{validator:bi,value:"%a, %B %d,"},event:{},eventClass:{valueFn:function(){return aJ.SchedulerEvent;}},strings:{value:{},setter:function(A){return aJ.merge({"delete":"Delete","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",save:"Save",when:"When"},A||{});
},validator:G},overlay:{validator:G,value:{align:{points:[bs,bs]},visible:false,width:300,zIndex:500}},overlayOffset:{value:[15,-38],validator:a},template:{value:K},toolbar:{setter:function(X){var L=this;var A=L.get(N);return aJ.merge({children:[{handler:aJ.bind(L._handleSaveEvent,L),label:A[a3]},{handler:aJ.bind(L._handleCancelEvent,L),label:A[ay]},{handler:aJ.bind(L._handleDeleteEvent,L),label:A[ai]}]},X||{});},validator:G,value:{}}},EXTENDS:aJ.SchedulerEvent,prototype:{initializer:function(){var A=this;A.get(n).addClass(ao);A.publish(ae,{defaultFn:A._defCancelEventFn});A.publish(M,{defaultFn:A._defDeleteEventFn});A.publish(y,{defaultFn:A._defEditEventFn});A.publish(aI,{defaultFn:A._defSaveEventFn});A.after(m,A._afterSchedulerChange);A[h]=new aJ.Overlay(A.get(h));A[ab]=new aJ.Toolbar(A.get(ab));},_afterSchedulerChange:function(Y){var A=this;var X=Y.newVal;var L=X.get(o);L.delegate(a1,aJ.bind(A._onClickSchedulerEvent,A),g+s);},_defCancelEventFn:function(L){var A=this;A.get(n).remove();A.hideOverlay();},_defDeleteEventFn:function(X){var A=this;var L=A.get(af);L.removeEvent(A.get(bt));A.hideOverlay();L.syncEventsUI();},_defEditEventFn:function(X){var A=this;var L=A.get(af);A.hideOverlay();L.syncEventsUI();},_defSaveEventFn:function(X){var A=this;var L=A.get(af);L.addEvent(X.newSchedulerEvent);A.hideOverlay();L.syncEventsUI();},_handleCancelEvent:function(L){var A=this;A.fire(ae);L.preventDefault();},_handleDeleteEvent:function(L){var A=this;A.fire(M,{schedulerEvent:A.get(bt)});L.preventDefault();},_handleSaveEvent:function(L){var A=this;A.fire(A.get(bt)?y:aI,{newSchedulerEvent:A.getEventCopy()});L.preventDefault();},_onClickSchedulerEvent:function(X){var A=this;var L=X.currentTarget.getData(au);if(L){A.set(bt,L);A.showOverlay([X.pageX,X.pageY]);A.get(n).remove();}},_onOverlayVisibleChange:function(Y){var L=this;if(Y.newVal){L.populateForm();if(!L.get(bt)){var X=L[h].get(o);var A=X.one(g+a7);setTimeout(function(){A.selectText();},0);}}else{L.set(bt,null);L.get(n).remove();}},_onSubmitForm:function(L){var A=this;A._handleSaveEvent(L);},_renderOverlay:function(){var L=this;var A=L.get(N);L[h].render();L[ab].render();var X=L[h].get(o);X.addClass(bw);L[h].set(B,L[ab].get(o));L[h].on(aQ,aJ.bind(L._onOverlayVisibleChange,L));L.formNode=aJ.Node.create(bx);L[h].set(az,L.formNode);L.formNode.on(bk,aJ.bind(L._onSubmitForm,L));},getEventCopy:function(){var A=this;var X=A.get(bt);if(!X){X=new (A.get(aR))({allDay:A.get(J),endDate:A.get(aO),scheduler:A.get(af),startDate:A.get(bl)});X.copyPropagateAttrValues(A,{content:true});}var L=A.serializeForm();X.set(aF,L[aF]);X.set(aM,L[aM]);return X;},getFormattedDate:function(){var X=this;var L=X.get(aG);var bz=(X.get(bt)||X);var bB=bz.get(aO);var bA=bz.get(af);var A=bz.get(bl);var Y=(bA.get(Q).get(aW)?j.toIsoTimeString:j.toUsTimeString);return[bz._formatDate(A,L),Y(A),bd,Y(bB)].join(q);},getTemplateData:function(){var L=this;var A=L.get(N);var X=(L.get(bt)||L);return{content:X.get(aF)||A["description-hint"],date:L.getFormattedDate(),endDate:X.get(aO).getTime(),eventRepeat:L.eventRepeatArray,repeat:X.get(aM),startDate:X.get(bl).getTime()};},hideOverlay:function(){var A=this;A[h].hide();},populateForm:function(){var A=this;if(!A.eventRepeatArray){A.eventRepeatArray=[];aJ.each(aJ.SchedulerEventRepeat,function(L){A.eventRepeatArray.push({description:L[a9],value:L[bm]});});}A.formNode.setContent(A.get(a6).parse(A.getTemplateData()));},serializeForm:function(){var A=this;return aJ.QueryString.parse(r(A.formNode.getDOM()));},showOverlay:function(Y,bA){var A=this;var X=A.get(S);if(!A[h].get(bq)){A._renderOverlay();}A[h].show();if(!Y){var L=(A.get(bt)||A).get(n);var bz=L.one(g+D);bA=[X[0]+bz.get(bg),X[1]+bz.get(O)/2];Y=bz.getXY();}bA=bA||X;Y[0]+=bA[0];Y[1]+=bA[1];A[h].set("xy",Y);}}});aJ.SchedulerEventRecorder=W;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-template","aui-toolbar","io-form","querystring","overlay"]});AUI.add("aui-scheduler-calendar",function(d){var i=d.Lang,j=i.isArray,c=i.isBoolean,b=i.isString,g=function(o){return(o instanceof d.SchedulerEvent);},a="color",k="disabled",m="events",h="pallete",n="scheduler",e="scheduler-calendar",l="visible";var f=d.Component.create({NAME:e,ATTRS:{color:{valueFn:function(){var p=this;var q=p.get(h);var o=Math.ceil(Math.random()*q.length)-1;return q[o];},validator:b},disabled:{value:false,validator:c},name:{value:"(no name)",validator:b},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:j},scheduler:{lazyAdd:false,setter:"_setScheduler"},visible:{value:true,validator:c}},EXTENDS:d.Base,AUGMENTS:d.SchedulerEventSupport,prototype:{initializer:function(){var o=this;o.after("colorChange",o._afterColorChange);o.after("disabledChange",o._afterDisabledChange);o.after("eventsChange",o._afterEventsChange);o.after("visibleChange",o._afterVisibleChange);o._uiSetColor(o.get(a));o._uiSetDisabled(o.get(k));o._uiSetEvents(o.get(m));o._uiSetVisible(o.get(l));},_afterColorChange:function(p){var o=this;o._uiSetColor(p.newVal);},_afterDisabledChange:function(p){var o=this;o._uiSetDisabled(p.newVal);},_afterEventsChange:function(p){var o=this;o._uiSetEvents(p.newVal);},_afterVisibleChange:function(p){var o=this;o._uiSetVisible(p.newVal);},_propagateAttr:function(p,q){var o=this;o.eachEvent(function(r){r.set(p,q);});},_setScheduler:function(q){var o=this;var p=o.get(n);if(p){o.removeTarget(p);}o.addTarget(q);return q;},_uiSetColor:function(p){var o=this;o._propagateAttr(a,o.get(a));},_uiSetDisabled:function(p){var o=this;o._propagateAttr(k,p);},_uiSetEvents:function(q){var o=this;var p=o.get(n);o._propagateAttr(a,o.get(a));
o._propagateAttr(k,o.get(k));o._propagateAttr(l,o.get(l));if(p){p.removeEvents(o);p.addEvents(q);p.syncEventsUI();}},_uiSetVisible:function(p){var o=this;o._propagateAttr(l,p);}}});d.SchedulerCalendar=f;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:false});AUI.add("aui-scheduler",function(a){},"@VERSION@",{skinnable:true,use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event","aui-scheduler-calendar"]});