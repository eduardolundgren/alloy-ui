AUI.add("aui-scheduler-view",function(cT){var c7=cT.Lang,bi=c7.isBoolean,B=c7.isFunction,aQ=c7.isNumber,dn=c7.isObject,cF=c7.isString,cr=function(A){return parseFloat(A)||0;},cu=function(dt,A){return Math.round(dt/A)*A;},az=cT.DataType.DateMath,cO=cT.WidgetStdMod,aY=az.WEEK_LENGTH,cw="scheduler-view",aP="scheduler-view-day",df="scheduler-view-month",cm="scheduler-view-table",cY="scheduler-view-week",bx="activeColumn",cq="activeView",S="allDay",ay="body",a6="boundingBox",dr="cancel",a8="close",ao="col",aG="colDaysNode",cW="colHeaderDaysNode",M="colblank",z="coldata",aS="colday",b="colgrid",ac="colspan",p="coltime",bT="columnData",bf="columnDayHeader",aU="columnShims",a3="columnTableGrid",bG="columnTime",a2="container",aZ="content",bw="creationEndDate",af="creationStartDate",bF="currentDate",b9="data",c4="day",Y="days",F="delegateConfig",cp="disabled",bc="displayDaysInterval",cJ="displayRows",ad="div",bR="division",di="dotted",ah="down",J="draggingEvent",cE="duration",aK="endDate",bq="event",dh="eventClass",co="eventPlaceholder",dq="eventRecorder",u="eventWidth",cK="events",bg="eventsContainer",cN="filterFn",aR="first",cZ="firstDayOfWeek",cd="fixedHeight",bB="grid",b5="gridContainer",br="grip",dp="hd",cQ="header",bD="headerDateFormat",dl="headerTableNode",bm="headerView",bP="headerViewConfig",aW="headerViewLabelNode",cB="height",bt="horizontal",a5="host",aN="hourHeight",w="icon",w="icon",at="isoTime",ai="label",bd="lasso",a7="left",aH="locale",n="marginRight",ak="marker",bs="markercell",bk="markercellsNode",N="markers",cf="markersNode",cj="month",bz="monthContainerNode",c0="monthRowContainer",f="monthRows",b1="more",G="mousedown",Q="mousemove",bb="mouseup",a0="next",ds="node",ar="nomonth",aA="noscroll",cP="offsetHeight",cR="offsetWidth",by="overlay",cU="pad",aT="paddingNode",db="parentEvent",W="parentNode",b0="proxy",ap="px",al="region",a9="rendered",cL="repeated",cz="resizer",cG="resizerNode",ct="resizing",bl="right",bY="row",bX="rowsContainerNode",cv="save",t="scheduler",aM="scheduler-event",ae="scrollable",X="shim",O="showMore",cX="startDate",ab="startXY",cH="strings",ba="table",E="tableGridNode",b6="tableNode",ck="tableRowContainer",de="tableRows",b4="tbody",h="td",a="tl",bU="time",aq="timesNode",j="title",au="today",bW="top",dm="tr",b3="view",aF="visible",da="week",cb="width",x="data-colnumber",l="a",bQ=",",cs="-",cy=".",cn="",cc="%",aa=" ",H=cT.getClassName,bS=H(cw,aA),aj=H(cw,ae);var bj=cT.Component.create({NAME:cw,AUGMENTS:[cT.WidgetStdMod],ATTRS:{bodyContent:{value:cn},eventClass:{valueFn:function(){return cT.SchedulerEvent;}},filterFn:{validator:B,value:function(A){return true;}},height:{value:600},isoTime:{value:false,validator:bi},name:{value:cn,validator:cF},navigationDateFormat:{value:"%A - %d %B, %Y",validator:cF},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:bi},triggerNode:{setter:cT.one},visible:{value:false}},BIND_UI_ATTRS:[ae],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var du=A.get(t);var dt=du.get(bF);du.set(bF,dt);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return az.clearTime(new Date());},limitDate:function(dt,du){var A=this;if(az.after(dt,du)){dt=az.clone(du);}return dt;},plotEvents:function(){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(dt){var A=this;A.adjustCurrentDate();A._uiSetScrollable(A.get(ae));},_setScheduler:function(du){var A=this;var dt=A.get(t);if(dt){A.removeTarget(dt);}if(du){A.addTarget(du);du.after("eventsChange",cT.bind(A.flushViewCache,A));}return du;},_uiSetScrollable:function(du){var A=this;var dt=A.bodyNode;if(dt){dt.toggleClass(aj,du);dt.toggleClass(bS,!du);}},_uiSetVisible:function(dt){var A=this;bj.superclass._uiSetVisible.apply(this,arguments);if(dt&&A.get(a9)){A.adjustCurrentDate();}}}});cT.SchedulerView=bj;var cl=c7.sub;var m=cT.cached(function(){var dv=cT.config.doc,dt=dv.createElement("div"),A=dv.getElementsByTagName("body")[0],du=0.1;if(A){dt.style.cssText="position:absolute;visibility:hidden;overflow:scroll;width:20px;";dt.appendChild(dv.createElement("p")).style.height="1px";A.insertBefore(dt,A.firstChild);du=dt.offsetWidth-dt.clientWidth;A.removeChild(dt);}return du;},null,0.1);var R=function(A,dt){return function(dv){var du=dv.all(A);return(du.size()>=dt)?du:null;};},i=H(w),K=H(w,br,di,bt),aV=H(aM),bL=H(aM,cp),cC=H(aM,b0),V=H(t,au),aw=H(t,au,dp),C=H(cw,z),e=H(cw,b),c1=H(cw,bB),c2=H(cw,bB,a2),aX=H(cw,c4,cz,w),cA=H(cw,c4,cz),bO=H(cw,ak,bR),c3=H(cw,bs),P=H(cw,N),b8=H(cw,c4,ba),c6=H(cw,c4,cQ,ba),v=H(cw,c4,cQ,c4),bN=H(cw,c4,cQ,c4,cU,bl),cD=H(cw,c4,cQ,c4,aR),bp=H(cw,c4,cQ,ao),bA=H(cw,c4,cQ,b3,ai),dj=H(cw,c4,ba,ao),aL=H(cw,c4,ba,ao,X),U=H(cw,c4,ba,M),L=H(cw,c4,ba,aS),dc=H(cw,c4,ba,p),bV=H(cw,c4,ba,bU),r='<div class="'+cA+'">'+'<div class="'+[i,K,aX].join(aa)+'"></div>'+"</div>",am='<div class="'+c3+'">'+'<div class="'+bO+'"></div>'+"</div>",q='<span class="'+bA+'">{label}</span>',aD='<table cellspacing="0" cellpadding="0" class="'+b8+'">'+"<tbody>"+'<tr class="'+e+'" height="1">'+'<td height="0" class="'+[dj,U].join(aa)+'"></td>'+'<td class="'+c2+'" colspan="1">'+'<div class="'+c1+'">'+'<div class="'+P+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+C+'">'+'<td class="'+[dj,dc].join(aa)+'"></td>'+"</tr>"+"</tbody>"+"</table>",bH='<td class="'+[dj,L].join(aa)+'" data-colnumber="{colNumber}">'+'<div class="'+aL+'"></div>'+"</td>",k='<div class="'+bV+'">{hour}</div>',aE='<table cellspacing="0" cellpadding="0" class="'+c6+'">'+"<tbody>"+'<tr class="'+bp+'"></tr>'+"</tbody>"+"</table>",bK='<th class="'+v+'" data-colnumber="{colNumber}"><a href="#">&nbsp;</a></th>',aC='<td class="'+[v,cD].join(aa)+'"></td>',y='<th class="'+[v,bN].join(aa)+'">&nbsp;</th>';var dk=cT.Component.create({NAME:aP,ATTRS:{bodyContent:{value:cn},days:{value:1,validator:aQ},delegateConfig:{value:{},setter:function(dt){var A=this;
return cT.merge({dragConfig:{useShim:false},bubbleTargets:A,container:A.get(a6),nodes:cy+aV,invalid:"input, select, button, a, textarea, "+cy+bL},dt||{});},validator:dn},eventWidth:{value:95,validator:aQ},filterFn:{value:function(A){return(A.getHoursDuration()<=24&&!A.get(S));}},headerDateFormat:{value:"%d %A",validator:cF},headerView:{value:true,validator:bi},headerViewConfig:{setter:function(dt){var A=this;return cT.merge({displayDaysInterval:1,displayRows:6,filterFn:function(du){return((du.getHoursDuration()>24)||du.get(S));},height:"auto",visible:true},dt||{});},value:{}},hourHeight:{value:52,validator:aQ},name:{value:c4},strings:{value:{allDay:"All day"}},headerTableNode:{valueFn:function(){return cT.Node.create(aE);}},headerViewLabelNode:{valueFn:function(){var dt=this;var A=dt.get(cH);return cT.Node.create(cl(q,{label:A[S]}));}},resizerNode:{valueFn:function(){return cT.Node.create(r);}},tableNode:{valueFn:function(){return cT.Node.create(aD);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colDaysNode:R(cy+L,1),colHeaderDaysNode:R(cy+v,2),headerTableNode:cy+c6,headerViewLabelNode:cy+bA,markercellsNode:R(cy+c3,24),resizerNode:cy+cA,tableNode:cy+b8,timesNode:R(cy+bV,24)},EXTENDS:cT.SchedulerView,prototype:{initializer:function(){var A=this;A[aG]=A.get(aG);A[cW]=A.get(cW);A[dl]=A.get(dl);A[bk]=A.get(bk);A[cG]=A.get(cG);A[b6]=A.get(b6);A[aq]=A.get(aq);A[bx]=null;A[bT]=A[b6].one(cy+C);A[bf]=A.headerTableNode.one(cy+bp);A[aU]=A[aG].all(cy+aL);A[bG]=A[b6].one(cy+dc);A[b5]=A[b6].one(cy+c2);A[cf]=A[b6].one(cy+P);if(A.get(bm)){A[bm]=new cT.SchedulerTableView(A.get(bP));}},renderUI:function(){var A=this;A[bG].setContent(A[aq]);A[cf].setContent(A[bk]);A[aG].appendTo(A[bT]);A[cW].appendTo(A[bf]);if(A[bm]){A[bm].set(t,A.get(t));A[bm].render();}},bindUI:function(){var A=this;A[dl].delegate("click",cT.bind(A._onClickDaysHeader,A),cy+v);A[bT].delegate("mousedown",cT.bind(A._onMouseDownTableCol,A),cy+dj);A[bT].delegate("mouseenter",cT.bind(A._onMouseEnterEvent,A),cy+aV);A[bT].delegate("mouseleave",cT.bind(A._onMouseLeaveEvent,A),cy+aV);A[bT].delegate("mousemove",cT.bind(A._onMouseMoveTableCol,A),cy+L);A[bT].delegate("mouseup",cT.bind(A._onMouseUpTableCol,A),cy+dj);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:tickAlignY",A._dragTickAlignY);A.on("schedulerChange",A._onSchedulerChange);A.after("drag:align",A._afterDragAlign);},syncUI:function(){var A=this;dk.superclass.syncUI.apply(this,arguments);A[b5].attr(ac,A.get(Y));A._setupDragDrop();},syncStdContent:function(){var dt=this;dt.setStdModContent(cO.BODY,dt[b6].getDOM());var A=cT.NodeList.create(dt[dl]);if(dt[bm]){A.push(dt[bm].get(a6));A.push(dt.get(aW));}dt.setStdModContent(cO.HEADER,A);},calculateEventHeight:function(du){var dt=this;var A=dt.get(aN);return Math.max(du*(A/60),A/2);},calculateTop:function(dt){var A=this;return((dt.getHours()*60)+dt.getMinutes()+(dt.getSeconds()/60))*(A.get(aN)/60);},getNextDate:function(){var A=this;var dt=A.get(t).get(bF);return az.add(dt,az.DAY,1);},getPrevDate:function(){var A=this;var dt=A.get(t).get(bF);return az.subtract(dt,az.DAY,1);},getColumnByDate:function(dt){var A=this;return A[aG].item(A.getDateDaysOffset(dt));},getColumnShimByDate:function(dt){var A=this;return A[aU].item(A.getDateDaysOffset(dt));},getDateByColumn:function(du){var A=this;var dt=az.safeClearTime(A.get(t).get(bF));return az.add(dt,az.DAY,du);},getDateDaysOffset:function(du){var A=this;var dt=az.safeClearTime(A.get(t).get(bF));return az.getDayOffset(az.safeClearTime(du),dt);},getYCoordTime:function(dw){var dt=this;var A=dt.get(aN);var dx=cr((dw/A).toFixed(2));var dv=Math.floor((dx*100)%100*0.6);var du=Math.floor(dx);return[du,dv,0];},plotEvent:function(du){var A=this;var dv=du.get(ds);if(dv.size()<2){du.addPaddingNode();}var dx=du.get(ds).item(0);var dt=du.get(ds).item(1);var dw=A.getColumnShimByDate(du.get(aK));var dy=A.getColumnShimByDate(du.get(cX));if(dy){dy.append(dx);if(du.get(aF)){dx.show();}}else{dx.hide();}if(dw){if(dw.compareTo(dy)||du.isDayBoundaryEvent()){dt.hide();}else{dw.append(dt);if(du.get(aF)){dt.show();}}}else{dt.hide();}du.syncNodeUI();A.syncEventTopUI(du);A.syncEventHeightUI(du);},plotEvents:function(){var A=this;var dt=A.get(t);var du=A.get(cN);A[aU].each(function(dy,dx){var dv=dt.getEventsByDay(A.getDateByColumn(dx),true);var dw=[];dy.empty();cT.Array.each(dv,function(dz){if(du.apply(A,[dz])){A.plotEvent(dz);dw.push(dz);}});A.syncEventsIntersectionUI(dw);});if(A.get(bm)){A.syncHeaderViewUI();}},syncColumnsUI:function(){var A=this;A[aG].each(function(dv,du){var dt=A.getDateByColumn(du);dv.toggleClass(V,az.isToday(dt));});},syncDaysHeaderUI:function(){var du=this;var dv=du.get(t).get(bF);var dt=du.get(bD);var A=du.get(aH);du[cW].all(l).each(function(dy,dx){var dw=az.add(dv,az.DAY,dx);var dz=cT.DataType.Date.format(dw,{format:dt,locale:A});dy.toggleClass(aw,az.isToday(dw));dy.html(dz);});},syncEventsIntersectionUI:function(dt){var A=this;var du=A.get(u);A.get(t).flushEvents();cT.Array.each(dt,function(dw){var dy=A.findEventIntersections(dw,dt);var dx=dy.length;var dv=(du/dx);cT.Array.each(dy,function(dA,dB){var dz=dA.get(ds).item(0);var dD=dv*dB;var dC=dv*1.7;if(dB===(dx-1)){dC=du-dD;}dz.setStyle(cb,dC+cc);dz.setStyle(a7,dD+cc);var dE=dz.get(W);if(dE){dE.insert(dz,dB);}dA._filtered=true;});});},syncEventHeightUI:function(dv){var dt=this;var dz=dv.get(aK);var A=dv.get(cX);var dw=az.clone(A);dw.setHours(24,0,0);var dx=az.getMinutesOffset(dt.limitDate(dz,dw),A);dv.get(ds).item(0).set(cP,dt.calculateEventHeight(dx));var du=dv.get(ds).item(1);if(du.inDoc()){var dy=az.getMinutesOffset(dz,az.toMidnight(dv.getClearEndDate()));du.set(cP,dt.calculateEventHeight(dy));}},syncEventTopUI:function(dt){var A=this;dt.get(ds).item(0).setStyle(bW,A.calculateTop(dt.get(cX))+ap);dt.get(ds).item(1).setStyle(bW,0);},syncHeaderViewUI:function(){var dt=this;
if(dt.get(bm)){var dv=dt[bm];dv.plotEvents();var dw=dv.get(a6);dw.setStyle(n,m());var du=dw.one(cy+bo);var A=Math.max(du.get(cP),40);dv.set(cB,A);dt._fillHeight();}},calculateYDelta:function(du,dt){var A=this;return(dt[1]-du[1])/(A.get(aN)/2)*30;},findEventIntersections:function(dt,du){var A=this;var dv=[];cT.Array.each(du,function(dw){if(!dt._filtered&&dt.intersectHours(dw)){dv.push(dw);}});return dv;},getXYDelta:function(dt){var A=this;var du=dt.currentTarget.getXY(),dv=[dt.pageX,dt.pageY];return cT.Array.map(du,function(dx,dw){return(dv[dw]-dx);});},getTickY:function(){var A=this;return cu(Math.ceil(A.get(aN)/2),10);},roundToNearestHour:function(dt,du){var A=this;dt.setHours(du[0],cu(du[1],A.getTickY()),du[2]);},_afterDragAlign:function(du){var dt=this;var A=du.target;if(!dt[ab]){dt[ab]=A.actXY;}A.actXY[0]=null;},_dragTickAlignX:function(du){var dt=this;var dx=dt[J];if(dx&&!dt[ct]){var dv=dt[co];var dw=cr(du.attr(x))-dt.startColNumber;dt.draggingEventStartDate=az.add(dx.get(cX),az.DAY,dw);var A=az.clone(dt.draggingEventStartDate);az.copyHours(A,dv.get(cX));dv.move(A);dt.plotEvent(dv);}},_dragTickAlignY:function(A){var dy=this;var dt=dy.get(t);var dA=dt.get(dq);var dv=dy[J];if(dv){var dz=A.target.get(a5);var dw=dy[co];var dx=dy.calculateYDelta(dy[ab],dz.actXY);if(dy[ct]){var du=az.add(dy.draggingEventEndDate,az.MINUTES,dx);if(az.getMinutesOffset(du,dy.draggingEventStartDate)<=dA.get(cE)){return;}dw.set(aK,du);}else{dw.move(az.add(dy.draggingEventStartDate,az.MINUTES,dx));}dy.plotEvent(dw);}},_setupDragDrop:function(){var dt=this;if(!dt[co]){var du=dt.get(t);dt[co]=new (dt.get(dh))({scheduler:du});dt[co].removeTarget(du);dt[co].get(ds).addClass(cC).hide();}if(!dt.delegate){dt.delegate=new cT.DD.Delegate(dt.get(F));}var A=dt.delegate.dd;A.unplug(cT.Plugin.DDConstrained);A.unplug(cT.Plugin.DDNodeScroll);var dv=dt.bodyNode.get(al);dv.bottom=Infinity;dv.top=-Infinity;A.plug(cT.Plugin.DDConstrained,{bubbleTargets:dt,constrain:dv,stickY:true,tickY:dt.get(aN)/2});A.plug(cT.Plugin.DDNodeScroll,{node:dt.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(dt){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(dv){var A=this;var du=A.get(t);if(dv.target.test(l)){var dw=du.getViewByName(c4);if(dw){var dt=cr(dv.currentTarget.attr(x));du.set(bF,A.getDateByColumn(dt));du.set(cq,dw);}}dv.preventDefault();},_onEventDragEnd:function(dt){var A=this;var dv=A[J];if(dv){var du=A[co];du.set(aF,false);dv.set(aF,true);dv.copyDates(du);A.get(t).syncEventsUI();}A[ab]=null;A[J]=null;},_onEventDragStart:function(du){var A=this;var dw=A[J]=A.delegate.dd.get(ds).getData(aM);if(dw){var dv=A[co];dv.copyPropagateAttrValues(dw);A.plotEvent(dv);dw.set(aF,false);A.draggingEventStartDate=az.clone(dw.get(cX));A.draggingEventEndDate=az.clone(dw.get(aK));var dt=A.getColumnByDate(dw.get(cX));A.startColNumber=dt?cr(dt.attr(x)):0;}},_onMouseDownTableCol:function(dt){var dy=this;var dx=dt.target;var dv=dy.get(t);var dz=dv.get(dq);if(dz&&!dv.get(cp)){dz.hideOverlay();if(dx.test(cy+aL)){dy[ab]=[dt.pageX,dt.pageY];var dA=cr(dt.currentTarget.attr(x));var du=dy.getDateByColumn(dA);var A=dy.getXYDelta(dt);dy.roundToNearestHour(du,dy.getYCoordTime(A[1]));var dw=az.add(du,az.MINUTES,dz.get(cE));dz.move(du);dz.set(S,false);dz.set(aK,dw);dy[af]=du;dy[bw]=dw;dt.halt();}else{if(dx.test([cy+cA,cy+aX].join(bQ))){dy[ct]=true;}}}dy.get(a6).unselectable();},_onMouseEnterEvent:function(du){var A=this;var dv=du.currentTarget;var dt=dv.getData(aM);if(dt&&!dt.get(cp)){A[cG].appendTo(dv);}},_onMouseLeaveEvent:function(dt){var A=this;if(!A[ct]){A._removeResizer();}},_onMouseMoveTableCol:function(dw){var A=this;var dv=dw.currentTarget;var dt=A.get(t).get(dq);if(A[bx]!==dv){A[bx]=dv;A._dragTickAlignX(A[bx]);}var du=A[bw];var dx=A[af];if(dx){var dy=cu(A.calculateYDelta(A[ab],[dw.pageX,dw.pageY]),A.getTickY());if(A._delta!==dy){if(dy>0){dt.set(aK,az.add(du,az.MINUTES,dy));}else{dt.set(cX,az.add(dx,az.MINUTES,dy));}A.plotEvent(dt);A._delta=dy;}}},_onMouseUpTableCol:function(dv){var A=this;var du=A.get(t);var dt=du.get(dq);if(dt&&!du.get(cp)){if(A[af]){A.plotEvent(dt);dt.showOverlay([dv.pageX,dv.pageY]);}}A[af]=null;A[bw]=null;A[ct]=false;A[ab]=null;A._removeResizer();A.get(a6).selectable();},_onSchedulerChange:function(dt){var A=this;if(A[bm]){A[bm].set(t,dt.newVal);}},_removeResizer:function(){var A=this;A[cG].remove();},_valueColDaysNode:function(){var A=this;var dv=A.get(Y);var dt=[],du=0;while(dv--){dt.push(cT.Lang.sub(bH,{colNumber:du++}));}return cT.NodeList.create(dt.join(cn));},_valueColHeaderDaysNode:function(){var A=this;var dv=A.get(Y);var dt=[],du=0;dt.push(aC);while(dv--){dt.push(cT.Lang.sub(bK,{colNumber:du++}));}dt.push(y);return cT.NodeList.create(dt.join(cn));},_valueMarkercellsNode:function(){var A=this;var dt=[],du;for(du=0;du<=23;du++){dt.push(am);}return cT.NodeList.create(dt.join(cn));},_valueTimesNode:function(){var A=this;var dv=A.get(at);var du=[],dt;for(dt=0;dt<=23;dt++){du.push(cl(k,{hour:dv?az.toIsoTimeString(dt):az.toUsTimeString(dt,false,true)}));}return cT.NodeList.create(du.join(cn));}}});cT.SchedulerDayView=dk;var av=cT.Component.create({NAME:cY,ATTRS:{bodyContent:{value:cn},days:{value:7},headerViewConfig:{value:{displayDaysInterval:aY}},name:{value:da}},EXTENDS:cT.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var dv=A.get(t);var dt=dv.get(bF);var du=dv.get(cZ);dv.set(bF,az.getFirstDayOfWeek(dt,du));},getNextDate:function(){var A=this;var du=A.get(t);var dt=du.get(bF);var dv=A._firstDayOfWeek(dt);return az.add(dv,az.WEEK,1);},getPrevDate:function(){var A=this;var du=A.get(t);var dt=du.get(bF);var dv=A._firstDayOfWeek(dt);return az.subtract(dv,az.WEEK,1);},getToday:function(){var A=this;var dt=av.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(dt);},_firstDayOfWeek:function(du){var A=this;var dv=A.get(t);var dt=dv.get(cZ);return az.getFirstDayOfWeek(du,dt);}}});cT.SchedulerWeekView=av;var i=H(w),o=H(w,"arrowstop-1-l"),dd=H(w,"arrowstop-1-r"),s=H(cw,ba,b),a1=H(cw,ba,b,aR),aB=H(cw,ba,b,au),bI=H(cw,ba,a2),D=H(cw,ba,cK,a2),ch=H(cw,ba,cK,a2,ay),c9=H(cw,ba,cK,a2,a8),ax=H(cw,ba,cQ,ao),c8=H(cw,ba,cQ,c4),d=H(cw,ba,cQ,ba),I=H(cw,ba,bd),ci=H(cw,ba,b1),cS=H(cw,ba,bY),ca=H(cw,ba,bY,a2),bo=H(cw,ba,b9),cM=H(cw,ba,b9,ao),b2=H(cw,ba,b9,ao,j),cI=H(cw,ba,b9,ao,j,ah),ce=H(cw,ba,b9,ao,j,aR),dg=H(cw,ba,b9,ao,j,a0),bM=H(cw,ba,b9,ao,j,au),aI=H(cw,ba,b9,bq),c=H(cw,ba,b9,bq,a7),cV=H(cw,ba,b9,bq,cL),an=H(cw,ba,b9,bq,bl),ag=H(cw,ba,b9,aR),aO=H(cw,ba,bB),cg=H(cw,ba,bB,aR),a4='<div class="'+bI+'">'+'<div class="'+ca+'"></div>'+"</div>",b7='<div class="'+D+'">'+'<div class="'+ch+'"></div>'+'<a href="javascript:;" class="'+c9+'">{label}</a>'+"</div>",cx='<td class="'+s+'">&nbsp;</td>',g='<th class="'+c8+'"><div>&nbsp;</div></th>',Z='<table cellspacing="0" cellpadding="0" class="'+d+'">'+"<tbody>"+'<tr class="'+ax+'"></tr>'+"</tbody>"+"</table>",bZ='<div class="'+I+'"></div>',bv='<a href="javascript:;" class="'+ci+'">{label} {count}</a>',bE='<div class="'+cS+'" style="top: {top}%; height: {height}%;"></div>',bJ='<table cellspacing="0" cellpadding="0" class="'+bo+'">'+"<tbody></tbody>"+"</table>",be='<table cellspacing="0" cellpadding="0" class="'+aO+'">'+"<tbody>"+"<tr></tr>"+"</tbody>"+"</table>",T='<span class="'+[i,o].join(aa)+'"></span>',bu='<span class="'+[i,dd].join(aa)+'"></span>',bC='<td class="'+cM+'"><div></div></td>',c5="<tr></tr>";
var bh=cT.Component.create({NAME:cm,ATTRS:{bodyContent:{value:cn},displayDaysInterval:{value:42},displayRows:{value:4},fixedHeight:{value:true},name:{value:ba},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},strings:{value:{"close":"Close","showMore":"Show more"}},headerTableNode:{valueFn:function(){return cT.Node.create(Z);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},rowsContainerNode:{valueFn:function(){return cT.Node.create(a4);}},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{colHeaderDaysNode:R(cy+c8,7),headerTableNode:cy+d,rowsContainerNode:cy+bI,tableGridNode:R(cy+aO,7)},EXTENDS:cT.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var dt=this;var A=dt.get(cH);dt.evtDateStack={};dt.evtDataTableStack={};dt[cW]=dt.get(cW);dt[dl]=dt.get(dl);dt[bX]=dt.get(bX);dt[E]=dt.get(E);dt[bf]=dt.headerTableNode.one(cy+ax);dt[a3]=cT.NodeList.create();dt[ck]=dt[bX].one(cy+ca);dt[de]=cT.NodeList.create();dt[bg]=cT.Node.create(c7.sub(b7,{label:A[a8]}));},bindUI:function(){var A=this;var dt=A.get(t).get(dq);dt.on({cancel:cT.bind(A.removeLasso,A),save:cT.bind(A.removeLasso,A)});A[bX].on({mousedown:cT.bind(A._onMouseDownGrid,A),mousemove:cT.bind(A._onMouseMoveGrid,A),mouseup:cT.bind(A._onMouseUpGrid,A)});A[bg].delegate("click",cT.bind(A._hideEventsOverlay,A),cy+c9);A[bX].delegate("click",cT.bind(A._onClickMore,A),cy+ci);},renderUI:function(){var dt=this;var dw=dt.get(bc);var du=Math.ceil(dw/aY);var dy=100/du;for(var dv=0;dv<du;dv++){var A=dt._getTableGridNode(dv);var dx=cT.Node.create(c7.sub(bE,{height:dy,top:dy*dv}));dx.append(A.toggleClass(cg,(dv===0)));dt[de].push(dx);}dt[by]=new cT.Overlay({align:{points:[a,a]},bodyContent:dt[bg],visible:false,width:250,zIndex:400});dt[cW].appendTo(dt[bf]);dt[de].appendTo(dt[ck]);},buildEventsTable:function(dt,dx){var dF=this;var dy=dF.get(bc);var dC=dF.get(cJ);var dH=dF.get(cN);var dG=dF.get(cH);var dE=az.clearTime(dF._findCurrentIntervalEnd());var dB=az.clearTime(dF._findCurrentIntervalStart());var dA=String(dB.getTime()).concat(dt.getTime()).concat(dx.getTime());var dz=dF.evtDataTableStack[dA];if(!dz){dz=cT.Node.create(bJ);var dD=dz.one(b4);var dv=cT.Node.create(c5);dF.loopDates(dt,dx,function(dJ,dI){var dK=cT.Node.create(bC);dK.addClass(b2).toggleClass(ce,(dI===0)).toggleClass(bM,az.isToday(dJ)).toggleClass(dg,az.isToday(az.subtract(dJ,az.DAY,1))).toggleClass(cI,az.isToday(az.subtract(dJ,az.WEEK,1)));dv.append(dK.setContent(dJ.getDate()));});dD.append(dv);var A;for(A=0;A<dC;A++){var dw=0;var du=cT.Node.create(c5);dF.loopDates(dt,dx,function(dU,dO){if(dw<=dO){var dV=dF.getIntersectEvents(dU),dS=dV[A];var dL=cT.Node.create(bC);if((A===dC-1)&&(dV.length>dC)){var dP=cT.Node.create(c7.sub(bv,{count:(dV.length-(dC-1)),label:dG[O]}));dP.setData(cK,dV);dL.append(dP);}else{if(dS&&dH.apply(dF,[dS])){var dJ=dS.get(cX);var dQ=!az.isDayOverlap(dJ,dU);var dR=az.after(dU,dJ)&&!az.isDayOverlap(dU,dt);if(dQ||dR){var dK=dS.get(ds);var dM=az.getFirstDayOfWeek(new Date(Math.max(dJ,dB)));var dT=Math.floor(az.getDayOffset(dU,dM)/aY);if(dK.size()<=dT){dS.addPaddingNode();}var dN=dK.item(dT);dN.setStyles({height:"auto",left:0,top:0,width:"auto"});dS.syncNodeUI();var dI=dL.one(ad);dN.appendTo(dI);var dW=dF._getEvtSplitInfo(dS,dU,dt,dx);dL.attr(ac,dW.colspan);dI.addClass(aI);if(dW.left){dI.addClass(c).prepend(T);}if(dW.right){dI.addClass(an).append(bu);}if(dS.get(db)){dI.addClass(cV);}dw+=dW.colspan;}else{dw++;}}else{dw++;}}du.append(dL);}});dD.append(du);}dF.evtDataTableStack[dA]=dz;}return dz;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(dt){var A=this;var dw=A.get(t);var dv=String(dt.getTime());if(!A.evtDateStack[dv]){var du=dw.getIntersectEvents(dt);A.evtDateStack[dv]=du.filter(A.get(cN));}return A.evtDateStack[dv];},getNextDate:function(){var A=this;var dv=A.get(t);var dt=dv.get(bF);var du=A.get(bc);return az.add(dt,az.DAY,du);},getPrevDate:function(){var A=this;var dv=A.get(t);var dt=dv.get(bF);var du=A.get(bc);return az.subtract(dt,az.DAY,du);},loopDates:function(A,dv,dy,dz,dx){var dA=this;var dt=az.clone(A);var du=dv.getTime(),dw;for(dw=0;dt.getTime()<=du;dw++){dy.apply(dA,[dt,dw]);dt=az.add(dt,(dz||az.DAY),(dx||1));}},plotEvents:function(){var dt=this;var dw=dt._findCurrentIntervalStart();var A=az.safeClearTime(dw);dt.flushViewCache();dt._hideEventsOverlay();dt.bodyNode.all(cy+bo).remove();var du=dt.get(bc);var dv=Math.min(du,aY);dt[de].each(function(dA,dy){var dx=az.add(A,az.DAY,dv*dy);var dB=az.add(dx,az.DAY,dv-1);var dz=dt.buildEventsTable(dx,dB);if(dy===0){dz.addClass(ag);}dA.append(dz);});},removeLasso:function(){var A=this;if(A.lasso){A.lasso.remove();}},renderLasso:function(dz,dt){var dF=this;var dw=dz;var dy=dt;if(dz[1]>dt[1]){dw=dt;dy=dz;}var dG=dw[0],dB=dw[1],du=dy[0],A=dy[1];dF.removeLasso();dF.lasso=cT.NodeList.create();for(var dv=dB;dv<=A;dv++){var dx=dF.gridCellHeight,dE=dF.gridCellWidth,dC=0,dA=(dx*dv);if(dv===dB){if(dB===A){dC+=Math.min(dG,du)*dE;dE*=Math.abs(du-dG)+1;}else{dC+=dG*dE;dE*=aY-dG;}}else{if(dv===A){dE*=du+1;}else{dE*=aY;}}var dD=cT.Node.create(bZ);dF.lasso.push(dD);dF[bX].append(dD);dD.sizeTo(dE,dx);dD.setXY(dF._offsetXY([dC,dA],1));}},syncDaysHeaderUI:function(){var du=this;var dx=du.get(t);var dv=dx.get(bF);var dt=du.get(bD);var A=du.get(aH);var dw=du._findFirstDayOfWeek(dv);du.colHeaderDaysNode.all(ad).each(function(dA,dz){var dy=az.add(dw,az.DAY,dz);var dB=cT.DataType.Date.format(dy,{format:dt,locale:A});dA.html(dB);});},syncGridUI:function(){var dC=this;var dw=dC.getToday();var dt=dC.get(t);dC[a3].removeClass(aB);var dv=dC._findCurrentIntervalStart();var dy=dC._findCurrentIntervalEnd();if(az.between(dw,dv,dy)){var A=dt.get(cZ);var dA=dC._findFirstDayOfWeek(dw);var dx=az.getWeekNumber(dw,A)-az.getWeekNumber(dv,A);var dB=(dw.getDate()-dA.getDate());var du=dC._getCellIndex([dB,dx]);var dz=dC[a3].item(du);if(dz){dz.addClass(aB);}}},syncStdContent:function(){var A=this;A.setStdModContent(cO.BODY,A[bX].getDOM());
A.setStdModContent(cO.HEADER,A[dl].getDOM());},_findCurrentIntervalEnd:function(){var A=this;var dv=A.get(t);var dt=dv.get(bF);var du=A.get(bc);return az.add(dt,az.DAY,du);},_findCurrentIntervalStart:function(){var A=this;var dt=A.get(t);return dt.get(bF);},_findFirstDayOfWeek:function(du){var A=this;var dv=A.get(t);var dt=dv.get(cZ);return az.getFirstDayOfWeek(du,dt);},_getCellIndex:function(dt){var A=this;return dt[1]*aY+dt[0];},_getEvtLabel:function(du){var dt=this;var dv=du.get(aK);var A=du.get(cX);return[A.getHours(),cs,dv.getHours(),aa,du.get(aZ)].join(cn);},_getEvtSplitInfo:function(dx,dA,A,dv){var dy=this;var dt=dx.getClearStartDate();var dw=dx.getClearEndDate();var dz=az.getDayOffset(dv,dA);var du={colspan:Math.min(az.getDayOffset(dw,dA),dz)+1,left:az.before(dt,A),right:az.after(dw,dv)};return du;},_getPositionDate:function(du){var dt=this;var dv=dt._findCurrentIntervalStart();var A=az.safeClearTime(dt._findFirstDayOfWeek(dv));return az.add(A,az.DAY,dt._getCellIndex(du));},_getTableGridNode:function(dy){var dt=this;var dv=dt.get(bc);var A=dt[E].item(dy);var dx=A.one(dm);for(var du=0;du<Math.min(dv,aY);du++){var dw=cT.Node.create(cx);dx.append(dw);dt[a3].push(dw);}return A;},_hideEventsOverlay:function(){var A=this;A[by].set(aF,false);},_offsetXY:function(dv,du){var A=this;var dt=A[bX].getXY();return[dv[0]+dt[0]*du,dv[1]+dt[1]*du];},_onClickMore:function(du){var A=this;var dv=du.target;var dt=dv.getData(cK);var dw=cT.NodeList.create();cT.Array.each(dt,function(dy){var dx=dy.get(ds).item(0).clone();dx.setData(aM,dy);dx.setStyles({height:"auto",left:0,position:"relative",top:0,width:"auto"});dw.push(dx);});A[bg].one(cy+ch).setContent(dw);A[by].render(A[bX]);A[by].setAttrs({visible:true,xy:dv.getXY()});},_onMouseDownGrid:function(dx){var A=this;var dy=dx.target;if(dy.test([cy+s,cy+cM].join(bQ))){A._recording=true;var dv=A.get(bc);var dt=Math.ceil(dv/aY);var dw=Math.min(dv,aY);A.gridCellHeight=A[bX].get(cP)/dt;A.gridCellWidth=A[bX].get(cR)/dw;var du=A._offsetXY([dx.pageX,dx.pageY],-1);A.lassoStartPosition=A.lassoLastPosition=A._findPosition(du);A.renderLasso(A.lassoStartPosition,A.lassoLastPosition);A[bX].unselectable();}},_onMouseMoveGrid:function(dw){var dt=this;var dx=dw.currentTarget;var du=dt._offsetXY([dw.pageX,dw.pageY],-1);var dv=dt.lassoLastPosition||dt.lassoStartPosition;var A=dt._findPosition(du);var dy=dv&&((A[0]!==dv[0])||(A[1]!==dv[1]));if(dy&&dt._recording){dt.lassoLastPosition=A;dt.renderLasso(dt.lassoStartPosition,A);}},_onMouseUpGrid:function(dy){var dt=this;var dx=dt.get(t);var dv=dx.get(dq);if(dv&&dt._recording&&!dx.get(cp)){var dw=dt._getPositionDate(dt.lassoStartPosition);var du=dt._getPositionDate(dt.lassoLastPosition);var A=new Date(Math.min(dw,du));A.setHours(0,0,0);var dz=new Date(Math.max(dw,du));dz.setHours(23,59,59);dv.set(S,true);dv.set(aK,dz);dv.set(cX,A);dv.showOverlay([dy.pageX,dy.pageY]);dt._hideEventsOverlay();dt._recording=false;}},_findPosition:function(dv){var A=this;var du=Math.floor(dv[0]/A.gridCellWidth);var dt=Math.floor(dv[1]/A.gridCellHeight);return[du,dt];},_uiSetCurrentDate:function(dt){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;var dt=A.get(bc);var du=Math.min(dt,aY);return A._valueNodeList(du,g);},_valueTableGridNode:function(){var A=this;var dt=A.get(bc);var du=Math.min(dt,aY);return A._valueNodeList(du,be);},_valueNodeList:function(dv,du){var A=this;var dt=[];while(dv--){dt.push(du);}return cT.NodeList.create(dt.join(cn));}}});cT.SchedulerTableView=bh;var bn=H(df,ba,b9,ao,ar);var aJ=cT.Component.create({NAME:df,ATTRS:{displayDaysInterval:{readOnly:true,value:42},name:{value:cj}},EXTENDS:cT.SchedulerTableView,prototype:{getNextDate:function(){var A=this;var du=A.get(t);var dt=du.get(bF);return az.add(dt,az.MONTH,1);},getPrevDate:function(){var A=this;var du=A.get(t);var dt=du.get(bF);return az.subtract(dt,az.MONTH,1);},plotEvents:function(){var A=this;cT.SchedulerMonthView.superclass.plotEvents.apply(A,arguments);var du=A.get(t);var dt=du.get(bF);var dx=az.findMonthEnd(dt);var dw=az.findMonthStart(dt);var dv=A._findCurrentIntervalStart();var dy=A[ck].all(cy+b2);dy.each(function(dB,dz){var dA=az.add(dv,az.DAY,dz);if(az.before(dA,dw)||az.after(dA,dx)){dB.addClass(bn);}});},_findCurrentIntervalStart:function(){var A=this;var dv=A.get(t);var dt=dv.get(bF);var du=az.findMonthStart(dt);return A._findFirstDayOfWeek(du);},_findFirstDayOfWeek:function(du){var A=this;var dv=A.get(t);var dt=dv.get(cZ);return az.getFirstDayOfWeek(du,dt);}}});cT.SchedulerMonthView=aJ;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","dd-drag","dd-delegate","dd-drop","dd-constrain"]});