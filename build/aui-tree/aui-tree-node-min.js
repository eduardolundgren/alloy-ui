AUI.add("aui-tree-node",function(ai){var X=ai.Lang,aS=X.isString,aI=X.isBoolean,a1="alwaysShowHitArea",T="",u="boundingBox",h="children",aO="clearfix",z="collapsed",a="container",ag="content",x="contentBox",o="draggable",k="expanded",r="helper",aa="hidden",g="hitAreaEl",M="hitarea",Y="icon",a0="iconEl",d="invalid",ay="id",ao="label",ab="labelEl",W="lastSelected",aN="leaf",s="node",aq="over",ad="ownerTree",f="parentNode",aE="radio",aY="rendered",aM="selected",v=" ",i="tree",N="tree-node",aW=function(){return Array.prototype.slice.call(arguments).join(v);},av=function(A){return(A instanceof ai.TreeNode);},aU=function(A){return(A instanceof ai.TreeView);},K=ai.getClassName,al=K(r,aO),D=K(i,z),b=K(i,a),aH=K(i,x),a2=K(i,k),w=K(i,aa),aA=K(i,M),J=K(i,Y),l=K(i,ao),aK=K(i,s),I=K(i,s,ag),E=K(i,s,ag,d),aB=K(i,s,aa,M),j=K(i,s,aN),aR=K(i,s,aq),O=K(i,s,aM),ah='<div class="'+aA+'"></div>',t='<div class="'+J+'"></div>',e='<div class="'+l+'"></div>',aZ="<ul></ul>",y='<li class="'+aK+'"></li>',ae='<div class="'+aW(al,I)+'"></div>';var R=ai.Component.create({NAME:N,ATTRS:{boundingBox:{valueFn:function(){return ai.Node.create(y);}},contentBox:{valueFn:function(){return ai.Node.create(ae);}},draggable:{value:true,validator:aI},ownerTree:{value:null},label:{value:T,validator:aS},expanded:{value:false,validator:aI},id:{validator:aS,valueFn:function(){return ai.guid();}},leaf:{value:true,setter:function(A){if(A&&this.get(h).length){return false;}return A;},validator:aI},nextSibling:{getter:"_getSibling",value:null,validator:av},prevSibling:{getter:"_getSibling",value:null,validator:av},parentNode:{value:null,validator:function(A){return av(A)||aU(A);}},labelEl:{setter:ai.one,valueFn:function(){var A=this.get(ao);return ai.Node.create(e).html(A).unselectable();}},hitAreaEl:{setter:ai.one,valueFn:function(){return ai.Node.create(ah);}},alwaysShowHitArea:{value:true,validator:aI},iconEl:{setter:ai.one,valueFn:function(){return ai.Node.create(t);}},tabIndex:{value:null},rendered:{validator:aI,value:false}},AUGMENTS:[ai.TreeData],EXTENDS:ai.Base,prototype:{BOUNDING_TEMPLATE:y,CONTENT_TEMPLATE:ae,initializer:function(){var A=this;var a5=A.get(u);a5.setData(N,A);A._syncTreeNodeBBId();A._uiSetDraggable(A.get(o));A._uiSetExpanded(A.get(k));A._uiSetLeaf(A.get(aN));},bindUI:function(){var A=this;A.after("childrenChange",ai.bind(A._afterSetChildren,A));A.after("draggableChange",ai.bind(A._afterDraggableChange,A));A.after("expandedChange",ai.bind(A._afterExpandedChange,A));A.after("idChange",A._afterSetId,A);A.after("leafChange",ai.bind(A._afterLeafChange,A));},render:function(a5){var A=this;if(!A.get(aY)){A.renderUI();A.bindUI();A.syncUI();A.set(aY,true);}if(a5){A.get(u).appendTo(a5);}},renderUI:function(){var A=this;A._renderBoundingBox();A._renderContentBox();},syncUI:function(){var A=this;A._syncHitArea(A.get(h));},_afterDraggableChange:function(a5){var A=this;A._uiSetDraggable(a5.newVal);},_afterExpandedChange:function(a5){var A=this;A._uiSetExpanded(a5.newVal);},_afterLeafChange:function(a5){var A=this;A._uiSetLeaf(a5.newVal);},_afterSetChildren:function(a5){var A=this;A._syncHitArea(a5.newVal);},_renderContentBox:function(a7){var A=this;var a5=A.get(x);if(!A.isLeaf()){var a6=A.get(k);a5.addClass(a6?a2:D);if(a6){A.expand();}}return a5;},_renderBoundingBox:function(){var A=this;var a6=A.get(u);var a5=A.get(x);a5.append(A.get(a0));a5.append(A.get(ab));a6.append(a5);var a7=A.get(a);if(a7){if(!A.get(k)){a7.addClass(w);}a6.append(a7);}return a6;},_createNodeContainer:function(){var A=this;var a5=A.get(a)||ai.Node.create(aZ);a5.addClass(b);A.set(a,a5);return a5;},_syncHitArea:function(a5){var A=this;if(A.get(a1)||a5.length){A.showHitArea();}else{A.hideHitArea();A.collapse();}},appendChild:function(){var A=this;if(!A.isLeaf()){ai.TreeNode.superclass.appendChild.apply(A,arguments);}},collapse:function(){var A=this;A.set(k,false);},collapseAll:function(){var A=this;ai.TreeNode.superclass.collapseAll.apply(A,arguments);A.collapse();},contains:function(A){return A.isAncestor(this);},expand:function(){var A=this;A.set(k,true);},expandAll:function(){var A=this;ai.TreeNode.superclass.expandAll.apply(A,arguments);A.expand();},getDepth:function(){var a5=this;var a6=0;var A=a5.get(f);while(A){++a6;A=A.get(f);}return a6;},hasChildNodes:function(){var A=this;return(!A.isLeaf()&&ai.TreeNode.superclass.hasChildNodes.apply(this,arguments));},isSelected:function(){return this.get(x).hasClass(O);},isLeaf:function(){var A=this;return A.get(aN);},isAncestor:function(a6){var a5=this;var A=a5.get(f);while(A){if(A===a6){return true;}A=A.get(f);}return false;},toggle:function(){var A=this;if(A.get(k)){A.collapse();}else{A.expand();}},select:function(){var A=this;var a5=A.get(ad);if(a5){a5.set(W,A);}A.get(x).addClass(O);A.fire("select");},unselect:function(){var A=this;A.get(x).removeClass(O);A.fire("unselect");},over:function(){this.get(x).addClass(aR);},out:function(){this.get(x).removeClass(aR);},showHitArea:function(){var A=this;var a5=A.get(g);a5.removeClass(aB);},hideHitArea:function(){var A=this;var a5=A.get(g);a5.addClass(aB);},_syncTreeNodeBBId:function(a5){var A=this;A.get(u).attr(ay,A.get(ay));},_getSibling:function(a8,a5){var A=this;var a7="_"+a5;var a6=A[a7];if(a6!==null&&!av(a6)){a6=null;A[a7]=a6;}return a6;},_uiSetDraggable:function(a6){var A=this;var a5=A.get(x);a5.toggleClass(E,!a6);},_uiSetExpanded:function(a7){var A=this;if(!A.isLeaf()){var a6=A.get(a);var a5=A.get(x);if(a7){a5.replaceClass(D,a2);if(a6){a6.removeClass(w);}}else{a5.replaceClass(a2,D);if(a6){a6.addClass(w);}}}},_uiSetLeaf:function(a6){var A=this;var a5=A.get(x);if(a6){A.get(a).remove();A.get(g).remove();}else{a5.prepend(A.get(g));A._createNodeContainer();A._uiSetExpanded(A.get(k));}a5.toggleClass(j,a6);}}});ai.TreeNode=R;var aD=X.isFunction,L=X.isObject,aj=X.isValue,aT="cache",az="end",ap="io",aJ="limit",aX="loaded",a3="loading",aF="Load more results",an="paginator",at="start",ax="tree-node-io",c="paginatorClick",aG=K(i,s,an),C=K(i,s,ap,a3),aC='<a class="'+aG+'" href="javascript:void(0);">{moreResultsLabel}</a>';
var Q=ai.Component.create({NAME:ax,ATTRS:{io:{lazyAdd:false,value:null,setter:function(A){return this._setIO(A);}},loading:{value:false,validator:aI},loaded:{value:false,validator:aI},cache:{value:true,validator:aI},leaf:{value:false,validator:aI},paginator:{setter:function(a6){var a5=this;var A=ai.Node.create(X.sub(aC,{moreResultsLabel:a6.moreResultsLabel||aF}));return ai.merge({alwaysVisible:false,autoFocus:true,element:A,endParam:az,limitParam:aJ,start:0,startParam:at},a6);},validator:L}},EXTENDS:ai.TreeNode,prototype:{bindUI:function(){var A=this;ai.TreeNodeIO.superclass.bindUI.apply(this,arguments);A._bindPaginatorUI();A._createEvents();},syncUI:function(){var A=this;ai.TreeNodeIO.superclass.syncUI.apply(this,arguments);A._syncPaginatorUI();},_bindPaginatorUI:function(){var A=this;var a6=A.get(an);if(a6){var a5=ai.bind(A._handlePaginatorClickEvent,A);a6.element.on("click",a5);}},createNodes:function(a5){var A=this;ai.Array.each(ai.Array(a5),function(a7){var a6=A.createNode.call(A,a7);A.appendChild(a6);});A._syncPaginatorUI(a5);},expand:function(){var A=this;var a5=A.get(aT);var a8=A.get(ap);var a6=A.get(aX);var a7=A.get(a3);if(!a5){A.set(aX,false);}if(a8&&!a6&&!a7&&!this.hasChildNodes()){if(!a5){A.empty();}A.initIO();}else{ai.TreeNodeIO.superclass.expand.apply(this,arguments);}},initIO:function(){var a5=this;var a6=a5.get(ap);if(aD(a6.cfg.data)){a6.cfg.data=a6.cfg.data.call(a5,a5);}a5._syncPaginatorIOData(a6);if(aD(a6.loader)){var A=ai.bind(a6.loader,a5);A(a6.url,a6.cfg,a5);}else{ai.io.request(a6.url,a6.cfg);}},ioStartHandler:function(){var A=this;var a5=A.get(x);A.set(a3,true);a5.addClass(C);},ioCompleteHandler:function(){var A=this;var a5=A.get(x);A.set(a3,false);A.set(aX,true);a5.removeClass(C);},ioSuccessHandler:function(){var bc=this;var a8=bc.get(ap);var bb=bc.get(ad);var a9=Array.prototype.slice.call(arguments);var a6=a9.length;var A=a9[1];if(a6>=3){var a5=a9[2];try{A=ai.JSON.parse(a5.responseText);}catch(a7){}}var ba=a8.formatter;if(ba){A=ba(A);}bc.createNodes(A);bc.expand();if(bb&&bb.ddDelegate){bb.ddDelegate.syncTargets();}},ioFailureHandler:function(){var A=this;A.set(a3,false);A.set(aX,false);},_createEvents:function(){var A=this;A.publish(c,{defaultFn:A._defPaginatorClickFn,prefix:ax});},_defPaginatorClickFn:function(a5){var A=this;var a6=A.get(an);if(aj(a6.limit)){a6.start+=a6.limit;}if(A.get(ap)){A.initIO();}},_handlePaginatorClickEvent:function(a7){var A=this;var a6=A.get(ad);var a5=A.getEventOutputMap(A);A.fire(c,a5);if(a6){a6.fire(c,a5);}a7.halt();},_inheritOwnerTreeAttrs:function(){var a5=this;var a6=a5.get(ad);if(a6){if(!a5.get(ap)){a5.set(ap,ai.clone(a6.get(ap)));}if(!a5.get(an)){var A=a6.get(an);if(A&&A.element){A.element=A.element.clone();}a5.set(an,A);}}},_setIO:function(a6){var A=this;if(!a6){return null;}else{if(aS(a6)){a6={url:a6};}}a6=a6||{};a6.cfg=a6.cfg||{};a6.cfg.on=a6.cfg.on||{};var a5={start:ai.bind(A.ioStartHandler,A),complete:ai.bind(A.ioCompleteHandler,A),success:ai.bind(A.ioSuccessHandler,A),failure:ai.bind(A.ioFailureHandler,A)};ai.each(a5,function(a9,a7){var ba=a6.cfg.on[a7];if(aD(ba)){var a8=function(){a9.apply(A,arguments);ba.apply(A,arguments);};a6.cfg.on[a7]=ai.bind(a8,A);}else{a6.cfg.on[a7]=a9;}});return a6;},_syncPaginatorIOData:function(a7){var A=this;var a6=A.get(an);if(a6&&aj(a6.limit)){var a5=a7.cfg.data||{};a5[a6.limitParam]=a6.limit;a5[a6.startParam]=a6.start;a5[a6.endParam]=(a6.start+a6.limit);a7.cfg.data=a5;}},_syncPaginatorUI:function(a7){var bb=this;var a5=bb.get(h);var bc=bb.get(an);if(bc){var ba=true;if(a7){ba=(a7.length>0);}var a6=bb.getChildrenLength();var A=bc.start;var a9=bc.total||a6;var bd=ba&&(a9>a6);if(bc.alwaysVisible||bd){bb.get(a).append(bc.element.show());if(bc.autoFocus){try{bc.element.focus();}catch(a8){}}}else{bc.element.hide();}}}}});ai.TreeNodeIO=Q;var m="checkbox",q="checked",af="checkContainerEl",aP="checkEl",S="checkName",ac=".",n="name",F="tree-node-check",am=K(i,s,m),au=K(i,s,m,a),aw=K(i,s,q),V='<div class="'+au+'"></div>',ar='<input class="'+am+'" type="checkbox" />';var aL=ai.Component.create({NAME:F,ATTRS:{checked:{value:false,validator:aI},checkName:{value:F,validator:aS},checkContainerEl:{setter:ai.one,valueFn:function(){return ai.Node.create(V);}},checkEl:{setter:ai.one,valueFn:function(){var A=this.get(S);return ai.Node.create(ar).attr(n,A);}}},EXTENDS:ai.TreeNodeIO,prototype:{initializer:function(){var A=this;A._uiSetChecked(A.get(q));},renderUI:function(){var a5=this;ai.TreeNodeCheck.superclass.renderUI.apply(a5,arguments);var a6=a5.get(ab);var A=a5.get(aP);var a7=a5.get(af);A.hide();a7.append(A);a6.placeBefore(a7);if(a5.isChecked()){a5.check();}},bindUI:function(){var A=this;var a5=A.get(x);var a6=A.get(ab);ai.TreeNodeCheck.superclass.bindUI.apply(A,arguments);A.after("checkedChange",ai.bind(A._afterCheckedChange,A));a5.delegate("click",ai.bind(A.toggleCheck,A),ac+au);a5.delegate("click",ai.bind(A.toggleCheck,A),ac+l);a6.swallowEvent("dblclick");},check:function(a5){var A=this;A.set(q,true,{originalTarget:a5});},uncheck:function(a5){var A=this;A.set(q,false,{originalTarget:a5});},toggleCheck:function(){var a5=this;var A=a5.get(aP);var a6=A.attr(q);if(!a6){a5.check();}else{a5.uncheck();}},isChecked:function(){var A=this;return A.get(q);},_afterCheckedChange:function(a5){var A=this;A._uiSetChecked(a5.newVal);},_uiSetChecked:function(a5){var A=this;if(a5){A.get(x).addClass(aw);A.get(aP).attr(q,q);}else{A.get(x).removeClass(aw);A.get(aP).attr(q,T);}}}});ai.TreeNodeCheck=aL;var G="child",U="tree-node-task",P="unchecked",aQ=function(A){return A instanceof ai.TreeNodeCheck;},ak=K(i,s,G,P);var a4=ai.Component.create({NAME:U,EXTENDS:ai.TreeNodeCheck,prototype:{check:function(a6){var A=this;var a5=A.get(x);a6=a6||A;if(!A.isLeaf()){A.eachChildren(function(a7){if(aQ(a7)){a7.check(a6);}});}A.eachParent(function(a7){if(aQ(a7)&&!a7.isChecked()){a7.get(x).addClass(ak);}});a5.removeClass(ak);ai.TreeNodeTask.superclass.check.call(this,a6);},uncheck:function(a6){var A=this;var a5=A.get(x);a6=a6||A;if(!A.isLeaf()){A.eachChildren(function(a7){if(a7 instanceof ai.TreeNodeCheck){a7.uncheck(a6);
}});}A.eachParent(function(a7){if(aQ(a7)&&!a7.isChecked()){a7.get(x).removeClass(ak);}});a5.removeClass(ak);ai.TreeNodeTask.superclass.uncheck.call(this,a6);}}});ai.TreeNodeTask=a4;var H="tree-node-radio",p=function(A){return A instanceof ai.TreeNodeRadio;},B=K(i,s,aE),Z=K(i,s,aE,q);var aV=ai.Component.create({NAME:H,EXTENDS:ai.TreeNodeTask,prototype:{renderUI:function(){var A=this;ai.TreeNodeRadio.superclass.renderUI.apply(A,arguments);A.get(x).addClass(B);},check:function(){var A=this;A._uncheckNodesRadio();ai.TreeNodeRadio.superclass.check.apply(this,arguments);},_uiSetChecked:function(a5){var A=this;if(a5){A.get(x).addClass(Z);A.get(aP).attr(q,q);}else{A.get(x).removeClass(Z);A.get(aP).attr(q,T);}},_uncheckNodesRadio:function(a7){var A=this;var a6;if(a7){a6=a7.get(h);}else{var a5=A.get(ad);if(a5){a6=a5.get(h);}else{return;}}ai.Array.each(a6,function(a9,a8,ba){if(!a9.isLeaf()){A._uncheckNodesRadio(a9);}if(p(a9)){a9.uncheck();}});}}});ai.TreeNodeRadio=aV;ai.TreeNode.nodeTypes={radio:ai.TreeNodeRadio,task:ai.TreeNodeTask,check:ai.TreeNodeCheck,node:ai.TreeNode,io:ai.TreeNodeIO};},"@VERSION@",{skinnable:false,requires:["aui-tree-data","aui-io","json","querystring-stringify"]});