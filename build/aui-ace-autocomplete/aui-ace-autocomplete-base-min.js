AUI.add("aui-ace-autocomplete-base",function(c){var g=c.Lang,b=c.Array,h=c.Do,m=c.DOM,a="insertText",d="exec",k="host",f="processor",j=-1,i=0,l="ace-autocomplete-base";var e=function(){};e.prototype={initializer:function(){var n=this;n._editorCommands=[];c.after(this._bindUIACBase,this,"renderUI");var o=n.get(f);if(o&&!o.get(k)){o.set(k,n);}},_addSuggestion:function(p){var n=this;var o=n._getEditor();var q=n.get(f).getSuggestion(n._matchParams.match,p);o.insert(q);o.focus();n.fire("addSuggestion",q);return new h.Halt(null);},_bindUIACBase:function(){var n=this;n.publish("cursorChange",{defaultFn:n._defaultCursorChangeFn});var o=n._getEditor();o.on("change",c.bind(n._onEditorChange,n));o.commands.addCommand({name:"showAutoComplete",bindKey:c.merge(n.get("showListKey"),{sender:"editor|cli"}),exec:function(r,q,s){var p=o.getCursorPosition();n._processAutoComplete(p.row,p.column);}});o.getSelection().on("changeCursor",c.bind(n._onEditorChangeCursor,n));n.on("destroy",n._destroyUIACBase,n);},_defaultCursorChangeFn:function(n){var t=this;var q=t._getEditor();var o=q.getCursorPosition();var u=o.row;var p=o.column;var r=t._matchParams;if(u!==r.row||p<r.match.start){t.fire("cursorOut");}else{var v=q.getSession().getLine(u);var s=v.substring(r.match.start,p);if(!t.get(f).getMatch(s)){t.fire("match");}}},_destroyUIACBase:function(){var n=this;n._removeAutoCompleteCommands();},_getEditor:function(){var n=this;return n.get("host").getEditor();},_handleEnter:function(p){var n=this;if(p==="\n"||p==="\t"){var o=n._getSelectedEntry();return n._addSuggestion(o);}},_onEditorChange:function(s){var n=this;var t=s.data;var u=t.action;if(u===a||u==="removeText"){var q=t.range;var r=q.start.column;var p=q.end.row;var o=q.start.row;if(u===a&&o===p){n._processAutoComplete(o,r+1);}n.fire(u,{column:r,dataRange:q,endRow:p,startRow:o});}},_onEditorChangeCursor:function(o){var n=this;n.fire("cursorChange",n._getEditor().getCursorPosition());},_onResultsError:function(o){var n=this;n.fire("resultsError",o);},_onResultsSuccess:function(o){var n=this;n.set("results",o);},_overwriteCommands:function(){var o=this;var p=o._getEditor();var n=p.commands.commands;o._editorCommands.push(h.before(o._handleEnter,p,"onTextInput",this),h.before(o._handleKey,n["golinedown"],d,this,40),h.before(o._handleKey,n["golineup"],d,this,38),h.before(o._handleKey,n["gotoend"],d,this,35),h.before(o._handleKey,n["gotolineend"],d,this,35),h.before(o._handleKey,n["gotolinestart"],d,this,36),h.before(o._handleKey,n["gotopagedown"],d,this,34),h.before(o._handleKey,n["gotopageup"],d,this,33),h.before(o._handleKey,n["gotostart"],d,this,36));},_processAutoComplete:function(u,p){var t=this;var o=p;var r=t._getEditor();var v=r.getSession().getLine(u);v=v.substring(0,p);var n=t.get(f);var q=n.getMatch(v);var s;if(g.isObject(q)){s=r.renderer.textToScreenCoordinates(u,p);s.pageX+=m.docScrollX();s.pageY+=m.docScrollY();t._matchParams={column:p,match:q,row:u};n.getResults(q,c.bind(t._onResultsSuccess,t),c.bind(t._onResultsError,t));}t.fire("match",{column:p,coords:s,line:v,match:q,row:u});},_removeAutoCompleteCommands:function(){var n=this;b.invoke(n._editorCommands,"detach");n._editorCommands.length=0;}};e.NAME=l;e.NS=l;e.ATTRS={processor:{validator:function(n){return g.isObject(n)||g.isFunction(n);}},showListKey:{validator:g.isObject,value:{mac:"Alt-Space",win:"Ctrl-Space"}}};c.AceEditor.AutoCompleteBase=e;},"@VERSION@",{requires:["aui-ace-editor"]});