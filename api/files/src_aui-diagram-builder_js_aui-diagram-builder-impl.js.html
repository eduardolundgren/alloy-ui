<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <title>src/aui-diagram-builder/js/aui-diagram-builder-impl.js - AlloyUI - API Docs</title>

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.ico">

    <!-- CSS -->
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">

    <!-- AlloyUI -->
    <link rel="stylesheet" href="http://cdn.alloyui.com/2.0.x/aui-css/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://cdn.alloyui.com/2.0.x/aui-css/css/bootstrap-responsive.min.css">
    <script src="http://cdn.alloyui.com/2.0.x/aui/aui-min.js"></script>

</head>
<body class="yui3-skin-sam">

    <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
            <h1 class="brand">
                <a href="/">
                    <img alt="AlloyUI - API Docs" src="../assets/img/logo.png" style="max-width: 70%;" title="AlloyUI - API Docs">
                </a>
            </h1>
            <div class="nav">
                <li class="divider-vertical"></li>
                <li>
                    <p class="navbar-text">
                        API Docs for Version: <b>2.0.0pr5</b>
                    </p>
                </li>
            </div>
        </div>
    </div>

    <div id="bd" class="container">
        <div class="row">
            <div class="span3">
                <div id="docs-sidebar" class="sidebar apidocs">
                    <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview">
        <ul class="nav nav-tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes tab-pane">
            
                <li><a href="../classes/A.AceEditor.html">A.AceEditor</a></li>
            
                <li><a href="../classes/A.Aria.html">A.Aria</a></li>
            
                <li><a href="../classes/A.ArraySort.html">A.ArraySort</a></li>
            
                <li><a href="../classes/A.Audio.html">A.Audio</a></li>
            
                <li><a href="../classes/A.AutoCompleteBase.html">A.AutoCompleteBase</a></li>
            
                <li><a href="../classes/A.AutoCompleteList.html">A.AutoCompleteList</a></li>
            
                <li><a href="../classes/A.AutosizeIframe.html">A.AutosizeIframe</a></li>
            
                <li><a href="../classes/A.AvailableField.html">A.AvailableField</a></li>
            
                <li><a href="../classes/A.BaseCellEditor.html">A.BaseCellEditor</a></li>
            
                <li><a href="../classes/A.BaseOptionsCellEditor.html">A.BaseOptionsCellEditor</a></li>
            
                <li><a href="../classes/A.Button.html">A.Button</a></li>
            
                <li><a href="../classes/A.ButtonCore.html">A.ButtonCore</a></li>
            
                <li><a href="../classes/A.ButtonGroup.html">A.ButtonGroup</a></li>
            
                <li><a href="../classes/A.Carousel.html">A.Carousel</a></li>
            
                <li><a href="../classes/A.CellEditorSupport.html">A.CellEditorSupport</a></li>
            
                <li><a href="../classes/A.CharCounter.html">A.CharCounter</a></li>
            
                <li><a href="../classes/A.CheckboxCellEditor.html">A.CheckboxCellEditor</a></li>
            
                <li><a href="../classes/A.ColorPalette.html">A.ColorPalette</a></li>
            
                <li><a href="../classes/A.ColorPickerBase.html">A.ColorPickerBase</a></li>
            
                <li><a href="../classes/A.ColorPickerPopover.html">A.ColorPickerPopover</a></li>
            
                <li><a href="../classes/A.Component.html">A.Component</a></li>
            
                <li><a href="../classes/A.Connector.html">A.Connector</a></li>
            
                <li><a href="../classes/A.DataTableHighlight.html">A.DataTableHighlight</a></li>
            
                <li><a href="../classes/A.DataTableSelection.html">A.DataTableSelection</a></li>
            
                <li><a href="../classes/A.DataType.DateMath.html">A.DataType.DateMath</a></li>
            
                <li><a href="../classes/A.DateCellEditor.html">A.DateCellEditor</a></li>
            
                <li><a href="../classes/A.DiagramBuilder.html">A.DiagramBuilder</a></li>
            
                <li><a href="../classes/A.DiagramBuilderBase.html">A.DiagramBuilderBase</a></li>
            
                <li><a href="../classes/A.DiagramNode.html">A.DiagramNode</a></li>
            
                <li><a href="../classes/A.DiagramNodeCondition.html">A.DiagramNodeCondition</a></li>
            
                <li><a href="../classes/A.DiagramNodeEnd.html">A.DiagramNodeEnd</a></li>
            
                <li><a href="../classes/A.DiagramNodeFork.html">A.DiagramNodeFork</a></li>
            
                <li><a href="../classes/A.DiagramNodeJoin.html">A.DiagramNodeJoin</a></li>
            
                <li><a href="../classes/A.DiagramNodeManagerBase.html">A.DiagramNodeManagerBase</a></li>
            
                <li><a href="../classes/A.DiagramNodeStart.html">A.DiagramNodeStart</a></li>
            
                <li><a href="../classes/A.DiagramNodeState.html">A.DiagramNodeState</a></li>
            
                <li><a href="../classes/A.DiagramNodeTask.html">A.DiagramNodeTask</a></li>
            
                <li><a href="../classes/A.DropDownCellEditor.html">A.DropDownCellEditor</a></li>
            
                <li><a href="../classes/A.FieldSupport.html">A.FieldSupport</a></li>
            
                <li><a href="../classes/A.FormBuilder.html">A.FormBuilder</a></li>
            
                <li><a href="../classes/A.FormBuilderAvailableField.html">A.FormBuilderAvailableField</a></li>
            
                <li><a href="../classes/A.FormBuilderButtonField.html">A.FormBuilderButtonField</a></li>
            
                <li><a href="../classes/A.FormBuilderCheckBoxField.html">A.FormBuilderCheckBoxField</a></li>
            
                <li><a href="../classes/A.FormBuilderField.html">A.FormBuilderField</a></li>
            
                <li><a href="../classes/A.FormBuilderFieldBase.html">A.FormBuilderFieldBase</a></li>
            
                <li><a href="../classes/A.FormBuilderFieldsetField.html">A.FormBuilderFieldsetField</a></li>
            
                <li><a href="../classes/A.FormBuilderFileUploadField.html">A.FormBuilderFileUploadField</a></li>
            
                <li><a href="../classes/A.FormBuilderMultipleChoiceField.html">A.FormBuilderMultipleChoiceField</a></li>
            
                <li><a href="../classes/A.FormBuilderRadioField.html">A.FormBuilderRadioField</a></li>
            
                <li><a href="../classes/A.FormBuilderSelectField.html">A.FormBuilderSelectField</a></li>
            
                <li><a href="../classes/A.FormBuilderTextAreaField.html">A.FormBuilderTextAreaField</a></li>
            
                <li><a href="../classes/A.FormBuilderTextField.html">A.FormBuilderTextField</a></li>
            
                <li><a href="../classes/A.FormValidator.html">A.FormValidator</a></li>
            
                <li><a href="../classes/A.Freemarker.html">A.Freemarker</a></li>
            
                <li><a href="../classes/A.HashMap.html">A.HashMap</a></li>
            
                <li><a href="../classes/A.HashSet.html">A.HashSet</a></li>
            
                <li><a href="../classes/A.HSVAPalette.html">A.HSVAPalette</a></li>
            
                <li><a href="../classes/A.HSVAPaletteModal.html">A.HSVAPaletteModal</a></li>
            
                <li><a href="../classes/A.HSVPalette.html">A.HSVPalette</a></li>
            
                <li><a href="../classes/A.HTML5.html">A.HTML5</a></li>
            
                <li><a href="../classes/A.ImageCropper.html">A.ImageCropper</a></li>
            
                <li><a href="../classes/A.ImageGallery.html">A.ImageGallery</a></li>
            
                <li><a href="../classes/A.ImageViewer.html">A.ImageViewer</a></li>
            
                <li><a href="../classes/A.io.html">A.io</a></li>
            
                <li><a href="../classes/A.IORequest.html">A.IORequest</a></li>
            
                <li><a href="../classes/A.LinkedSet.html">A.LinkedSet</a></li>
            
                <li><a href="../classes/A.MediaViewerPlugin.html">A.MediaViewerPlugin</a></li>
            
                <li><a href="../classes/A.Modal.html">A.Modal</a></li>
            
                <li><a href="../classes/A.Node.html">A.Node</a></li>
            
                <li><a href="../classes/A.NodeList.html">A.NodeList</a></li>
            
                <li><a href="../classes/A.OptionsEditor.html">A.OptionsEditor</a></li>
            
                <li><a href="../classes/A.Pagination.html">A.Pagination</a></li>
            
                <li><a href="../classes/A.Palette.html">A.Palette</a></li>
            
                <li><a href="../classes/A.ParseContent.html">A.ParseContent</a></li>
            
                <li><a href="../classes/A.ProgressBar.html">A.ProgressBar</a></li>
            
                <li><a href="../classes/A.PropertyList.html">A.PropertyList</a></li>
            
                <li><a href="../classes/A.RadioCellEditor.html">A.RadioCellEditor</a></li>
            
                <li><a href="../classes/A.Rating.html">A.Rating</a></li>
            
                <li><a href="../classes/A.SchedulerAgendaView.html">A.SchedulerAgendaView</a></li>
            
                <li><a href="../classes/A.SchedulerBase.html">A.SchedulerBase</a></li>
            
                <li><a href="../classes/A.SchedulerCalendar.html">A.SchedulerCalendar</a></li>
            
                <li><a href="../classes/A.SchedulerDayView.html">A.SchedulerDayView</a></li>
            
                <li><a href="../classes/A.SchedulerEvent.html">A.SchedulerEvent</a></li>
            
                <li><a href="../classes/A.SchedulerEventRecorder.html">A.SchedulerEventRecorder</a></li>
            
                <li><a href="../classes/A.SchedulerEvents.html">A.SchedulerEvents</a></li>
            
                <li><a href="../classes/A.SchedulerEventSupport.html">A.SchedulerEventSupport</a></li>
            
                <li><a href="../classes/A.SchedulerMonthView.html">A.SchedulerMonthView</a></li>
            
                <li><a href="../classes/A.SchedulerTableView.html">A.SchedulerTableView</a></li>
            
                <li><a href="../classes/A.SchedulerTableViewDD.html">A.SchedulerTableViewDD</a></li>
            
                <li><a href="../classes/A.SchedulerView.html">A.SchedulerView</a></li>
            
                <li><a href="../classes/A.SchedulerWeekView.html">A.SchedulerWeekView</a></li>
            
                <li><a href="../classes/A.Selector.html">A.Selector</a></li>
            
                <li><a href="../classes/A.SortableLayout.html">A.SortableLayout</a></li>
            
                <li><a href="../classes/A.SortableList.html">A.SortableList</a></li>
            
                <li><a href="../classes/A.Tab.html">A.Tab</a></li>
            
                <li><a href="../classes/A.TabView.html">A.TabView</a></li>
            
                <li><a href="../classes/A.TemplateProcessor.html">A.TemplateProcessor</a></li>
            
                <li><a href="../classes/A.TernarySearchNode.html">A.TernarySearchNode</a></li>
            
                <li><a href="../classes/A.TernarySearchTree.html">A.TernarySearchTree</a></li>
            
                <li><a href="../classes/A.TextAreaCellEditor.html">A.TextAreaCellEditor</a></li>
            
                <li><a href="../classes/A.TextCellEditor.html">A.TextCellEditor</a></li>
            
                <li><a href="../classes/A.ThumbRating.html">A.ThumbRating</a></li>
            
                <li><a href="../classes/A.ToggleButton.html">A.ToggleButton</a></li>
            
                <li><a href="../classes/A.Toggler.html">A.Toggler</a></li>
            
                <li><a href="../classes/A.TogglerDelegate.html">A.TogglerDelegate</a></li>
            
                <li><a href="../classes/A.Toolbar.html">A.Toolbar</a></li>
            
                <li><a href="../classes/A.ToolbarRenderer.html">A.ToolbarRenderer</a></li>
            
                <li><a href="../classes/A.TooltipDelegate.html">A.TooltipDelegate</a></li>
            
                <li><a href="../classes/A.TreeData.html">A.TreeData</a></li>
            
                <li><a href="../classes/A.TreeNode.html">A.TreeNode</a></li>
            
                <li><a href="../classes/A.TreeNodeCheck.html">A.TreeNodeCheck</a></li>
            
                <li><a href="../classes/A.TreeNodeIO.html">A.TreeNodeIO</a></li>
            
                <li><a href="../classes/A.TreeNodeRadio.html">A.TreeNodeRadio</a></li>
            
                <li><a href="../classes/A.TreeNodeTask.html">A.TreeNodeTask</a></li>
            
                <li><a href="../classes/A.TreeView.html">A.TreeView</a></li>
            
                <li><a href="../classes/A.TreeViewDD.html">A.TreeViewDD</a></li>
            
                <li><a href="../classes/A.TreeViewIO.html">A.TreeViewIO</a></li>
            
                <li><a href="../classes/A.TreeViewPaginator.html">A.TreeViewPaginator</a></li>
            
                <li><a href="../classes/A.Url.html">A.Url</a></li>
            
                <li><a href="../classes/A.Velocity.html">A.Velocity</a></li>
            
                <li><a href="../classes/A.Video.html">A.Video</a></li>
            
                <li><a href="../classes/A.WidgetCssClass.html">A.WidgetCssClass</a></li>
            
                <li><a href="../classes/A.WidgetPositionAlignSuggestion.html">A.WidgetPositionAlignSuggestion</a></li>
            
                <li><a href="../classes/A.WidgetToggle.html">A.WidgetToggle</a></li>
            
                <li><a href="../classes/A.WidgetTrigger.html">A.WidgetTrigger</a></li>
            
                <li><a href="../classes/ButtonExt.html">ButtonExt</a></li>
            
                <li><a href="../classes/DataType.Boolean.html">DataType.Boolean</a></li>
            
                <li><a href="../classes/DataType.Date.Locale.html">DataType.Date.Locale</a></li>
            
                <li><a href="../classes/DataType.String.html">DataType.String</a></li>
            
                <li><a href="../classes/Node.html">Node</a></li>
            
                <li><a href="../classes/Popover.html">Popover</a></li>
            
                <li><a href="../classes/Tooltip.html">Tooltip</a></li>
            
                <li><a href="../classes/TreeNode.html">TreeNode</a></li>
            
                <li><a href="../classes/WidgetToolbars.html">WidgetToolbars</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules tab-pane">
            
                <li><a href="../modules/aui-ace-autocomplete-base.html">aui-ace-autocomplete-base</a></li>
            
                <li><a href="../modules/aui-ace-autocomplete-freemarker.html">aui-ace-autocomplete-freemarker</a></li>
            
                <li><a href="../modules/aui-ace-autocomplete-list.html">aui-ace-autocomplete-list</a></li>
            
                <li><a href="../modules/aui-ace-autocomplete-templateprocessor.html">aui-ace-autocomplete-templateprocessor</a></li>
            
                <li><a href="../modules/aui-ace-autocomplete-velocity.html">aui-ace-autocomplete-velocity</a></li>
            
                <li><a href="../modules/aui-ace-editor.html">aui-ace-editor</a></li>
            
                <li><a href="../modules/aui-aria.html">aui-aria</a></li>
            
                <li><a href="../modules/aui-arraysort.html">aui-arraysort</a></li>
            
                <li><a href="../modules/aui-audio.html">aui-audio</a></li>
            
                <li><a href="../modules/aui-autosize-iframe.html">aui-autosize-iframe</a></li>
            
                <li><a href="../modules/aui-button.html">aui-button</a></li>
            
                <li><a href="../modules/aui-carousel.html">aui-carousel</a></li>
            
                <li><a href="../modules/aui-char-counter.html">aui-char-counter</a></li>
            
                <li><a href="../modules/aui-collection.html">aui-collection</a></li>
            
                <li><a href="../modules/aui-color-pallete.html">aui-color-pallete</a></li>
            
                <li><a href="../modules/aui-color-picker.html">aui-color-picker</a></li>
            
                <li><a href="../modules/aui-color-picker-base.html">aui-color-picker-base</a></li>
            
                <li><a href="../modules/aui-color-picker-popover.html">aui-color-picker-popover</a></li>
            
                <li><a href="../modules/aui-component.html">aui-component</a></li>
            
                <li><a href="../modules/aui-datatable.html">aui-datatable</a></li>
            
                <li><a href="../modules/aui-datatable-edit.html">aui-datatable-edit</a></li>
            
                <li><a href="../modules/aui-datatable-highlight.html">aui-datatable-highlight</a></li>
            
                <li><a href="../modules/aui-datatable-property-list.html">aui-datatable-property-list</a></li>
            
                <li><a href="../modules/aui-datatable-selection.html">aui-datatable-selection</a></li>
            
                <li><a href="../modules/aui-datatype.html">aui-datatype</a></li>
            
                <li><a href="../modules/aui-diagram-builder.html">aui-diagram-builder</a></li>
            
                <li><a href="../modules/aui-diagram-builder-base.html">aui-diagram-builder-base</a></li>
            
                <li><a href="../modules/aui-diagram-builder-connector.html">aui-diagram-builder-connector</a></li>
            
                <li><a href="../modules/aui-diagram-builder-impl.html">aui-diagram-builder-impl</a></li>
            
                <li><a href="../modules/aui-event.html">aui-event</a></li>
            
                <li><a href="../modules/aui-event-base.html">aui-event-base</a></li>
            
                <li><a href="../modules/aui-event-delegate-change.html">aui-event-delegate-change</a></li>
            
                <li><a href="../modules/aui-event-delegate-submit.html">aui-event-delegate-submit</a></li>
            
                <li><a href="../modules/aui-event-input.html">aui-event-input</a></li>
            
                <li><a href="../modules/aui-form-builder.html">aui-form-builder</a></li>
            
                <li><a href="../modules/aui-form-builder-base.html">aui-form-builder-base</a></li>
            
                <li><a href="../modules/aui-form-builder-field-base.html">aui-form-builder-field-base</a></li>
            
                <li><a href="../modules/aui-form-builder-field-button.html">aui-form-builder-field-button</a></li>
            
                <li><a href="../modules/aui-form-builder-field-checkbox.html">aui-form-builder-field-checkbox</a></li>
            
                <li><a href="../modules/aui-form-builder-field-fieldset.html">aui-form-builder-field-fieldset</a></li>
            
                <li><a href="../modules/aui-form-builder-field-multiple-choice.html">aui-form-builder-field-multiple-choice</a></li>
            
                <li><a href="../modules/aui-form-builder-field-radio.html">aui-form-builder-field-radio</a></li>
            
                <li><a href="../modules/aui-form-builder-field-select.html">aui-form-builder-field-select</a></li>
            
                <li><a href="../modules/aui-form-builder-field-text.html">aui-form-builder-field-text</a></li>
            
                <li><a href="../modules/aui-form-builder-field-textarea.html">aui-form-builder-field-textarea</a></li>
            
                <li><a href="../modules/aui-form-builder-field-upload.html">aui-form-builder-field-upload</a></li>
            
                <li><a href="../modules/aui-form-validator.html">aui-form-validator</a></li>
            
                <li><a href="../modules/aui-hsv-palette.html">aui-hsv-palette</a></li>
            
                <li><a href="../modules/aui-hsv-palette-modal.html">aui-hsv-palette-modal</a></li>
            
                <li><a href="../modules/aui-hsva-palette.html">aui-hsva-palette</a></li>
            
                <li><a href="../modules/aui-image-cropper.html">aui-image-cropper</a></li>
            
                <li><a href="../modules/aui-image-viewer.html">aui-image-viewer</a></li>
            
                <li><a href="../modules/aui-image-viewer-base.html">aui-image-viewer-base</a></li>
            
                <li><a href="../modules/aui-image-viewer-gallery.html">aui-image-viewer-gallery</a></li>
            
                <li><a href="../modules/aui-io.html">aui-io</a></li>
            
                <li><a href="../modules/aui-io-request.html">aui-io-request</a></li>
            
                <li><a href="../modules/aui-linkedset.html">aui-linkedset</a></li>
            
                <li><a href="../modules/aui-map.html">aui-map</a></li>
            
                <li><a href="../modules/aui-media-viewer-plugin.html">aui-media-viewer-plugin</a></li>
            
                <li><a href="../modules/aui-modal.html">aui-modal</a></li>
            
                <li><a href="../modules/aui-node.html">aui-node</a></li>
            
                <li><a href="../modules/aui-node-base.html">aui-node-base</a></li>
            
                <li><a href="../modules/aui-node-html5.html">aui-node-html5</a></li>
            
                <li><a href="../modules/aui-node-html5-print.html">aui-node-html5-print</a></li>
            
                <li><a href="../modules/aui-pagination.html">aui-pagination</a></li>
            
                <li><a href="../modules/aui-pallete.html">aui-pallete</a></li>
            
                <li><a href="../modules/aui-parse-content.html">aui-parse-content</a></li>
            
                <li><a href="../modules/aui-popover.html">aui-popover</a></li>
            
                <li><a href="../modules/aui-progressbar.html">aui-progressbar</a></li>
            
                <li><a href="../modules/aui-rating.html">aui-rating</a></li>
            
                <li><a href="../modules/aui-scheduler.html">aui-scheduler</a></li>
            
                <li><a href="../modules/aui-scheduler-base.html">aui-scheduler-base</a></li>
            
                <li><a href="../modules/aui-scheduler-base-calendar.html">aui-scheduler-base-calendar</a></li>
            
                <li><a href="../modules/aui-scheduler-base-event.html">aui-scheduler-base-event</a></li>
            
                <li><a href="../modules/aui-scheduler-base-view.html">aui-scheduler-base-view</a></li>
            
                <li><a href="../modules/aui-scheduler-event-recorder.html">aui-scheduler-event-recorder</a></li>
            
                <li><a href="../modules/aui-scheduler-view-agenda.html">aui-scheduler-view-agenda</a></li>
            
                <li><a href="../modules/aui-scheduler-view-day.html">aui-scheduler-view-day</a></li>
            
                <li><a href="../modules/aui-scheduler-view-month.html">aui-scheduler-view-month</a></li>
            
                <li><a href="../modules/aui-scheduler-view-table.html">aui-scheduler-view-table</a></li>
            
                <li><a href="../modules/aui-scheduler-view-table-dd.html">aui-scheduler-view-table-dd</a></li>
            
                <li><a href="../modules/aui-scheduler-view-week.html">aui-scheduler-view-week</a></li>
            
                <li><a href="../modules/aui-search.html">aui-search</a></li>
            
                <li><a href="../modules/aui-search-ternary-search-node.html">aui-search-ternary-search-node</a></li>
            
                <li><a href="../modules/aui-search-ternary-search-tree.html">aui-search-ternary-search-tree</a></li>
            
                <li><a href="../modules/aui-selector.html">aui-selector</a></li>
            
                <li><a href="../modules/aui-set.html">aui-set</a></li>
            
                <li><a href="../modules/aui-sortable-layout.html">aui-sortable-layout</a></li>
            
                <li><a href="../modules/aui-sortable-list.html">aui-sortable-list</a></li>
            
                <li><a href="../modules/aui-tabview.html">aui-tabview</a></li>
            
                <li><a href="../modules/aui-text.html">aui-text</a></li>
            
                <li><a href="../modules/aui-timer.html">aui-timer</a></li>
            
                <li><a href="../modules/aui-toggler.html">aui-toggler</a></li>
            
                <li><a href="../modules/aui-toolbar.html">aui-toolbar</a></li>
            
                <li><a href="../modules/aui-tooltip.html">aui-tooltip</a></li>
            
                <li><a href="../modules/aui-tree.html">aui-tree</a></li>
            
                <li><a href="../modules/aui-tree-data.html">aui-tree-data</a></li>
            
                <li><a href="../modules/aui-tree-io.html">aui-tree-io</a></li>
            
                <li><a href="../modules/aui-tree-node.html">aui-tree-node</a></li>
            
                <li><a href="../modules/aui-tree-paginator.html">aui-tree-paginator</a></li>
            
                <li><a href="../modules/aui-tree-view.html">aui-tree-view</a></li>
            
                <li><a href="../modules/aui-url.html">aui-url</a></li>
            
                <li><a href="../modules/aui-video.html">aui-video</a></li>
            
                <li><a href="../modules/aui-widget-cssclass.html">aui-widget-cssclass</a></li>
            
                <li><a href="../modules/aui-widget-toggle.html">aui-widget-toggle</a></li>
            
                <li><a href="../modules/aui-widget-toolbars.html">aui-widget-toolbars</a></li>
            
                <li><a href="../modules/datatype.html">datatype</a></li>
            
                <li><a href="../modules/loader.html">loader</a></li>
            
                <li><a href="../modules/loader-yui3.html">loader-yui3</a></li>
            
            </ul>
        </div>
    </div>
</div>

                </div>
            </div>
            <div class="span9">
                    <div id="api-options" class="form-inline pull-right">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


                <div class="apidocs">
                    <div id="docs-main">
                        <div class="content">
                            <div class="page-header">
  <h1><small>File</small> <code>src/aui-diagram-builder/js/aui-diagram-builder-impl.js</code></h1>
</div>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * The Diagram Builder Component
 *
 * @module aui-diagram-builder
 * @submodule aui-diagram-builder-impl
 */

var Lang = A.Lang,
	isArray = Lang.isArray,
	isBoolean = Lang.isBoolean,
	isObject = Lang.isObject,
	isString = Lang.isString,

	WidgetStdMod = A.WidgetStdMod,
	AArray = A.Array,

	ACTIVE_ELEMENT = &#x27;activeElement&#x27;,
	ATTRIBUTE_NAME = &#x27;attributeName&#x27;,
	AVAILABLE_FIELD = &#x27;availableField&#x27;,
	AVAILABLE_FIELDS = &#x27;availableFields&#x27;,
	BACKSPACE = &#x27;backspace&#x27;,
	BOOLEAN = &#x27;boolean&#x27;,
	BOUNDARY = &#x27;boundary&#x27;,
	BOUNDING_BOX = &#x27;boundingBox&#x27;,
	BUILDER = &#x27;builder&#x27;,
	CANVAS = &#x27;canvas&#x27;,
	CLICK = &#x27;click&#x27;,
	CONDITION = &#x27;condition&#x27;,
	CONNECTOR = &#x27;connector&#x27;,
	CONNECTORS = &#x27;connectors&#x27;,
	CONTENT = &#x27;content&#x27;,
	CONTROLS = &#x27;controls&#x27;,
	CONTROLS_TOOLBAR = &#x27;controlsToolbar&#x27;,
	CREATE_DOCUMENT_FRAGMENT = &#x27;createDocumentFragment&#x27;,
	DATA = &#x27;data&#x27;,
	DATA_NODE_ID = &#x27;data-nodeId&#x27;,
	DELETE = &#x27;delete&#x27;,
	DELETE_CONNECTORS_MESSAGE = &#x27;deleteConnectorsMessage&#x27;,
	DELETE_NODES_MESSAGE = &#x27;deleteNodesMessage&#x27;,
	DESCRIPTION = &#x27;description&#x27;,
	DIAGRAM = &#x27;diagram&#x27;,
	DIAGRAM_BUILDER_NAME = &#x27;diagram-builder&#x27;,
	DIAGRAM_NODE = &#x27;diagramNode&#x27;,
	DIAGRAM_NODE_MANAGER_NAME = &#x27;diagram-node-manager&#x27;,
	DIAGRAM_NODE_NAME = &#x27;diagram-node&#x27;,
	DRAG_NODE = &#x27;dragNode&#x27;,
	DRAGGING = &#x27;dragging&#x27;,
	EDITING = &#x27;editing&#x27;,
	END = &#x27;end&#x27;,
	ESC = &#x27;esc&#x27;,
	FIELD = &#x27;field&#x27;,
	FIELDS = &#x27;fields&#x27;,
	FIELDS_DRAG_CONFIG = &#x27;fieldsDragConfig&#x27;,
	FORK = &#x27;fork&#x27;,
	GRAPHIC = &#x27;graphic&#x27;,
	HEIGHT = &#x27;height&#x27;,
	HIGHLIGHT_BOUNDARY_STROKE = &#x27;highlightBoundaryStroke&#x27;,
	HIGHLIGHT_DROP_ZONES = &#x27;highlightDropZones&#x27;,
	HIGHLIGHTED = &#x27;highlighted&#x27;,
	ID = &#x27;id&#x27;,
	JOIN = &#x27;join&#x27;,
	KEYDOWN = &#x27;keydown&#x27;,
	LABEL = &#x27;label&#x27;,
	LOCK = &#x27;lock&#x27;,
	MOUSEENTER = &#x27;mouseenter&#x27;,
	MOUSELEAVE = &#x27;mouseleave&#x27;,
	NAME = &#x27;name&#x27;,
	NODE = &#x27;node&#x27;,
	P1 = &#x27;p1&#x27;,
	P2 = &#x27;p2&#x27;,
	PARENT_NODE = &#x27;parentNode&#x27;,
	RADIUS = &#x27;radius&#x27;,
	RENDERED = &#x27;rendered&#x27;,
	REQUIRED = &#x27;required&#x27;,
	SELECTED = &#x27;selected&#x27;,
	SHAPE = &#x27;shape&#x27;,
	SHAPE_BOUNDARY = &#x27;shapeBoundary&#x27;,
	SHAPE_INVITE = &#x27;shapeInvite&#x27;,
	SHOW_SUGGEST_CONNECTOR = &#x27;showSuggestConnector&#x27;,
	SOURCE = &#x27;source&#x27;,
	START = &#x27;start&#x27;,
	STATE = &#x27;state&#x27;,
	STROKE = &#x27;stroke&#x27;,
	SUGGEST = &#x27;suggest&#x27;,
	SUGGEST_CONNECTOR_OVERLAY = &#x27;suggestConnectorOverlay&#x27;,
	TARGET = &#x27;target&#x27;,
	TASK = &#x27;task&#x27;,
	TRANSITION = &#x27;transition&#x27;,
	TRANSITIONS = &#x27;transitions&#x27;,
	TYPE = &#x27;type&#x27;,
	VALUE = &#x27;value&#x27;,
	VISIBLE = &#x27;visible&#x27;,
	WIDTH = &#x27;width&#x27;,
	XY = &#x27;xy&#x27;,
	Z_INDEX = &#x27;zIndex&#x27;,

	_DASH = &#x27;-&#x27;,
	_DOT = &#x27;.&#x27;,
	_EMPTY_STR = &#x27;&#x27;,
	_UNDERLINE = &#x27;_&#x27;,

	AgetClassName = A.getClassName,

	CSS_DB_CONTROLS = AgetClassName(DIAGRAM, BUILDER, CONTROLS),
	CSS_DIAGRAM_BUILDER_FIELD = AgetClassName(DIAGRAM, BUILDER, FIELD),
	CSS_DIAGRAM_NODE = AgetClassName(DIAGRAM, NODE),
	CSS_DIAGRAM_NODE_CONTENT = AgetClassName(DIAGRAM, NODE, CONTENT),
	CSS_DIAGRAM_NODE_EDITING = AgetClassName(DIAGRAM, NODE, EDITING),
	CSS_DIAGRAM_NODE_LABEL = AgetClassName(DIAGRAM, NODE, LABEL),
	CSS_DIAGRAM_NODE_SELECTED = AgetClassName(DIAGRAM, NODE, SELECTED),
	CSS_DIAGRAM_NODE_SHAPE_BOUNDARY = AgetClassName(DIAGRAM, NODE, SHAPE, BOUNDARY),
	CSS_DIAGRAM_SUGGEST_CONNECTOR = AgetClassName(DIAGRAM, NODE, SUGGEST, CONNECTOR),

	adjustDiagramNodeOffset = function(diagramNode, offsetXY) {
		var dnXY = isArray(diagramNode) ? diagramNode : diagramNode.get(BOUNDING_BOX).getXY();

		return [ dnXY[0] + offsetXY[0], dnXY[1] + offsetXY[1] ];
	},

	pythagoreanDistance = function(p1, p2) {
		var dx = p2[0]-p1[0], dy = p2[1]-p1[1];

		return Math.sqrt(dx*dx + dy*dy);
	},

	findHotPointBestMatch = function(diagramNode1, diagramNode2) {
		var hp1 = diagramNode1.hotPoints,
			hp2 = diagramNode2.hotPoints,
			xy1 = diagramNode1.get(BOUNDING_BOX).getXY(),
			xy2 = diagramNode2.get(BOUNDING_BOX).getXY(), len1, len2, i, j, minDistance = Infinity, match = [[0,0], [0,0]];

		for (i = 0, len1 = hp1.length; i &lt; len1; i++) {
			var value1 = hp1[i],
				adjustedValue1 = adjustDiagramNodeOffset(xy1, value1);

			for (j = 0, len2 = hp2.length; j &lt; len2; j++) {
				var value2 = hp2[j],
					adjustedValue2 = adjustDiagramNodeOffset(xy2, value2),
					distance = pythagoreanDistance(adjustedValue2, adjustedValue1);

				if (distance &lt; minDistance) {
					match[0] = value1;
					match[1] = value2;
					minDistance = distance;
				}
			}
		}

		return match;
	},

	getLeftTop = function(container, node) {
		var nodeXY = isArray(node) ? node : node.getXY();
		var containerXY = isArray(container) ? container : container.getXY();

		return AArray.map(containerXY, function(val, i) {
			return Math.max(0, val - nodeXY[i]);
		});
	},

	isConnector = function(val) {
		return A.instanceOf(val, A.Connector);
	},

	isMap = function(val) {
		return A.instanceOf(val, A.Map);
	},

	isDiagramBuilder = function(val) {
		return A.instanceOf(val, A.DiagramBuilderBase);
	},

	isDiagramNode = function(val) {
		return A.instanceOf(val, A.DiagramNode);
	};

/**
 * A base class for Diagram Builder.
 *
 * Check the [live demo](http://alloyui.com/examples/diagram-builder/).
 *
 * @class A.DiagramBuilder
 * @extends A.DiagramBuilderBase
 * @param config {Object} Object literal specifying widget configuration properties.
 * @constructor
 */
var DiagramBuilder = A.Component.create({

	/**
	 * Static property provides a string to identify the class.
	 *
	 * @property DiagramBuilder.NAME
	 * @type String
	 * @static
	 */
	NAME: DIAGRAM_BUILDER_NAME,

	/**
	 * Static property used to define the default attribute
	 * configuration for the DiagramBuilder.
	 *
	 * @property DiagramBuilder.ATTRS
	 * @type Object
	 * @static
	 */
	ATTRS: {

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute connector
		 * @default null
		 */
		connector: {
			setter: &#x27;_setConnector&#x27;,
			value: null
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute fieldsDragConfig
		 * @default null
		 * @type Object
		 */
		fieldsDragConfig: {
			value: null,
			setter: &#x27;_setFieldsDragConfig&#x27;,
			validator: isObject
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute graphic
		 * @type Object
		 */
		graphic: {
			valueFn: function() {
				return new A.Graphic();
			},
			validator: isObject
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute highlightDropZones
		 * @default true
		 * @type Boolean
		 */
		highlightDropZones: {
			validator: isBoolean,
			value: true
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute strings
		 * @type Object
		 */
		strings: {
			value: {
				addNode: &#x27;Add node&#x27;,
				cancel: &#x27;Cancel&#x27;,
				close: &#x27;Close&#x27;,
				deleteConnectorsMessage: &#x27;Are you sure you want to delete the selected connector(s)?&#x27;,
				deleteNodesMessage: &#x27;Are you sure you want to delete the selected node(s)?&#x27;,
				propertyName: &#x27;Property Name&#x27;,
				save: &#x27;Save&#x27;,
				settings: &#x27;Settings&#x27;,
				value: &#x27;Value&#x27;
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute showSuggestConnector
		 * @default true
		 * @type Boolean
		 */
		showSuggestConnector: {
			validator: isBoolean,
			value: true
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute suggestConnectorOverlay
		 * @default null
		 */
		suggestConnectorOverlay: {
			value: null,
			setter: &#x27;_setSuggestConnectorOverlay&#x27;
		}
	},

	/**
	 * Static property used to define which component it extends.
	 *
	 * @property DiagramBuilder.EXTENDS
	 * @type String
	 * @static
	 */
	EXTENDS: A.DiagramBuilderBase,

	/**
	 * TODO. Wanna help? Please send a Pull Request.
	 *
	 * @property DiagramBuilder.FIELDS_TAB
	 * @default 0
	 * @type Number
	 * @static
	 */
	FIELDS_TAB: 0,

	/**
	 * TODO. Wanna help? Please send a Pull Request.
	 *
	 * @property DiagramBuilder.SETTINGS_TAB
	 * @default 1
	 * @type Number
	 * @static
	 */
	SETTINGS_TAB: 1,

	prototype: {
		editingConnector: null,

		editingNode: null,

		publishedSource: null,

		publishedTarget: null,

		selectedConnector: null,

		selectedNode: null,

		/**
		 * Construction logic executed during DiagramBuilder instantiation. Lifecycle.
		 *
		 * @method initializer
		 * @protected
		 */
		initializer: function() {
			var instance = this;

			instance.after({
				render: instance.syncConnectionsUI
			});

			instance.on({
				cancel: instance._onCancel,
				&#x27;drag:drag&#x27;: instance._onDrag,
				&#x27;drag:end&#x27;: instance._onDragEnd,
				&#x27;drop:hit&#x27;: instance._onDropHit,
				save: instance._onSave
			});

			A.DiagramNodeManager.on({
				publishedSource: function(event) {
					instance.publishedTarget = null;
					instance.publishedSource = event.publishedSource;
				}
			});

			instance.handlerKeyDown = A.getDoc().on(KEYDOWN, A.bind(instance._afterKeyEvent, instance));

			instance.dropContainer.delegate(CLICK, A.bind(instance._onNodeClick, instance), _DOT+CSS_DIAGRAM_NODE);
			instance.dropContainer.delegate(MOUSEENTER, A.bind(instance._onNodeMouseEnter, instance), _DOT+CSS_DIAGRAM_NODE);
			instance.dropContainer.delegate(MOUSELEAVE, A.bind(instance._onNodeMouseLeave, instance), _DOT+CSS_DIAGRAM_NODE);
		},

		/**
		 * Render the DiagramBuilder component instance. Lifecycle.
		 *
		 * @method renderUI
		 * @protected
		 */
		renderUI: function() {
			var instance = this;

			A.DiagramBuilder.superclass.renderUI.apply(this, arguments);

			instance._renderGraphic();
		},

		/**
		 * Sync the DiagramBuilder UI. Lifecycle.
		 *
		 * @method syncUI
		 * @protected
		 */
		syncUI: function() {
			var instance = this;

			A.DiagramBuilder.superclass.syncUI.apply(this, arguments);

			instance._setupFieldsDrag();

			instance.connector = instance.get(CONNECTOR);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method syncConnectionsUI
		 */
		syncConnectionsUI: function() {
			var instance = this;

			instance.get(FIELDS).each(function(diagramNode) {
				diagramNode.syncConnectionsUI();
			});
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method clearFields
		 */
		clearFields: function() {
			var instance = this;

			var fields = [];

			instance.get(FIELDS).each(function(diagramNode) {
				fields.push(diagramNode);
			});

			AArray.each(fields, function(diagramNode) {
				diagramNode.destroy();
			});

			fields = instance.editingConnector = instance.editingNode = instance.selectedNode = null;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method closeEditProperties
		 */
		closeEditProperties: function() {
			var instance = this;
			var editingNode = instance.editingNode;
			var tabView = instance.tabView;

			tabView.selectChild(A.DiagramBuilder.FIELDS_TAB);
			tabView.disableTab(A.DiagramBuilder.SETTINGS_TAB);

			if (editingNode) {
				editingNode.get(BOUNDING_BOX).removeClass(CSS_DIAGRAM_NODE_EDITING);
			}

			instance.editingConnector = instance.editingNode = null;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method connect
		 * @param diagramNode1
		 * @param diagramNode2
		 * @param optConnector
		 */
		connect: function(diagramNode1, diagramNode2, optConnector) {
			var instance = this;

			if (isString(diagramNode1)) {
				diagramNode1 = A.DiagramNode.getNodeByName(diagramNode1);
			}

			if (isString(diagramNode2)) {
				diagramNode2 = A.DiagramNode.getNodeByName(diagramNode2);
			}

			if (diagramNode1 &amp;&amp; diagramNode2) {
				diagramNode1.connect(diagramNode2.get(NAME), optConnector);
			}

			return instance;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method connectAll
		 * @param nodes
		 */
		connectAll: function(nodes) {
			var instance = this;

			AArray.each(nodes, function(node) {
				if (node.hasOwnProperty(SOURCE) &amp;&amp; node.hasOwnProperty(TARGET)) {
					instance.connect(node.source, node.target, node.connector);
				}
			});

			return instance;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method createField
		 * @param val
		 */
		createField: function(val) {
			var instance = this;

			if (!isDiagramNode(val)) {
				val.builder = instance;
				val.bubbleTargets = instance;
				val = new (instance.getFieldClass(val.type || NODE))(val);
			}

			return val;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method deleteSelectedConnectors
		 */
		deleteSelectedConnectors: function() {
			var instance = this;
			var strings = instance.getStrings();
			var selectedConnectors = instance.getSelectedConnectors();

			if (selectedConnectors.length &amp;&amp; confirm(strings[DELETE_CONNECTORS_MESSAGE])) {
				AArray.each(selectedConnectors, function(connector) {
					var transition = connector.get(TRANSITION);

					A.DiagramNode.getNodeByName(transition.source).disconnect(transition);
				});

				instance.stopEditing();
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method deleteSelectedNode
		 */
		deleteSelectedNode: function() {
			var instance = this;
			var strings = instance.getStrings();
			var selectedNode = instance.selectedNode;

			if (selectedNode &amp;&amp; !selectedNode.get(REQUIRED) &amp;&amp; confirm(strings[DELETE_NODES_MESSAGE])) {
				selectedNode.close();
				instance.editingNode = instance.selectedNode = null;
				instance.stopEditing();
			}
		},

		/**
		 * Destructor lifecycle implementation for the DiagramBuilder class. Lifecycle.
		 *
		 * @method destructor
		 * @param attribute
		 * @protected
		 */
		destructor: function(attribute){
			var instance = this;

			instance.get(SUGGEST_CONNECTOR_OVERLAY).destroy();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method eachConnector
		 * @param fn
		 */
		eachConnector: function(fn) {
			var instance = this;

			instance.get(FIELDS).each(function(diagramNode) {
				var transitions = diagramNode.get(TRANSITIONS);

				AArray.each(transitions.values(), function(transition) {
					fn.call(instance, diagramNode.getConnector(transition), transition, diagramNode);
				});
			});
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method editConnector
		 * @param connector
		 */
		editConnector: function(connector) {
			var instance = this;

			if (connector) {
				var tabView = instance.tabView;

				instance.closeEditProperties();
				tabView.enableTab(A.DiagramBuilder.SETTINGS_TAB);
				tabView.selectChild(A.DiagramBuilder.SETTINGS_TAB);

				instance.propertyList.set(DATA, connector.getProperties());

				instance.editingConnector = instance.selectedConnector = connector;
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method editNode
		 * @param diagramNode
		 */
		editNode: function(diagramNode) {
			var instance = this;

			if (diagramNode) {
				var tabView = instance.tabView;

				instance.closeEditProperties();
				tabView.enableTab(A.DiagramBuilder.SETTINGS_TAB);
				tabView.selectChild(A.DiagramBuilder.SETTINGS_TAB);

				instance.propertyList.set(DATA, diagramNode.getProperties());

				diagramNode.get(BOUNDING_BOX).addClass(CSS_DIAGRAM_NODE_EDITING);

				instance.editingNode = instance.selectedNode = diagramNode;
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method getFieldClass
		 * @param type
		 */
		getFieldClass: function(type) {
			var instance = this;
			var clazz = A.DiagramBuilder.types[type];

			if (clazz) {
				return clazz;
			}
			else {
				A.log(&#x27;The field type: [&#x27; + type + &#x27;] couldn\&#x27;t be found.&#x27;);

				return null;
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method getNodesByTransitionProperty
		 * @param property
		 * @param value
		 */
		getNodesByTransitionProperty: function(property, value) {
			var instance = this,
				nodes = [],
				transitions;

			instance.get(FIELDS).each(function(diagramNode) {
				transitions = diagramNode.get(TRANSITIONS);

				AArray.each(transitions.values(), function(transition) {
					if (transition[property] === value) {
						nodes.push(diagramNode);
						return false;
					}
				});
			});

			return nodes;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method getSelectedConnectors
		 */
		getSelectedConnectors: function() {
			var instance = this;
			var selected = [];

			instance.eachConnector(function(connector) {
				if (connector.get(SELECTED)) {
					selected.push(connector);
				}
			});

			return selected;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method getSourceNodes
		 * @param diagramNode
		 */
		getSourceNodes: function(diagramNode) {
			var instance = this;

			return instance.getNodesByTransitionProperty(TARGET, diagramNode.get(NAME));
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method hideSuggestConnetorOverlay
		 * @param diagramNode
		 * @param drag
		 */
		hideSuggestConnetorOverlay: function(diagramNode, drag) {
			var instance = this;

			instance.connector.hide();
			instance.get(SUGGEST_CONNECTOR_OVERLAY).hide();

			try {
				instance.fieldsDrag.dd.set(LOCK, false);
			}
			catch(e) {
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method isAbleToConnect
		 */
		isAbleToConnect: function() {
			var instance = this;

			return !!(instance.publishedSource &amp;&amp; instance.publishedTarget);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method isFieldsDrag
		 * @param drag
		 */
		isFieldsDrag: function(drag) {
			var instance = this;

			return (drag === instance.fieldsDrag.dd);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method plotField
		 * @param field
		 */
		plotField: function(field) {
			var instance = this;

			if (!field.get(RENDERED)) {
				field.render(instance.dropContainer);
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method select
		 * @param diagramNode
		 */
		select: function(diagramNode) {
			var instance = this;

			instance.unselectNodes();

			instance.selectedNode = diagramNode.set(SELECTED, true).focus();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method showSuggestConnetorOverlay
		 * @param xy
		 */
		showSuggestConnetorOverlay: function(xy) {
			var instance = this,
				showSuggestConnetorOverlay = instance.get(SUGGEST_CONNECTOR_OVERLAY),
				boundingBox = showSuggestConnetorOverlay.get(BOUNDING_BOX);

			showSuggestConnetorOverlay.get(BOUNDING_BOX).addClass(CSS_DIAGRAM_SUGGEST_CONNECTOR);

			showSuggestConnetorOverlay.set(
				XY, xy || instance.connector.get(P2)).show();

			try {
				instance.fieldsDrag.dd.set(LOCK, true);
			}
			catch(e) {
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method stopEditing
		 */
		stopEditing: function() {
			var instance = this;

			instance.unselectConnectors();
			instance.unselectNodes();
			instance.closeEditProperties();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method toJSON
		 */
		toJSON: function() {
			var instance = this;

			var output = {
				nodes: []
			};

			instance.get(FIELDS).each(function(diagramNode) {
				var node = {
					transitions: []
				},
				transitions = diagramNode.get(TRANSITIONS);

				// serialize node attributes
				AArray.each(diagramNode.SERIALIZABLE_ATTRS, function(attributeName) {
					node[attributeName] = diagramNode.get(attributeName);
				});

				// serialize node transitions
				AArray.each(transitions.values(), function(transition) {
					var connector = diagramNode.getConnector(transition);
					transition.connector = connector.toJSON();
					node.transitions.push(transition);
				});

				output.nodes.push(node);
			});

			return output;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method unselectConnectors
		 */
		unselectConnectors: function() {
			var instance = this;

			AArray.each(instance.getSelectedConnectors(), function(connector) {
				connector.set(SELECTED, false);
			});
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method unselectNodes
		 */
		unselectNodes: function() {
			var instance = this;
			var selectedNode = instance.selectedNode;

			if (selectedNode) {
				selectedNode.set(SELECTED, false);
			}

			instance.selectedNode = null;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _afterKeyEvent
		 * @param event
		 * @protected
		 */
		_afterKeyEvent: function(event) {
			var instance = this;

			if (event.hasModifier() || A.getDoc().get(ACTIVE_ELEMENT).test(&#x27;:input,td&#x27;)) {
				return;
			}

			if (event.isKey(ESC)) {
				instance._onEscKey(event);
			}
			else if (event.isKey(BACKSPACE) || event.isKey(DELETE)) {
				instance._onDeleteKey(event);
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onCancel
		 * @param event
		 * @protected
		 */
		_onCancel: function(event) {
			var instance = this;

			instance.closeEditProperties();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onDeleteKey
		 * @param event
		 * @protected
		 */
		_onDeleteKey: function(event) {
			var instance = this;

			if (isDiagramNode(A.Widget.getByNode(event.target))) {
				instance.deleteSelectedConnectors();
				instance.deleteSelectedNode();

				event.halt();
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onDrag
		 * @param event
		 * @protected
		 */
		_onDrag: function(event) {
			var instance = this;
			var drag = event.target;

			if (instance.isFieldsDrag(drag)) {
				var diagramNode = A.Widget.getByNode(drag.get(DRAG_NODE));

				diagramNode.alignTransitions();

				AArray.each(instance.getSourceNodes(diagramNode), function(sourceNode) {
					sourceNode.alignTransitions();
				});
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onDragEnd
		 * @param event
		 * @protected
		 */
		_onDragEnd: function(event) {
			var instance = this;
			var drag = event.target;
			var diagramNode = A.Widget.getByNode(drag.get(DRAG_NODE));

			if (diagramNode &amp;&amp; instance.isFieldsDrag(drag)) {
				diagramNode.set(XY, diagramNode.getLeftTop());
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onDropHit
		 * @param event
		 * @protected
		 */
		_onDropHit: function(event) {
			var instance = this;
			var drag = event.drag;

			if (instance.isAvailableFieldsDrag(drag)) {
				var availableField = drag.get(NODE).getData(AVAILABLE_FIELD);

				var newField = instance.addField({
					xy: getLeftTop(drag.lastXY, instance.dropContainer),
					type: availableField.get(TYPE)
				});

				instance.select(newField);
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onEscKey
		 * @param event
		 * @protected
		 */
		_onEscKey: function(event) {
			var instance = this;

			instance.hideSuggestConnetorOverlay();
			instance.stopEditing();
			event.halt();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onCanvasClick
		 * @param event
		 * @protected
		 */
		_onCanvasClick: function(event) {
			var instance = this;

			instance.stopEditing();
			instance.hideSuggestConnetorOverlay();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onNodeClick
		 * @param event
		 * @protected
		 */
		_onNodeClick: function(event) {
			var instance = this;
			var diagramNode = A.Widget.getByNode(event.currentTarget);

			instance.select(diagramNode);

			instance._onNodeEdit(event);

			event.stopPropagation();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onNodeEdit
		 * @param event
		 * @protected
		 */
		_onNodeEdit: function(event) {
			var instance = this;

			// Only enable editing if the double clicked node is inside the node contentBox.
			if (!event.target.ancestor(_DOT+CSS_DIAGRAM_NODE_CONTENT, true)) {
				return;
			}

			var diagramNode = A.Widget.getByNode(event.currentTarget);

			if (diagramNode) {
				instance.editNode(diagramNode);
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onNodeMouseEnter
		 * @param event
		 * @protected
		 */
		_onNodeMouseEnter: function(event) {
			var instance = this;
			var diagramNode = A.Widget.getByNode(event.currentTarget);

			diagramNode.set(HIGHLIGHTED, true);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onNodeMouseLeave
		 * @param event
		 * @protected
		 */
		_onNodeMouseLeave: function(event) {
			var instance = this;
			var publishedSource = instance.publishedSource;
			var diagramNode = A.Widget.getByNode(event.currentTarget);

			if (!publishedSource || !publishedSource.boundaryDragDelegate.dd.get(DRAGGING)) {
				diagramNode.set(HIGHLIGHTED, false);
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onSave
		 * @param event
		 * @protected
		 */
		_onSave: function(event) {
			var instance = this;
			var editingNode = instance.editingNode;
			var editingConnector = instance.editingConnector;
			var modelList = instance.propertyList.get(DATA);

			if (editingNode) {
				modelList.each(function(model) {
					editingNode.set(model.get(ATTRIBUTE_NAME), model.get(VALUE));
				});
			}
			else if (editingConnector) {
				modelList.each(function(model) {
					editingConnector.set(model.get(ATTRIBUTE_NAME), model.get(VALUE));
				});
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onSuggestConnectorNodeClick
		 * @param event
		 * @protected
		 */
		_onSuggestConnectorNodeClick: function(event) {
			var instance = this;
			var availableField = event.currentTarget.getData(AVAILABLE_FIELD);
			var connector = instance.connector;

			var node = instance.addField({
				type: availableField.get(TYPE),
				xy: connector.toCoordinate(connector.get(P2))
			});

			instance.hideSuggestConnetorOverlay();
			instance.publishedSource.connectNode(node);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _renderGraphic
		 * @protected
		 */
		_renderGraphic: function() {
			var instance = this;
			var graphic = instance.get(GRAPHIC);
			var canvas = instance.get(CANVAS);

			graphic.render(canvas);
			A.one(canvas).on(CLICK, A.bind(instance._onCanvasClick, instance));
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _setConnector
		 * @param val
		 * @protected
		 */
		_setConnector: function(val) {
			var instance = this;

			if (!isConnector(val)) {
				var xy = instance.get(CANVAS).getXY();

				val = new A.Connector(
					A.merge(
						{
							builder: instance,
							graphic: instance.get(GRAPHIC),
							lazyDraw: true,
							p1: xy,
							p2: xy,
							shapeHover: null,
							showName: false
						},
						val
					)
				);
			}

			return val;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _setFieldsDragConfig
		 * @param val
		 * @protected
		 */
		_setFieldsDragConfig: function(val) {
			var instance = this;
			var dropContainer = instance.dropContainer;

			return A.merge(
				{
					bubbleTargets: instance,
					container: dropContainer,
					dragConfig: {
						plugins: [
							{
								cfg: {
									constrain: dropContainer
								},
								fn: A.Plugin.DDConstrained
							},
							{
								cfg: {
									scrollDelay: 150
								},
								fn: A.Plugin.DDWinScroll
							}
						]
					},
					nodes: _DOT+CSS_DIAGRAM_NODE
				},
				val || {}
			);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _setSuggestConnectorOverlay
		 * @param val
		 * @protected
		 */
		_setSuggestConnectorOverlay: function(val) {
			var instance = this;

			if (!val) {
				var docFrag = A.getDoc().invoke(CREATE_DOCUMENT_FRAGMENT),
					boundingBox,
					contentBox;

				AArray.each(instance.get(AVAILABLE_FIELDS), function(field) {
					var node = field.get(NODE);

					docFrag.appendChild(
						node.clone().setData(AVAILABLE_FIELD, node.getData(AVAILABLE_FIELD))
					);
				});

				val = new A.Overlay({
					bodyContent: docFrag,
					render: true,
					visible: false,
					width: 280,
					zIndex: 10000
				});

				boundingBox = val.get(BOUNDING_BOX);
				contentBox = val.get(&#x27;contentBox&#x27;);

				contentBox.addClass(&#x27;popover-content&#x27;);
				boundingBox.addClass(&#x27;popover&#x27;);

				boundingBox.delegate(CLICK, A.bind(instance._onSuggestConnectorNodeClick, instance), _DOT+CSS_DIAGRAM_BUILDER_FIELD);
			}

			return val;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _setupFieldsDrag
		 * @protected
		 */
		_setupFieldsDrag: function() {
			var instance = this;

			instance.fieldsDrag = new A.DD.Delegate(
				instance.get(FIELDS_DRAG_CONFIG)
			);
		}
	}
});

A.DiagramBuilder = DiagramBuilder;

A.DiagramBuilder.types = {};

/**
 * A base class for DiagramNodeManagerBase.
 *
 * @class A.DiagramNodeManagerBase
 * @extends A.Base
 * @param config {Object} Object literal specifying widget configuration properties.
 * @constructor
 */
var DiagramNodeManagerBase = A.Component.create({

	/**
	 * Static property provides a string to identify the class.
	 *
	 * @property DiagramNodeManagerBase.NAME
	 * @type String
	 * @static
	 */
	NAME: DIAGRAM_NODE_MANAGER_NAME,

	/**
	 * Static property used to define which component it extends.
	 *
	 * @property DiagramNodeManagerBase.EXTENDS
	 * @type String
	 * @static
	 */
	EXTENDS: A.Base
});

A.DiagramNodeManager = new DiagramNodeManagerBase();

/**
 * A base class for DiagramNode.
 *
 * @class A.DiagramNode
 * @extends A.Overlay
 * @param config {Object} Object literal specifying widget configuration properties.
 * @constructor
 */
var DiagramNode = A.Component.create({

	/**
	 * Static property provides a string to identify the class.
	 *
	 * @property DiagramNode.NAME
	 * @type String
	 * @static
	 */
	NAME: DIAGRAM_NODE_NAME,

	/**
	 * Static property used to define the UI attributes.
	 *
	 * @property DiagramNode.UI_ATTRS
	 * @type Array
	 * @static
	 */
	UI_ATTRS: [HIGHLIGHTED, NAME, REQUIRED, SELECTED],

	/**
	 * Static property used to define the default attribute
	 * configuration for the DiagramNode.
	 *
	 * @property DiagramNode.ATTRS
	 * @type Object
	 * @static
	 */
	ATTRS: {

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute builder
		 * @type DiagramBuilder
		 */
		builder: {
			validator: isDiagramBuilder
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute connectors
		 * @writeOnce
		 */
		connectors: {
			valueFn: &#x27;_connectorsValueFn&#x27;,
			writeOnce: true
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute controlsToolbar
		 * @type Object
		 */
		controlsToolbar: {
			validator: isObject,
			valueFn: &#x27;_controlsToolbarValueFn&#x27;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute description
		 * @default &#x27;&#x27;
		 * @type String
		 */
		description: {
			value: _EMPTY_STR,
			validator: isString
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute graphic
		 * @type Object
		 * @writeOnce
		 */
		graphic: {
			writeOnce: true,
			validator: isObject
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute height
		 * @default 60
		 * @type Number
		 */
		height: {
			value: 60
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute highlighted
		 * @default false
		 * @type Boolean
		 */
		highlighted: {
			validator: isBoolean,
			value: false
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute name
		 * @type String
		 */
		name: {
			valueFn: function() {
				var instance = this;

				return instance.get(TYPE) + (++A.Env._uidx);
			},
			validator: isString
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute required
		 * @default false
		 * @type Boolean
		 */
		required: {
			value: false,
			validator: isBoolean
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute selected
		 * @default false
		 * @type Boolean
		 */
		selected: {
			value: false,
			validator: isBoolean
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute shapeBoundary
		 * @type Object
		 */
		shapeBoundary: {
			validator: isObject,
			valueFn: &#x27;_valueShapeBoundary&#x27;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute highlightBoundaryStroke
		 * @type Object
		 */
		highlightBoundaryStroke: {
			validator: isObject,
			value: {
				weight: 7,
				color: &#x27;#484B4C&#x27;,
				opacity: 0.25
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute shapeInvite
		 * @type Object
		 */
		shapeInvite: {
			validator: isObject,
			value: {
				radius: 12,
				type: &#x27;circle&#x27;,
				stroke: {
					weight: 6,
					color: &#x27;#ff6600&#x27;,
					opacity: 0.8
				},
				fill: {
					color: &#x27;#ffd700&#x27;,
					opacity: 0.8
				}
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute strings
		 * @type Object
		 */
		strings: {
			value: {
				closeMessage: &#x27;Close&#x27;,
				connectMessage: &#x27;Connect&#x27;,
				description: &#x27;Description&#x27;,
				editMessage: &#x27;Edit&#x27;,
				name: &#x27;Name&#x27;,
				type: &#x27;Type&#x27;
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute tabIndex
		 * @default 1
		 * @type Number
		 */
		tabIndex: {
			value: 1
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute transitions
		 * @default null
		 * @writeOnce
		 */
		transitions: {
			value: null,
			writeOnce: true,
			setter: &#x27;_setTransitions&#x27;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute type
		 * @default &#x27;node&#x27;
		 * @type String
		 */
		type: {
			value: NODE,
			validator: isString
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute width
		 * @default 60
		 * @type Number
		 */
		width: {
			value: 60
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute zIndex
		 * @default 100
		 * @type Number
		 */
		zIndex: {
			value: 100
		}
	},

	/**
	 * Static property used to define which component it extends.
	 *
	 * @property DiagramNode.EXTENDS
	 * @type String
	 * @static
	 */
	EXTENDS: A.Overlay,

	/**
	 * TODO. Wanna help? Please send a Pull Request.
	 *
	 * @property DiagramNode.CIRCLE_POINTS
	 * @type Array
	 * @static
	 */
	CIRCLE_POINTS: [[35, 20], [28, 33], [14, 34], [5, 22], [10, 9], [24, 6], [34, 16], [31, 30], [18, 35], [6, 26], [7, 12], [20, 5], [33, 12], [34, 26], [22, 35], [9, 30], [6, 16], [16, 6], [30, 9], [35, 22], [26, 34], [12, 33], [5, 20], [12, 7], [26, 6], [35, 18], [30, 31], [16, 34], [6, 24], [9, 10], [22, 5], [34, 14], [33, 28], [20, 35], [7, 28], [6, 14], [18, 5], [31, 10], [34, 24], [24, 34], [10, 31], [5, 18], [14, 6], [28, 8], [35, 20], [28, 33], [14, 34], [5, 22], [10, 8], [25, 6], [34, 16], [31, 30], [18, 35], [6, 26], [8, 12], [20, 5], [33, 12], [33, 27], [22, 35], [8, 30], [6, 15], [16, 6], [30, 9], [35, 23], [26, 34], [12, 32], [5, 20], [12, 7], [27, 7], [35, 18], [29, 32], [15, 34]],

	/**
	 * TODO. Wanna help? Please send a Pull Request.
	 *
	 * @property DiagramNode.DIAMOND_POINTS
	 * @type Array
	 * @static
	 */
	DIAMOND_POINTS: [ [30,5], [35,10], [40,15], [45,20], [50,25], [55,30], [50,35], [45,40], [40,45], [35,50], [30,55], [25,50], [20,45], [15,40], [10,35], [5,30], [10,25], [15,20], [20,15], [25,10] ],

	/**
	 * TODO. Wanna help? Please send a Pull Request.
	 *
	 * @property DiagramNode.SQUARE_POINTS
	 * @type Array
	 * @static
	 */
	SQUARE_POINTS: [ [5,5], [10,5], [15,5], [20,5] ,[25,5], [30,5], [35,5], [40,5], [50,5], [55,5], [60,5], [65, 5], [65,10], [65,15], [65,20], [65,25], [65,30], [65,35], [65,40], [65,45], [65,50], [65,55], [65, 60], [65, 65], [60,65], [55,65], [50,65], [45,65], [40,65], [35,65], [30,65], [25,65], [20,65], [15,65], [10,65], [5, 65], [5,60], [5,55], [5,50], [5,45], [5,40], [5,35], [5,30], [5,25], [5,20], [5,15], [5,10] ],

	/**
	 * TODO. Wanna help? Please send a Pull Request.
	 *
	 * @method getNodeByName
	 * @param name
	 * @private
	 */
	getNodeByName: function(name) {
		return A.Widget.getByNode(&#x27;[data-nodeId=&#x27; + A.DiagramNode.buildNodeId(name) + &#x27;]&#x27;);
	},

	/**
	 * TODO. Wanna help? Please send a Pull Request.
	 *
	 * @method buildNodeId
	 * @param id
	 * @private
	 */
	buildNodeId: function(id) {
		return DIAGRAM_NODE + _UNDERLINE + FIELD + _UNDERLINE + id.replace(/[^a-z0-9.:_\-]/ig, &#x27;_&#x27;);
	},

	prototype: {
		LABEL_TEMPLATE: &#x27;&lt;div class=&quot;&#x27; + CSS_DIAGRAM_NODE_LABEL + &#x27;&quot;&gt;{label}&lt;/div&gt;&#x27;,

		boundary: null,

		hotPoints: [ [0,0] ],

		CONTROLS_TEMPLATE: &#x27;&lt;div class=&quot;&#x27; + CSS_DB_CONTROLS + &#x27;&quot;&gt;&lt;/div&gt;&#x27;,

		SERIALIZABLE_ATTRS: [DESCRIPTION, NAME, REQUIRED, TYPE, WIDTH, HEIGHT, Z_INDEX, XY],

		/**
		 * Construction logic executed during DiagramNode instantiation. Lifecycle.
		 *
		 * @method initializer
		 * @protected
		 */
		initializer: function() {
			var instance = this;

			instance.after({
				&#x27;map:remove&#x27;: A.bind(instance._afterMapRemove, instance),
				render: instance._afterRender
			});

			instance.on({
				nameChange: instance._onNameChange
			});

			instance.publish({
				connectDrop: { defaultFn: instance.connectDrop },
				connectEnd: { defaultFn: instance.connectEnd },
				connectMove: { defaultFn: instance.connectMove },
				connectOutTarget: { defaultFn: instance.connectOutTarget },
				connectOverTarget: { defaultFn: instance.connectOverTarget },
				connectStart: { defaultFn: instance.connectStart },
				boundaryMouseEnter: {},
				boundaryMouseLeave: {}
			});

			instance.get(BOUNDING_BOX).addClass(CSS_DIAGRAM_NODE+_DASH+instance.get(TYPE));
		},

		/**
		 * Destructor lifecycle implementation for the DiagramNode class. Lifecycle.
		 *
		 * @method destructor
		 * @protected
		 */
		destructor: function() {
			var instance = this;

			instance.eachConnector(function(connector, index, sourceNode) {
				sourceNode.removeTransition(connector.get(TRANSITION));
			});

			instance.invite.destroy();
			instance.get(GRAPHIC).destroy();
			instance.get(BUILDER).removeField(instance);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method addTransition
		 * @param transition
		 */
		addTransition: function(transition) {
			var instance = this,
				transitions = instance.get(TRANSITIONS);

			transition = instance.prepareTransition(transition);

			if (!transitions.has(transition.uid)) {
				transition.uid = A.guid();
				transitions.put(transition.uid, transition);
			}

			return transition;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method alignTransition
		 * @param transition
		 */
		alignTransition: function(transition) {
			var instance = this;
			var diagramNode = A.DiagramNode.getNodeByName(transition.target);

			if (diagramNode) {
				var bestMatch = findHotPointBestMatch(instance, diagramNode);

				transition = A.merge(transition, {
					sourceXY: bestMatch[0],
					targetXY: bestMatch[1]
				});

				instance.getConnector(transition).setAttrs({
					p1: adjustDiagramNodeOffset(instance, transition.sourceXY),
					p2: adjustDiagramNodeOffset(diagramNode, transition.targetXY)
				});
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method alignTransitions
		 */
		alignTransitions: function() {
			var instance = this,
				transitions = instance.get(TRANSITIONS);

			AArray.each(transitions.values(), A.bind(instance.alignTransition, instance));
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method close
		 */
		close: function() {
			var instance = this;

			return instance.destroy();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method connect
		 * @param transition
		 * @param optConnector
		 */
		connect: function(transition, optConnector) {
			var instance = this;

			transition = instance.addTransition(transition);

			var connector = null;
			var diagramNode = A.DiagramNode.getNodeByName(transition.target);

			if (diagramNode) {
				if (!instance.isTransitionConnected(transition)) {
					var builder = instance.get(BUILDER);
					var bestMatch = findHotPointBestMatch(instance, diagramNode);

					A.mix(transition, {
						sourceXY: bestMatch[0],
						targetXY: bestMatch[1]
					});

					connector = new A.Connector(
						A.merge({
							builder: builder,
							graphic: builder.get(GRAPHIC),
							transition: transition
						}, optConnector)
					);

					instance.get(CONNECTORS).put(transition.uid, connector);
				}
			}

			instance.alignTransition(transition);

			return connector;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method connectDrop
		 * @param event
		 */
		connectDrop: function(event) {
			var instance = this;

			instance.connectNode(event.publishedTarget);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method connectEnd
		 * @param event
		 */
		connectEnd: function(event) {
			var instance = this;
			var drag = event.target;
			var builder = instance.get(BUILDER);
			var publishedSource = builder.publishedSource;

			if (!builder.isAbleToConnect() &amp;&amp; builder.get(SHOW_SUGGEST_CONNECTOR) &amp;&amp; builder.connector.get(VISIBLE)) {
				builder.showSuggestConnetorOverlay();
			}
			else {
				builder.connector.hide();
				publishedSource.invite.set(VISIBLE, false);
			}

			if (builder.get(HIGHLIGHT_DROP_ZONES)) {
				builder.get(FIELDS).each(function(diagramNode) {
					diagramNode.set(HIGHLIGHTED, false);
				});
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method connectMove
		 * @param event
		 */
		connectMove: function(event) {
			var instance = this;
			var builder = instance.get(BUILDER);
			var mouseXY = event.mouseXY;

			builder.connector.set(P2, mouseXY);

			if (builder.publishedTarget) {
				var invite = instance.invite;
				var offset = invite.get(RADIUS) || 0;

				if (!invite.get(VISIBLE)) {
					invite.set(VISIBLE, true);
				}

				invite.setXY([ mouseXY[0] - offset, mouseXY[1] - offset ]);
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method connectNode
		 * @param diagramNode
		 */
		connectNode: function(diagramNode) {
			var instance = this;
			var dd = instance.boundaryDragDelegate.dd;

			instance.connect(
				instance.prepareTransition({
					sourceXY: getLeftTop(dd.startXY, instance.get(BOUNDING_BOX)),
					target: diagramNode.get(NAME),
					targetXY: getLeftTop(dd.mouseXY, diagramNode.get(BOUNDING_BOX))
				})
			);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method connectOutTarget
		 * @param event
		 */
		connectOutTarget: function(event) {
			var instance = this;
			var builder = instance.get(BUILDER);

			builder.publishedTarget = null;
			builder.publishedSource.invite.set(VISIBLE, false);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method connectOverTarget
		 * @param event
		 */
		connectOverTarget: function(event) {
			var instance = this;
			var builder = instance.get(BUILDER);

			if (builder.publishedSource !== instance) {
				builder.publishedTarget = instance;
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method connectStart
		 * @param event
		 */
		connectStart: function(event) {
			var instance = this;
			var builder = instance.get(BUILDER);
			var canvas = builder.get(CANVAS);

			builder.connector.show().set(P1, event.startXY);

			if (builder.get(HIGHLIGHT_DROP_ZONES)) {
				builder.get(FIELDS).each(function(diagramNode) {
					diagramNode.set(HIGHLIGHTED, true);
				});
			}

			A.DiagramNodeManager.fire(&#x27;publishedSource&#x27;, { publishedSource: instance });
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method disconnect
		 * @param transition
		 */
		disconnect: function(transition) {
			var instance = this;

			if (instance.isTransitionConnected(transition)) {
				instance.removeTransition(transition);
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method eachConnector
		 * @param fn
		 */
		eachConnector: function(fn) {
			var instance = this,
				sourceNodes = [],
				connectors = [].concat(instance.get(CONNECTORS).values()),
				tIndex = connectors.length;

			AArray.each(instance.get(BUILDER).getSourceNodes(instance), function(sourceNode) {
				var sourceConnectors = sourceNode.get(CONNECTORS);

				AArray.each(sourceConnectors.values(), function(connector) {
					if (instance.get(NAME) === connector.get(TRANSITION).target) {
						sourceNodes.push(sourceNode);
						connectors.push(connector);
					}
				});
			});

			AArray.each(connectors, function(connector, index) {
				fn.call(instance, connector, index, (index &lt; tIndex) ? instance : sourceNodes[index - tIndex]);
			});

			connectors = sourceNodes = null;

			return connectors;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method getConnector
		 * @param transition
		 */
		getConnector: function(transition) {
			var instance = this;

			return instance.get(CONNECTORS).getValue(transition.uid);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method getContainer
		 */
		getContainer: function() {
			var instance = this;

			return (instance.get(BUILDER).dropContainer || instance.get(BOUNDING_BOX).get(PARENT_NODE));
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method getLeftTop
		 */
		getLeftTop: function() {
			var instance = this;

			return getLeftTop(instance.get(BOUNDING_BOX), instance.getContainer());
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method getProperties
		 */
		getProperties: function() {
			var instance = this;
			var propertyModel = instance.getPropertyModel();

			AArray.each(propertyModel, function(property) {
				var value = instance.get(property.attributeName), type = Lang.type(value);

				if (type === BOOLEAN) {
					value = String(value);
				}

				property.value = value;
			});

			return propertyModel;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method getPropertyModel
		 */
		getPropertyModel: function() {
			var instance = this;
			var strings = instance.getStrings();

			return [
				{
					attributeName: DESCRIPTION,
					editor: new A.TextAreaCellEditor(),
					name: strings[DESCRIPTION]
				},
				{
					attributeName: NAME,
					editor: new A.TextCellEditor({
						validator: {
							rules: {
								value: {
									required: true
								}
							}
						}
					}),
					name: strings[NAME]
				},
				{
					attributeName: TYPE,
					editor: false,
					name: strings[TYPE]
				}
			];
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method isBoundaryDrag
		 * @param drag
		 */
		isBoundaryDrag: function(drag) {
			var instance = this;

			return (drag === instance.boundaryDragDelegate.dd);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method isTransitionConnected
		 * @param transition
		 */
		isTransitionConnected: function(transition) {
			var instance = this;

			return instance.get(CONNECTORS).has(transition.uid);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method prepareTransition
		 * @param val
		 */
		prepareTransition: function(val) {
			var instance = this;

			var transition = {
				source: instance.get(NAME),
				target: null,
				uid: A.guid()
			};

			if (isString(val)) {
				transition.target = val;
			}
			else if (isObject(val)) {
				transition = A.merge(transition, val);
			}

			return transition;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method removeTransition
		 * @param transition
		 */
		removeTransition: function(transition) {
			var instance = this;

			return instance.get(TRANSITIONS).remove(transition.uid);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method renderShapeBoundary
		 */
		renderShapeBoundary: function() {
			var instance = this;

			var boundary = instance.boundary = instance.get(GRAPHIC).addShape(instance.get(SHAPE_BOUNDARY));

			return boundary;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method renderShapeInvite
		 */
		renderShapeInvite: function() {
			var instance = this;

			var invite = instance.invite = instance.get(BUILDER).get(GRAPHIC).addShape(instance.get(SHAPE_INVITE));

			invite.set(VISIBLE, false);

			return invite;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method syncConnectionsUI
		 */
		syncConnectionsUI: function() {
			var instance = this,
				transitions = instance.get(TRANSITIONS);

			AArray.each(transitions.values(), function(transition) {
				instance.connect(transition, transition.connector);
			});
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _afterConnectorRemove
		 * @param event
		 * @protected
		 */
		_afterConnectorRemove: function(event) {
			var instance = this;

			event.value.destroy();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _afterRender
		 * @param event
		 * @protected
		 */
		_afterRender: function(event) {
			var instance = this;

			instance.setStdModContent(WidgetStdMod.BODY, _EMPTY_STR, WidgetStdMod.AFTER);
			instance._renderGraphic();
			instance._renderControls();
			instance._renderLabel();
			instance._uiSetHighlighted(instance.get(HIGHLIGHTED));
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _afterTransitionsRemove
		 * @param event
		 * @protected
		 */
		_afterTransitionsRemove: function(event) {
			var instance = this;

			instance.get(CONNECTORS).remove(event.value.uid);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _bindBoundaryEvents
		 * @protected
		 */
		_bindBoundaryEvents: function() {
			var instance = this;

			instance.boundary.detachAll().on({
				mouseenter: A.bind(instance._onBoundaryMouseEnter, instance),
				mouseleave: A.bind(instance._onBoundaryMouseLeave, instance)
			});
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _connectorsValueFn
		 * @param val
		 * @protected
		 */
		_connectorsValueFn: function(val) {
			var instance = this;

			return new A.Map({
				after: {
					remove: A.bind(instance._afterConnectorRemove, instance)
				}
			});
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _controlsToolbarValueFn
		 * @param val
		 * @protected
		 */
		_controlsToolbarValueFn: function(val) {
			var instance = this,
				id = instance.get(ID);

			return {
				children: [
					{
						icon: &#x27;icon-remove&#x27;,
						on: {
							click: A.bind(instance._handleCloseEvent, instance)
						}
					}
				]
			};
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _handleCloseEvent
		 * @param event
		 * @protected
		 */
		_handleCloseEvent: function(event) {
			var instance = this;

			instance.get(BUILDER).deleteSelectedNode();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _handleConnectStart
		 * @param startXY
		 * @protected
		 */
		_handleConnectStart: function(startXY) {
			var instance = this;

			instance.fire(&#x27;connectStart&#x27;, { startXY: startXY });
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _handleConnectMove
		 * @param mouseXY
		 * @protected
		 */
		_handleConnectMove: function(mouseXY) {
			var instance = this;
			var builder = instance.get(BUILDER);

			instance.fire(&#x27;connectMove&#x27;, {
				mouseXY: mouseXY,
				publishedSource: builder.publishedSource
			});
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _handleConnectEnd
		 * @protected
		 */
		_handleConnectEnd: function() {
			var instance = this;
			var builder = instance.get(BUILDER);
			var publishedSource = builder.publishedSource;
			var publishedTarget = builder.publishedTarget;

			if (publishedSource &amp;&amp; publishedTarget) {
				instance.fire(&#x27;connectDrop&#x27;, {
					publishedSource: publishedSource,
					publishedTarget: publishedTarget
				});
			}

			instance.fire(&#x27;connectEnd&#x27;, {
				publishedSource: publishedSource
			});
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _handleConnectOutTarget
		 * @protected
		 */
		_handleConnectOutTarget: function() {
			var instance = this;
			var builder = instance.get(BUILDER);
			var publishedSource = builder.publishedSource;

			if (publishedSource) {
				instance.fire(&#x27;connectOutTarget&#x27;, {
					publishedSource: publishedSource
				});
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _handleConnectOverTarget
		 * @protected
		 */
		_handleConnectOverTarget: function() {
			var instance = this;
			var builder = instance.get(BUILDER);
			var publishedSource = builder.publishedSource;

			if (publishedSource) {
				instance.fire(&#x27;connectOverTarget&#x27;, {
					publishedSource: publishedSource
				});
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onBoundaryDrag
		 * @param event
		 * @protected
		 */
		_onBoundaryDrag: function(event) {
			var instance = this;
			var dd = instance.boundaryDragDelegate.dd;

			instance._handleConnectMove(dd.con._checkRegion(dd.mouseXY));
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onBoundaryDragEnd
		 * @param event
		 * @protected
		 */
		_onBoundaryDragEnd: function(event) {
			var instance = this;

			instance._handleConnectEnd();
			event.target.get(DRAG_NODE).show();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onBoundaryDragStart
		 * @param event
		 * @protected
		 */
		_onBoundaryDragStart: function(event) {
			var instance = this;

			instance._handleConnectStart(instance.boundaryDragDelegate.dd.startXY);
			event.target.get(DRAG_NODE).hide();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onBoundaryMouseEnter
		 * @param event
		 * @protected
		 */
		_onBoundaryMouseEnter: function(event) {
			var instance = this;

			instance.fire(&#x27;boundaryMouseEnter&#x27;, {
				domEvent: event
			});

			instance._handleConnectOverTarget();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onBoundaryMouseLeave
		 * @param event
		 * @protected
		 */
		_onBoundaryMouseLeave: function(event) {
			var instance = this;

			instance.fire(&#x27;boundaryMouseLeave&#x27;, {
				domEvent: event
			});

			instance._handleConnectOutTarget();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _onNameChange
		 * @param event
		 * @protected
		 */
		_onNameChange: function(event) {
			var instance = this;

			instance.eachConnector(function(connector, index, sourceNode) {
				var transition = connector.get(TRANSITION);

				transition[(instance === sourceNode) ? SOURCE : TARGET] = event.newVal;
				connector.set(TRANSITION, transition);
			});
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _renderControls
		 * @protected
		 */
		_renderControls: function() {
			var instance = this;
			var boundingBox = instance.get(BOUNDING_BOX);

			instance.controlsNode = A.Node.create(instance.CONTROLS_TEMPLATE).appendTo(boundingBox);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _renderControlsToolbar
		 * @param event
		 * @protected
		 */
		_renderControlsToolbar: function(event) {
			var instance = this;

			instance.controlsToolbar = new A.Toolbar(
				instance.get(CONTROLS_TOOLBAR)
			)
			.render(instance.controlsNode);

			instance._uiSetRequired(instance.get(REQUIRED));
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _renderGraphic
		 * @protected
		 */
		_renderGraphic: function() {
			var instance = this;

			instance.set(
				GRAPHIC,
				new A.Graphic({
					height: instance.get(HEIGHT),
					render: instance.bodyNode,
					width: instance.get(WIDTH)
				})
			);

			instance.renderShapeInvite();
			instance.renderShapeBoundary().addClass(CSS_DIAGRAM_NODE_SHAPE_BOUNDARY);

			instance._bindBoundaryEvents();
			instance._setupBoundaryDrag();
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _renderLabel
		 * @protected
		 */
		_renderLabel: function() {
			var instance = this;

			instance.labelNode = A.Node.create(
				Lang.sub(instance.LABEL_TEMPLATE, {
					label: instance.get(&#x27;name&#x27;)
				})
			);

			instance.get(&#x27;contentBox&#x27;).placeAfter(instance.labelNode);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _setTransitions
		 * @param val
		 * @protected
		 */
		_setTransitions: function(val) {
			var instance = this;

			if (!isMap(val)) {
				var map = new A.Map({
					after: {
						remove: A.bind(instance._afterTransitionsRemove, instance)
					}
				});

				A.Array.each(val, function(transition) {
					var uid = A.guid();

					transition = isObject(transition) ? A.mix(transition, { uid: uid }) : { uid: uid, target: transition };

					map.put(uid, instance.prepareTransition(transition));
				});

				val = map;
			}

			return val;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _setupBoundaryDrag
		 * @protected
		 */
		_setupBoundaryDrag: function() {
			var instance = this;

			var builder = instance.get(BUILDER);

			instance.boundaryDragDelegate = new A.DD.Delegate({
				bubbleTargets: instance,
				container: instance.bodyNode,
				nodes: _DOT+CSS_DIAGRAM_NODE_SHAPE_BOUNDARY,
				dragConfig: {
					useShim: false,
					plugins: [
						{
							cfg: {
								constrain: (builder ? builder.get(CANVAS) : null)
							},
							fn: A.Plugin.DDConstrained
						},
						{
							cfg: {
								scrollDelay: 150
							},
							fn: A.Plugin.DDWinScroll
						},
						{
							cfg: {
								borderStyle: &#x27;0px&#x27;,
								moveOnEnd: false,
								resizeFrame: false
							},
							fn: A.Plugin.DDProxy
						}
					]
				},
				on: {
					&#x27;drag:drag&#x27;: A.bind(instance._onBoundaryDrag, instance),
					&#x27;drag:end&#x27;: A.bind(instance._onBoundaryDragEnd, instance),
					&#x27;drag:start&#x27;: A.bind(instance._onBoundaryDragStart, instance)
				}
			});

			// Drag _unprep method invoke .detachAll() on the node, so we need to rebind the events.
			A.Do.after(instance._bindBoundaryEvents, instance.boundaryDragDelegate.dd, &#x27;_unprep&#x27;, instance);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _uiSetHighlighted
		 * @param val
		 * @protected
		 */
		_uiSetHighlighted: function(val) {
			var instance = this;

			if (instance.get(RENDERED)) {
				var stroke = val ? instance.get(HIGHLIGHT_BOUNDARY_STROKE) : instance.get(SHAPE_BOUNDARY+_DOT+STROKE);

				if (stroke) {
					instance.boundary.set(STROKE, stroke);
				}
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _uiSetName
		 * @param val
		 * @protected
		 */
		_uiSetName: function(val) {
			var instance = this;
			var boundingBox = instance.get(BOUNDING_BOX);

			boundingBox.setAttribute(DATA_NODE_ID, A.DiagramNode.buildNodeId(val));

			if (instance.get(&#x27;rendered&#x27;)) {
				instance.labelNode.setContent(val);
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _uiSetRequired
		 * @param val
		 * @protected
		 */
		_uiSetRequired: function(val) {
			var instance = this,
				controlsToolbar = instance.controlsToolbar;

			if (controlsToolbar) {
				// TODO
				// controlsToolbar.disable button
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _uiSetSelected
		 * @param val
		 * @protected
		 */
		_uiSetSelected: function(val) {
			var instance = this;

			instance.get(BOUNDING_BOX).toggleClass(CSS_DIAGRAM_NODE_SELECTED, val);

			if (val &amp;&amp; !instance.controlsToolbar) {
				instance._renderControlsToolbar();
			}
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _uiSetXY
		 * @param val
		 * @protected
		 */
		_uiSetXY : function(val) {
			var instance = this;
			var containerXY = instance.getContainer().getXY();

			this._posNode.setXY([ val[0] + containerXY[0], val[1] + containerXY[1] ]);
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _valueShapeBoundary
		 * @protected
		 */
		_valueShapeBoundary: function() {
			var instance = this;

			return {
				height: 41,
				type: &#x27;rect&#x27;,
				stroke: {
					weight: 7,
					color: &#x27;transparent&#x27;,
					opacity: 0
				},
				width: 41
			};
		}
	}
});

A.DiagramNode = DiagramNode;

A.DiagramBuilder.types[NODE] = A.DiagramNode;

/**
 * A base class for DiagramNodeState.
 *
 * @class A.DiagramNodeState
 * @extends A.DiagramNode
 * @param config {Object} Object literal specifying widget configuration properties.
 * @constructor
 */
A.DiagramNodeState = A.Component.create({

	/**
	 * Static property provides a string to identify the class.
	 *
	 * @property DiagramNodeState.NAME
	 * @type String
	 * @static
	 */
	NAME: DIAGRAM_NODE_NAME,

	/**
	 * Static property used to define the default attribute
	 * configuration for the DiagramNodeState.
	 *
	 * @property DiagramNodeState.ATTRS
	 * @type Object
	 * @static
	 */
	ATTRS: {

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute height
		 * @default 40
		 * @type Number
		 */
		height: {
			value: 40
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute type
		 * @default &#x27;state&#x27;
		 * @type String
		 */
		type: {
			value: STATE
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute width
		 * @default 40
		 * @type Number
		 */
		width: {
			value: 40
		}
	},

	/**
	 * Static property used to define which component it extends.
	 *
	 * @property DiagramNodeState.EXTENDS
	 * @type String
	 * @static
	 */
	EXTENDS: A.DiagramNode,

	prototype: {
		hotPoints: A.DiagramNode.CIRCLE_POINTS,

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method renderShapeBoundary
		 */
		renderShapeBoundary: function() {
			var instance = this;

			var boundary = instance.boundary = instance.get(GRAPHIC).addShape(
				instance.get(SHAPE_BOUNDARY)
			);

			boundary.translate(5, 5);

			return boundary;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _valueShapeBoundary
		 * @protected
		 */
		_valueShapeBoundary: function() {
			var instance = this;

			return {
				radius: 15,
				type: &#x27;circle&#x27;,
				stroke: {
					weight: 7,
					color: &#x27;transparent&#x27;,
					opacity: 0
				}
			};
		}
	}
});

A.DiagramBuilder.types[STATE] = A.DiagramNodeState;

/**
 * A base class for DiagramNodeCondition.
 *
 * @class A.DiagramNodeCondition
 * @extends A.DiagramNodeState
 * @param config {Object} Object literal specifying widget configuration properties.
 * @constructor
 */
A.DiagramNodeCondition = A.Component.create({

	/**
	 * Static property provides a string to identify the class.
	 *
	 * @property DiagramNodeCondition.NAME
	 * @type String
	 * @static
	 */
	NAME: DIAGRAM_NODE_NAME,

	/**
	 * Static property used to define the default attribute
	 * configuration for the DiagramNodeCondition.
	 *
	 * @property DiagramNodeCondition.ATTRS
	 * @type Object
	 * @static
	 */
	ATTRS: {

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute height
		 * @default 60
		 * @type Number
		 */
		height: {
			value: 60
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute type
		 * @default &#x27;condition&#x27;
		 * @type String
		 */
		type: {
			value: CONDITION
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute width
		 * @default 60
		 * @type Number
		 */
		width: {
			value: 60
		}
	},

	/**
	 * Static property used to define which component it extends.
	 *
	 * @property DiagramNodeCondition.EXTENDS
	 * @type String
	 * @static
	 */
	EXTENDS: A.DiagramNodeState,

	prototype: {
		hotPoints: A.DiagramNode.DIAMOND_POINTS,

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method renderShapeBoundary
		 */
		renderShapeBoundary: function() {
			var instance = this;

			var boundary = instance.boundary = instance.get(GRAPHIC).addShape(
				instance.get(SHAPE_BOUNDARY)
			);

			boundary.translate(10, 10);
			boundary.rotate(45);

			return boundary;
		},

		_valueShapeBoundary: A.DiagramNode.prototype._valueShapeBoundary
	}
});

A.DiagramBuilder.types[CONDITION] = A.DiagramNodeCondition;

/**
 * A base class for DiagramNodeStart.
 *
 * @class A.DiagramNodeStart
 * @extends A.DiagramNodeState
 * @param config {Object} Object literal specifying widget configuration properties.
 * @constructor
 */
A.DiagramNodeStart = A.Component.create({

	/**
	 * Static property provides a string to identify the class.
	 *
	 * @property DiagramNodeStart.NAME
	 * @type String
	 * @static
	 */
	NAME: DIAGRAM_NODE_NAME,

	/**
	 * Static property used to define the default attribute
	 * configuration for the DiagramNodeStart.
	 *
	 * @property DiagramNodeStart.ATTRS
	 * @type Object
	 * @static
	 */
	ATTRS: {

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute type
		 * @default &#x27;start&#x27;
		 * @type String
		 */
		type: {
			value: START
		}
	},

	/**
	 * Static property used to define which component it extends.
	 *
	 * @property DiagramNodeStart.EXTENDS
	 * @type String
	 * @static
	 */
	EXTENDS: A.DiagramNodeState
});

A.DiagramBuilder.types[START] = A.DiagramNodeStart;

/**
 * A base class for DiagramNodeEnd.
 *
 * @class A.DiagramNodeEnd
 * @extends A.DiagramNodeState
 * @param config {Object} Object literal specifying widget configuration properties.
 * @constructor
 */
A.DiagramNodeEnd = A.Component.create({

	/**
	 * Static property provides a string to identify the class.
	 *
	 * @property DiagramNodeEnd.NAME
	 * @type String
	 * @static
	 */
	NAME: DIAGRAM_NODE_NAME,

	/**
	 * Static property used to define the default attribute
	 * configuration for the DiagramNodeEnd.
	 *
	 * @property DiagramNodeEnd.ATTRS
	 * @type Object
	 * @static
	 */
	ATTRS: {

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute type
		 * @default &#x27;end&#x27;
		 * @type String
		 */
		type: {
			value: END
		}
	},

	/**
	 * Static property used to define which component it extends.
	 *
	 * @property DiagramNodeEnd.EXTENDS
	 * @type String
	 * @static
	 */
	EXTENDS: A.DiagramNodeState
});

A.DiagramBuilder.types[END] = A.DiagramNodeEnd;

/**
 * A base class for DiagramNodeJoin.
 *
 * @class A.DiagramNodeJoin
 * @extends A.DiagramNodeState
 * @param config {Object} Object literal specifying widget configuration properties.
 * @constructor
 */
A.DiagramNodeJoin = A.Component.create({

	/**
	 * Static property provides a string to identify the class.
	 *
	 * @property DiagramNodeJoin.NAME
	 * @type String
	 * @static
	 */
	NAME: DIAGRAM_NODE_NAME,

	/**
	 * Static property used to define the default attribute
	 * configuration for the DiagramNodeJoin.
	 *
	 * @property DiagramNodeJoin.ATTRS
	 * @type Object
	 * @static
	 */
	ATTRS: {

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute height
		 * @default 60
		 * @type Number
		 */
		height: {
			value: 60
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute type
		 * @default &#x27;join&#x27;
		 * @type String
		 */
		type: {
			value: JOIN
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute width
		 * @default 60
		 * @type Number
		 */
		width: {
			value: 60
		}
	},

	/**
	 * Static property used to define which component it extends.
	 *
	 * @property DiagramNodeJoin.EXTENDS
	 * @type String
	 * @static
	 */
	EXTENDS: A.DiagramNodeState,

	prototype: {
		hotPoints: A.DiagramNode.DIAMOND_POINTS,

		renderShapeBoundary: A.DiagramNodeCondition.prototype.renderShapeBoundary,

		_valueShapeBoundary: A.DiagramNode.prototype._valueShapeBoundary
	}
});

A.DiagramBuilder.types[JOIN] = A.DiagramNodeJoin;

/**
 * A base class for DiagramNodeFork.
 *
 * @class A.DiagramNodeFork
 * @extends A.DiagramNodeState
 * @param config {Object} Object literal specifying widget configuration properties.
 * @constructor
 */
A.DiagramNodeFork = A.Component.create({

	/**
	 * Static property provides a string to identify the class.
	 *
	 * @property DiagramNodeFork.NAME
	 * @type String
	 * @static
	 */
	NAME: DIAGRAM_NODE_NAME,

	/**
	 * Static property used to define the default attribute
	 * configuration for the DiagramNodeFork.
	 *
	 * @property DiagramNodeFork.ATTRS
	 * @type Object
	 * @static
	 */
	ATTRS: {

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute height
		 * @default 60
		 * @type Number
		 */
		height: {
			value: 60
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute type
		 * @default &#x27;fork&#x27;
		 * @type String
		 */
		type: {
			value: FORK
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute width
		 * @default 60
		 * @type Number
		 */
		width: {
			value: 60
		}
	},

	/**
	 * Static property used to define which component it extends.
	 *
	 * @property DiagramNodeFork.EXTENDS
	 * @type String
	 * @static
	 */
	EXTENDS: A.DiagramNodeState,

	prototype: {
		hotPoints: A.DiagramNode.DIAMOND_POINTS,

		renderShapeBoundary: A.DiagramNodeCondition.prototype.renderShapeBoundary,

		_valueShapeBoundary: A.DiagramNode.prototype._valueShapeBoundary
	}
});

A.DiagramBuilder.types[FORK] = A.DiagramNodeFork;

/**
 * A base class for DiagramNodeTask.
 *
 * @class A.DiagramNodeTask
 * @extends A.DiagramNodeState
 * @param config {Object} Object literal specifying widget configuration properties.
 * @constructor
 */
A.DiagramNodeTask = A.Component.create({

	/**
	 * Static property provides a string to identify the class.
	 *
	 * @property DiagramNodeTask.NAME
	 * @type String
	 * @static
	 */
	NAME: DIAGRAM_NODE_NAME,

	/**
	 * Static property used to define the default attribute
	 * configuration for the DiagramNodeTask.
	 *
	 * @property DiagramNodeTask.ATTRS
	 * @type Object
	 * @static
	 */
	ATTRS: {

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute height
		 * @default 70
		 * @type Number
		 */
		height: {
			value: 70
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute type
		 * @default &#x27;task&#x27;
		 * @type String
		 */
		type: {
			value: TASK
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @attribute width
		 * @default 70
		 * @type Number
		 */
		width: {
			value: 70
		}
	},

	/**
	 * Static property used to define which component it extends.
	 *
	 * @property DiagramNodeTask.EXTENDS
	 * @type String
	 * @static
	 */
	EXTENDS: A.DiagramNodeState,

	prototype: {
		hotPoints: A.DiagramNode.SQUARE_POINTS,

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method renderShapeBoundary
		 */
		renderShapeBoundary: function() {
			var instance = this;

			var boundary = instance.boundary = instance.get(GRAPHIC).addShape(
				instance.get(SHAPE_BOUNDARY)
			);

			boundary.translate(8, 8);

			return boundary;
		},

		/**
		 * TODO. Wanna help? Please send a Pull Request.
		 *
		 * @method _valueShapeBoundary
		 * @protected
		 */
		_valueShapeBoundary: function() {
			var instance = this;

			return {
				height: 55,
				type: &#x27;rect&#x27;,
				stroke: {
					weight: 7,
					color: &#x27;transparent&#x27;,
					opacity: 0
				},
				width: 55
			};
		}
	}
});

A.DiagramBuilder.types[TASK] = A.DiagramNodeTask;
    </pre>
</div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="../assets/vendor/prettify/prettify-min.js"></script>
    <script>prettyPrint();</script>
    <script src="../assets/js/yui-prettify.js"></script>
    <script src="../assets/../api.js"></script>
    <script src="../assets/js/api-filter.js"></script>
    <script src="../assets/js/api-list.js"></script>
    <script src="../assets/js/api-search.js"></script>
    <script src="../assets/js/apidocs.js"></script>

</body>
</html>